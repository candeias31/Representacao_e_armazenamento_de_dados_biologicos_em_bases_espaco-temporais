(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{10:function(i,n,s){"use strict";(function(f){var e,t;!(e=[s(2),s(18),s(0)],t=function(c,d,u){d.defaults.transition="zoom";d.defaults.theme.ok="btn btn-primary fa fa-lg fa-check pg-alertify-button";d.defaults.theme.cancel="btn btn-secondary fa fa-lg fa-times pg-alertify-button";d.defaults.theme.input="form-control";d.defaults.closable=false;d.pgIframeDialog||d.dialog("pgIframeDialog",function(){var a;return{main:function e(t){return this.set({pg_msg:t})},setup:function e(){return{options:{padding:!1,overflow:!1,closable:true}}},build:function e(){a=document.createElement("iframe");a.src="";a.frameBorder="no";a.width="100%";a.height="100%";this.elements.content.appendChild(a);this.elements.body.style.minHeight=screen.height*.5+"px"},settings:{pg_msg:undefined},settingUpdated:function e(t,i,n){switch(t){case"pg_msg":var s=a.contentWindow||a.contentDocument;if(s.document){s=s.document}s.open();s.write(n);s.close();break}},hooks:{onupdate:function e(t,i,n){switch(t){case"resizable":if(n){this.elements.content.removeAttribute("style");a&&a.removeAttribute("style")}else{this.elements.content.style.minHeight="inherit";a&&(a.style.minHeight="inherit")}break}}}}});d.pgNotifier=function(e,t,i,n){var s=t.responseText,a=t.getResponseHeader("Content-Type");if(t.status==0){s=c("Connection to the server has been lost.");i=c("Connection Lost")}else{if(a){try{if(a.indexOf("application/json")==0){var l=JSON.parse(s);if(l.info=="CRYPTKEY_MISSING"){var r=window.pgAdmin.Browser;r.set_master_password("",function(){if(n&&typeof n=="function"){n("CRYPTKEY_SET")}});return}else if(l.result!=null&&(!l.errormsg||l.errormsg=="")&&n&&typeof n=="function"){return n(l.result)}s=f.escape(l.result)||f.escape(l.errormsg)||"Unknown error"}if(a.indexOf("text/html")==0){var o=i;if(e==="error"){o='                  <div class="media text-danger text-14">                    <div class="media-body media-middle">                      <div class="alert-text">'+i+'</div><br/>                      <div class="alert-text">'+c("Click for details.")+"</div>                    </div>                  </div>"}d.notify(o,e,0,function(){d.pgIframeDialog().show().set({frameless:false}).set("pg_msg",s)});return}}catch(e){d.alert().show().set("message",e.message).set("title","Error").set("closable",true)}}}d.alert().show().set("message",s.replace(new RegExp(/\r?\n/,"g"),"<br />")).set("title",i).set("closable",true)};d.pgRespErrorNotify=function(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var n=e.getResponseHeader("Content-Type");try{if(e.status===0){t=c("Connection to the server has been lost.")}else{if(n){if(n.indexOf("application/json")>=0){var s=JSON.parse(e.responseText);t=f.escape(s.result)||f.escape(s.errormsg)||c("Unknown error")}}if(n.indexOf("text/html")>=0){var a='                <div class="media text-danger text-14">                  <div class="media-body media-middle">                    <div class="alert-text">'+c("INTERNAL SERVER ERROR")+'</div><br/>                    <div class="alert-text">'+c("Click for details.")+"</div>                  </div>                </div>";d.notify(a,"error",0,function(){d.pgIframeDialog().show().set({frameless:false}).set("pg_msg",e.responseText)});return}}}catch(e){t=e.message}d.error(i+" "+t)};var n=function e(t){var i=this;if(t){i.pgResizeRecursion=false}if(i.pgResizeTimeout){return}i.pgResizeTimeout=setTimeout(function(){var e=u(this.elements.dialog),t=e.width(),i="xs";this.pgResizeTimeout=null;if(t<480){i="xs"}if(t>=480){i="sm"}if(t>=768){i="md"}if(t>=992){i="lg"}if(t>=1200){i="xl"}e.attr("el",i)}.bind(i),100)};var t=function e(t){var i=this;if(t){i.pgResizeRecursion=true}setTimeout(function(){n.apply(i);if(i.pgResizeRecursion){e.apply(i,[false])}},100)};d.pgDialogBuild=function(){this.set("onshow",function(){this.elements.dialog.classList.add("pg-el-container");u(this.elements.commands.close).attr("title",c("Close"));u(this.elements.commands.maximize).attr("title",c("Maximize"));n.apply(this,arguments)});this.set("onresize",t.bind(this,true));this.set("onresized",n.bind(this,true));this.set("onmaximized",n);this.set("onrestored",n);for(var e=0;e<this.__internal.buttons.length;e++){if(f.isUndefined(this.__internal.buttons[e]["key"])){this.__internal.buttons[e]["key"]=null}}};d.pgHandleItemError=function(e,t,i,n){var a=window.pgAdmin.Browser;if(!e||!a){return}var s=e.getResponseHeader("Content-Type"),l=s&&s.indexOf("application/json")==0&&JSON.parse(e.responseText);if(l&&(e.status==503?l.info=="CONNECTION_LOST"&&"server"in n.info&&l.data.sid>=0&&l.data.sid==n.info.server._id:e.status==428&&l.errormsg&&l.errormsg==c("Connection to the server has been lost."))){if(n.preHandleConnectionLost&&typeof n.preHandleConnectionLost=="function"){n.preHandleConnectionLost.apply(this,arguments)}var r=a.Nodes["server"],o={resp:l,xhr:e,args:n},d=function(){var e=this,n=function(e,t,i){if(this.args.info.server._id==e){a.Events.off("pgadmin:server:connected",n);a.Events.off("pgadmin:server:connect:cancelled",s);if(this.resp.data.database&&this.resp.data.database!=i.db){a.Events.trigger("pgadmin:database:connection:lost",this.args.item,this.resp,true)}}}.bind(e),s=function(e,t,i){if(e==this.args.info.server.id){a.Events.off("pgadmin:server:connected",n);a.Events.off("pgadmin:server:connect:cancelled",s);a.Events.trigger("pgadmin:database:connect:cancelled",e,this.resp.data.database||i.db,t,i)}}.bind(e);a.Events.on("pgadmin:server:connected",n);a.Events.on("pgadmin:server:connect:cancelled",s);a.Events.trigger("pgadmin:server:connection:lost",this.args.item,this.resp)}.bind(o);u.ajax({url:r.generate_url(null,"connect",n.info.server,true,n.info),dataType:"json"}).done(function(e){if(e.success&&"connected"in e.data){if(e.data.connected){a.Events.trigger("pgadmin:database:connection:lost",n.item,l);return}}d()}).fail(function(){d()});return true}else if(l&&l.info=="CRYPTKEY_MISSING"&&e.status==503){return false}return false};var e=d.success,i=d.error;f.extend(d,{orig_success:e,orig_error:i});f.extend(d,{success:function e(t,i,n){var s='<div class="d-flex px-3 py-2">\n        <div class="pr-2">\n          <i class="fa fa-check text-success" aria-hidden="true"></i>\n        </div>\n        <div class="text-body">'.concat(t,"</div>\n      </div>");return d.orig_success(s,i,n)},error:function e(t,i,n){var s='<div class="d-flex px-3 py-2">\n        <div class="pr-2">\n          <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i>\n        </div>\n        <div class="text-body">'.concat(t,"</div>\n      </div>");return d.orig_error(s,i,n)},info:function e(t,i){var n='<div class="d-flex px-3 py-2">\n        <div class="mr-3">\n          <i class="fa fa-info text-primary" aria-hidden="true"></i>\n        </div>\n        <div class="text-body">'.concat(t,"</div>\n      </div>");var s=d.notify(n,i);return s}});d.confirm().set({onshow:function e(){u(this.elements.commands.close).attr("title",c("Close"));u(this.elements.commands.maximize).attr("title",c("Maximize"));u(this.elements.content).addClass("ajs-wrap-text")},reverseButtons:true});d.prompt().set({reverseButtons:true});return d}.apply(n,e),t!==undefined&&(i.exports=t))}).call(this,s(1))},12:function(n,s,a){"use strict";(function(e,E){var t,i;!(t=[a(2),a(1),a(0),a(9),a(22),a(19),a(18),a(50),a(269),a(17),a(28),a(270),a(67),a(94)],i=function(o,g,v,r,d,b,l,n,f,a,c){var e=window.pgAdmin=window.pgAdmin||{},u=e.Browser;g.extend(b.Column.prototype.defaults,{cellFunction:undefined});g.extend(b.Cell.prototype.events,{mouseover:function e(){var t=v(this.el);if(t.text().length>0&&!t.attr("title")&&t.innerWidth()+1<t[0].scrollWidth){t.attr("title",v.trim(t.text()))}}});g.extend(b.InputCellEditor.prototype.events,{keydown:function e(t){var i=u.get_preferences_for_module("browser");if(c.validateShortcutKeys(i.add_grid_row,t)){u.keyboardNavigation.bindAddGridRow()}else{b.InputCellEditor.prototype.saveOrCancel.apply(this,arguments)}}});g.extend(b.Body.prototype,{sort:function e(t,i){if(!g.contains(["ascending","descending",null],i)){throw new RangeError('direction must be one of "ascending", "descending" or `null`')}if(g.isString(t))t=this.columns.findWhere({name:t});var n=this.collection;var s;if(i==="ascending")s=-1;else if(i==="descending")s=1;else s=null;var a=t.get("cell").prototype.className||"string-cell",l=this.makeComparator(t.get("name"),s,s?t.sortValue():function(e){return e.cid.replace("c","")*1},a);if(r.PageableCollection&&n instanceof r.PageableCollection){n.setSorting(s&&t.get("name"),s,{sortValue:t.sortValue()});if(n.fullCollection){if(n.fullCollection.comparator==null){n.fullCollection.comparator=l}n.fullCollection.sort();n.trigger("backgrid:sorted",t,i,n)}else n.fetch({reset:true,success:function e(){n.trigger("backgrid:sorted",t,i,n)}})}else{n.comparator=l;n.sort();n.trigger("backgrid:sorted",t,i,n)}t.set("direction",i);return this},makeComparator:function e(o,d,c,u){return function(e,t){var i=c(e,o),n=c(t,o),s;if(g.isUndefined(i)||g.isUndefined(n))return;var a=["number-cell","integer-cell"];if(g.include(a,u)){var l,r;try{l=new f(i)}catch(e){l=NaN}try{r=new f(n)}catch(e){r=NaN}if(d===1)s=l,l=r,r=s;if(l.eq(r))return 0;else if(l.lt(r))return-1;else return 1}else{if(d===1)s=i,i=n,n=s;if(i===n)return 0;else if(i<n)return-1;return 1}}},moveToNextCell:function e(t,i,n){var s=this.collection.indexOf(t);var a=this.columns.indexOf(i);var l,r,o,d,c;if(a===-1)return this;this.rows[s].cells[a].exitEditMode();if(n.moveUp()||n.moveDown()||n.moveLeft()||n.moveRight()||n.save()){var u=this.columns.length;var f=u*this.collection.length;if(n.moveUp()||n.moveDown()){d=s+(n.moveUp()?-1:1);var p=this.rows[d];if(p){l=p.cells[a];if(b.callByNeed(l.column.editable(),l.column,t)){l.enterEditMode();t.trigger("backgrid:next",d,a,false)}}else t.trigger("backgrid:next",d,a,true)}else if(n.moveLeft()||n.moveRight()){var h=n.moveRight();for(var m=s*u+a+(h?1:-1);m>=0&&m<f;h?m++:m--){d=~~(m/u);c=m-d*u;l=this.rows[d].cells[c];r=b.callByNeed(l.column.renderable(),l.column,l.model);o=b.callByNeed(l.column.editable(),l.column,t);if(l&&l.$el.hasClass("edit-cell")&&!l.$el.hasClass("privileges")||l.$el.hasClass("delete-cell")){t.trigger("backgrid:next",d,c,false);if(l.$el.hasClass("delete-cell")){setTimeout(function(){v(l.$el).trigger("focus")},50)}break}else if(r&&o){l.enterEditMode();t.trigger("backgrid:next",d,c,false);break}}if(m==f){t.trigger("backgrid:next",~~(m/u),m-d*u,true)}}}return this}});g.extend(b.Row.prototype,{makeCell:function e(t){return new(this.getCell(t))({column:t,model:this.model})},getCell:function e(t){var i=t.get("cellFunction");if(g.isFunction(i)){var n=i.apply(t,[this.model]);try{return b.resolveNameToClass(n,"Cell")}catch(e){if(e instanceof ReferenceError){return t.get("cell")}else{throw e}}}else{return t.get("cell")}}});var t=b.Extension.ObjectCellEditor=b.CellEditor.extend({modalTemplate:g.template(['<div class="subnode-dialog" tabindex="0">','    <div class="subnode-body"></div>',"</div>"].join("\n")),stringTemplate:g.template(['<div class="form-group">','  <label class="control-label col-sm-4"><%=label%></label>','  <div class="col-sm-8">','    <input type="text" class="form-control" name="<%=name%>" value="<%=value%>" placeholder="<%=placeholder%>" />',"  </div>","</div>"].join("\n")),extendWithOptions:function e(t){g.extend(this,t)},render:function e(){return this},postRender:function e(t,i){var n=this.columns_length,s=this.schema.length?this.schema:this.column.get("schema");if(i!=null&&i.get("name")!=this.column.get("name"))return false;if(!g.isArray(s))throw new TypeError("schema must be an array");var a=this.createDialog(n);var l=v('<form class="form-dialog"></form>');a.find("div.subnode-body").append(l);var r=a.find("form.form-dialog");this.objectView=new d.Dialog({el:r,model:this.model,schema:s,tabPanelClassName:function e(){return"sub-node-form col-sm-12"},events:{keydown:function e(t){var i=u.get_preferences_for_module("browser");if(c.validateShortcutKeys(i.add_grid_row,t)){u.keyboardNavigation.bindAddGridRow()}}}});this.objectView.render();return this},createDialog:function e(t){t=t||1;var i=this.$dialog=v(this.modalTemplate({title:""})),n=v('<tr class="nohover editor-row">'),s=v("<td>",{class:"editable sortable renderable",style:"height: auto",colspan:t+2}).appendTo(n);this.tr=n;s.append(i.css("display","block"));this.el.parent("tr").after(n);return i},save:function e(){this.model.trigger("backgrid:edited",this.model,this.column,new b.Command({keyCode:13}));if(this.tr){this.tr.remove()}return this},remove:function e(){this.objectView.remove();b.CellEditor.prototype.remove.apply(this,arguments);if(this.tr){this.tr.remove()}return this}});b.Extension.PGSelectCell=b.SelectCell.extend({optionValues:function e(){var t=[],i=g.result(this.column.attributes,"options");g.each(i,function(e){t.push([e.label,e.value])});return t}});b.Extension.ObjectCell=b.Cell.extend({editorOptionDefaults:{schema:[]},className:"edit-cell",editor:t,initialize:function e(i){b.Cell.prototype.initialize.apply(this,arguments);var n=this,s={};g.each(this.editorOptionDefaults,function(e,t){if(!n[t])n[t]=e;if(i&&i[t])n[t]=i[t];s[t]=n[t]});s["el"]=v(this.el);s["columns_length"]=this.column.collection.length;s["el"].attr("tabindex",0);this.listenTo(this.model,"backgrid:edit",function(e,t,i,n){if(t.get("name")==this.column.get("name"))n.extendWithOptions(s)});this.$el.on("keydown",function(e){if(e.keyCode==32){v(this).click()}})},enterEditMode:function e(){var t=!g.isUndefined(this.column.get("canEditRow"))&&g.isFunction(this.column.get("canEditRow"))?b.callByNeed(this.column.get("canEditRow"),this.column,this.model):true;if(t){this.model.trigger("enteringEditMode",[this]);b.Cell.prototype.enterEditMode.apply(this,arguments);this.delegateEvents();var i=b.callByNeed(this.column.editable(),this.column,this.model);if(i){this.$el.html("<i class='fa fa-pencil-square subnode-edit-in-process' title='"+g("Edit row")+"'></i>");var n=v(this.$el).parents()[1],s=v(n).find(".tab-content:first > .tab-pane.active:first");a.findAndSetFocus(s);u.keyboardNavigation.getDialogTabNavigator(v(n).find(".subnode-dialog"));this.model.trigger("pg-sub-node:opened",this.model,this)}}else{l.alert(o("This object is not user editable."),function(){return true})}},render:function e(){this.$el.empty();this.$el.html("<i class='fa fa-pencil-square-o' title='"+g("Edit row")+"'></i>");this.delegateEvents();if(this.grabFocus)this.$el.trigger("focus");return this},exitEditMode:function e(){if(!g.isUndefined(this.currentEditor)||!g.isEmpty(this.currentEditor)){var t=v(this.currentEditor.objectView.el).find('.nav-tabs > .active > a[data-toggle="tab"]').first().data("tabIndex");b.Cell.prototype.exitEditMode.apply(this,arguments);this.model.trigger("pg-sub-node:closed",this,t);this.grabFocus=true}},events:{click:function e(t){if(this.$el.find("i").first().hasClass("subnode-edit-in-process")){this.undelegateEvents();this.currentEditor.save()}else{this.enterEditMode.call(this,[])}t.preventDefault()},keydown:function e(t){var i=this.model;var n=this.column;var s=new b.Command(t);if(s.moveLeft()){setTimeout(function(){i.trigger("backgrid:edited",i,n,s)},20)}}}});b.Extension.DeleteCell=b.Cell.extend({defaults:g.defaults({defaultDeleteMsg:o("Are you sure you wish to delete this row?"),defaultDeleteTitle:o("Delete Row")},b.Cell.prototype.defaults),className:"delete-cell",events:{click:"deleteRow"},deleteRow:function e(t){t.preventDefault();var i=this;var n=!g.isUndefined(this.column.get("canDeleteRow"))&&g.isFunction(this.column.get("canDeleteRow"))?b.callByNeed(this.column.get("canDeleteRow"),this.column,this.model):true;if(n){var s=!g.isUndefined(this.column.get("customDeleteMsg"))?this.column.get("customDeleteMsg"):i.defaults.defaultDeleteMsg;var a=!g.isUndefined(this.column.get("customDeleteTitle"))?this.column.get("customDeleteTitle"):i.defaults.defaultDeleteTitle;l.confirm(a,s,function(){var e=v(i.el).parents("tbody").eq(0);i.model.collection.remove(i.model);var t=v(e).find("tr");if(t.length>0){t.first().children()[0].focus()}else{v(e).parents(".subnode").eq(0).find(".add").focus()}},function(){return true})}else{l.alert(o("This object cannot be deleted."),function(){return true})}},exitEditMode:function e(){this.$el.removeClass("editor")},initialize:function e(){b.Cell.prototype.initialize.apply(this,arguments)},render:function e(){var n=this;this.$el.empty();v(this.$el).attr("tabindex",0);this.$el.html("<i class='fa fa-trash' title='"+g("Delete row")+"'></i>");this.$el.on("keydown",function(e){if(e.keyCode==32){n.$el.click()}var t;if(e.keyCode==9||e.keyCode==16){t=e.shiftKey?n.$el.prev():n.$el.next()}if(t){var i=new b.Command({key:"Tab",keyCode:9,which:9,shiftKey:e.shiftKey});setTimeout(function(){if(t.hasClass("editable")){e.preventDefault();e.stopPropagation();n.model.trigger("backgrid:edited",n.model,n.column,i)}else{n.model.trigger("backgrid:edited",n.model,n.column,i)}},20)}});this.delegateEvents();return this}});b.Extension.CustomHeaderCell=b.HeaderCell.extend({initialize:function e(){b.HeaderCell.prototype.initialize.apply(this,arguments);var t=this.column.get("cellHeaderClasses");if(t){this.$el.addClass(t)}}});if(E&&E.fn.bootstrapToggle)v.fn.bootstrapToggle=E.fn.bootstrapToggle;b.Extension.SwitchCell=b.BooleanCell.extend({defaults:{options:g.defaults({onText:o("Yes"),offText:o("No"),onColor:"success",offColor:"primary",size:"mini",width:null,height:null},v.fn.bootstrapToggle.defaults)},className:"switch-cell",initialize:function e(){b.BooleanCell.prototype.initialize.apply(this,arguments);this.onChange=this.onChange.bind(this)},enterEditMode:function e(){this.$el.addClass("editor");v(this.$el.find("input[type=checkbox]")).trigger("focus")},exitEditMode:function e(){this.$el.removeClass("editor")},events:{"change input":"onChange",keyup:"toggleSwitch","blur input":"exitEditMode",keydown:"onKeyDown"},toggleSwitch:function e(t){if(t.keyCode==32){this.$el.find("input[type=checkbox]").bootstrapToggle("toggle");t.preventDefault()}},onKeyDown:function e(t){var i=u.get_preferences_for_module("browser");if(c.validateShortcutKeys(i.add_grid_row,t)){u.keyboardNavigation.bindAddGridRow()}},onChange:function e(){var t=this.model,i=this.column,n=this.formatter.toRaw(this.$input.prop("checked"),t);this.enterEditMode();t.set(i.get("name"),n)},render:function e(){var n=this,t=g.defaults(this.column.toJSON(),this.defaults),i=this.model,s=this.column,a=this.formatter.fromRaw(i.get(s.get("name")),i),l=b.callByNeed(t.editable,s,i),r=g.defaults({},t.options,this.defaults.options);this.undelegateEvents();this.$el.empty();this.$el.append(v("<input>",{tabIndex:0,type:"checkbox"}).prop("checked",a).prop("disabled",!l).attr("data-toggle","toggle").attr("data-size",r.size).attr("data-on",r.onText).attr("data-off",r.offText).attr("data-width",r.width).attr("data-height",r.height).attr("data-onstyle",r.onColor).attr("data-offstyle",r.offColor));this.$input=this.$el.find("input[type=checkbox]").first();this.$input.bootstrapToggle();this.$el.on("keydown",function(e){var t;if(e.keyCode==9){t=e.shiftKey?n.$el.prev():n.$el.next()}if(t){var i=new b.Command({key:"Tab",keyCode:9,which:9,shiftKey:e.shiftKey});setTimeout(function(){if(t.hasClass("editable")&&t.hasClass("edit-cell")){e.preventDefault();e.stopPropagation();t.trigger("focus")}else if(t.hasClass("editable")){e.preventDefault();e.stopPropagation();setTimeout(function(){n.model.trigger("backgrid:edited",n.model,n.column,i)},10);t.trigger("focus")}else{setTimeout(function(){n.model.trigger("backgrid:edited",n.model,n.column,i)},10)}},20)}});this.delegateEvents();return this}});b.Extension.Select2Cell=b.SelectCell.extend({className:"select2-cell",editor:null,defaults:g.defaults({select2:{},opt:{label:null,value:null,selected:false}},b.SelectCell.prototype.defaults),enterEditMode:function e(){if(!this.$el.hasClass("editor"))this.$el.addClass("editor");this.$select.select2("focus");this.$select.select2("open");this.$select.on("blur",this.exitEditMode)},exitEditMode:function e(){this.$select.off("blur",this.exitEditMode);this.$select.select2("close");this.$el.removeClass("editor")},saveOrCancel:function e(t){var i=this;var n=new b.Command(t);var s=t.type==="blur";if(n.moveUp()||n.moveDown()||n.moveLeft()||n.moveRight()||n.save()||s){var a;a=t.shiftKey?i.$el.prev():i.$el.next();if(a){var l=new b.Command({key:"Tab",keyCode:9,which:9,shiftKey:t.shiftKey});setTimeout(function(){if(a.hasClass("editable")){t.preventDefault();t.stopPropagation();i.model.trigger("backgrid:edited",i.model,i.column,l)}else{i.model.trigger("backgrid:edited",i.model,i.column,l)}},20)}}},events:{"select2:open":"enterEditMode","select2:close":"exitEditMode",change:"onSave","select2:unselect":"onSave",blur:"saveOrCancel",keydown:"saveOrCancel"},template:g.template(['<option value="<%- value %>" ','<%= selected ? \'selected="selected"\' : "" %>>',"<%- label %></option>"].join(""),null,{variable:null}),initialize:function e(){b.SelectCell.prototype.initialize.apply(this,arguments);this.onSave=this.onSave.bind(this);this.enterEditMode=this.enterEditMode.bind(this);this.exitEditMode=this.exitEditMode.bind(this)},render:function e(){var t=g.defaults(this.column.toJSON(),this.defaults),i=this.model,n=this.column,s=b.callByNeed(t.editable,n,i),a=g.clone(this.optionValues||(g.isFunction(this.column.get("options"))?this.column.get("options")(this):this.column.get("options")));this.undelegateEvents();if(this.$select){if(this.$select.data("select2")){this.$select.select2("destroy")}delete this.$select;this.$select=null}this.$el.empty();if(!g.isArray(a))throw new TypeError("optionValues must be an array");a.unshift(this.defaults.opt);var l=null,r=null,o=this,d=i.get(this.column.get("name")),c=g.extend({openOnEnter:false,multiple:false},o.defaults.select2,t.select2||{}),u=g.template('<select <%=multiple ? "multiple" : "" %>></select>');var f=o.$select=v(u({multiple:c.multiple})).appendTo(o.$el);for(var p=0;p<a.length;p++){var h=a[p];if(g.isArray(h)){l=h[0];r=h[1];f.append(o.template({label:l,value:r,selected:d==r||c.multiple&&g.indexOf(d,r)>-1}))}else{h=g.defaults({},h,{selected:d==h.value||c.multiple&&g.indexOf(d,h.value)>-1},o.defaults.opt);f.append(o.template(h))}}if(t&&g.has(t.disabled)){var m=function e(){var t=[];Array.prototype.push.apply(t,arguments);var i=t.shift();if(typeof i==="function"){return i.apply(o,t)}return i};g.extend(c,{disabled:m(t.disabled,t,i)})}else{g.extend(c,{disabled:!s})}this.delegateEvents();if(!s||t.mode==="properties"){c["placeholder"]=""}this.$sel=this.$select.select2(c);if(this.$sel){this.$sel.data("select2").on("keypress",function(e){var t=this;if(e.which===9&&t.isOpen()){t.trigger("results:select",{});e.preventDefault()}})}return this},onSave:function e(){var t=this.model;var i=this.column;t.set(i.get("name"),this.$select.val())},remove:function e(){this.$select.off("change",this.onSave);if(this.$select.data("select2")){this.$select.select2("destroy")}this.$el.empty();b.SelectCell.prototype.remove.apply(this,arguments)}});var i=b.TextareaCellEditor=b.InputCellEditor.extend({tagName:"textarea",events:{blur:"saveOrCancel",keydown:""}});b.Extension.TextareaCell=b.Cell.extend({className:"textarea-cell",editor:i});b.Extension.CustomHeaderIconCell=b.HeaderCell.extend({className:"header-icon-cell",events:{click:"addHeaderIcon"},addHeaderIcon:function e(t){this.collection.add(new this.collection.model);t.preventDefault()},render:function e(){this.$el.empty();this.$el.html("<label><a><span style='font-weight:normal;'>Array Values</a></span></label> <button class='btn-sm btn-secondary add'>Add</button>");this.delegateEvents();return this}});var s=r.Model.extend({defaults:{value:null}});var p=b.Extension.InputArrayCellEditor=b.CellEditor.extend({tagName:"div",events:{blur:"lostFocus"},render:function e(){var t=this,i=this.model.get(this.column.get("name")),n="string";var s=this.model.get("type").replace("[]","");switch(s){case"boolean":n="boolean";break;case"integer":case"smallint":case"bigint":case"serial":case"smallserial":case"bigserial":case"oid":case"cid":case"xid":case"tid":n="integer";break;case"real":case"numeric":case"double precision":case"decimal":n="number";break;case"date":n="date";break}var a=[{name:"value",label:o("Array Values"),type:"text",cell:n,headerCell:b.Extension.CustomHeaderIconCell,cellHeaderClasses:"width_percent_100"}],l=v("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>");this.$el.attr("tabindex","1");a.unshift({name:"pg-backform-delete",label:"",cell:b.Extension.DeleteCell,editable:false,cell_priority:-1});this.$el.empty();var r=t.grid=new b.Grid({columns:a,collection:i});this.grid.listenTo(i,"backgrid:error",function(t){return function(e){t.model.trigger("backgrid:error",t.model,t.column,new b.Command(e))}}(this));this.grid.listenTo(i,"backgrid:edited",function(t){return function(e){t.model.trigger("backgrid:edited",t.model,t.column,new b.Command(e))}}(this));r.render();l.append(r.$el);this.$el.html(l);v(t.$el).pgMakeVisible("backform-tab");t.delegateEvents();return this},lostFocus:function e(i){var n=this,s=function e(t,i){var n=i.parentNode;while(n!=null){if(n==t){return true}n=n.parentNode}return false};setTimeout(function(){if(n.$el[0]!=document.activeElement&&!s(n.$el[0],document.activeElement)){var e=n.model,t=n.column;e.trigger("backgrid:edited",e,t,new b.Command(i));setTimeout(function(){if(n.grid){n.grid.remove();n.grid=null}},10)}},10);return}});var h=b.Extension.InputStringArrayCellFormatter=function(){};g.extend(h.prototype,{fromRaw:function e(t){var i=[];t.each(function(e){var t=e.get("value");if(g.isUndefined(t)){i.push("null")}else{i.push(e.get("value"))}});return i.toString()},toRaw:function e(t){return t}});var m=b.Extension.InputIntegerArrayCellFormatter=function(){};g.extend(m.prototype,{fromRaw:function e(t){var i=[];t.each(function(e){var t=e.get("value");if(g.isUndefined(t)||g.isNull(t)){i.push("NULL")}else{i.push(e.get("value"))}});return i.toString()},toRaw:function e(t){t.each(function(e){e.set("value",parseInt(e.get("value")),{silent:true})});return t}});var y=b.Extension.InputNumberArrayCellFormatter=function(){};g.extend(y.prototype,{fromRaw:function e(t){var i=[];t.each(function(e){var t=e.get("value");if(g.isUndefined(t)||g.isNull(t)){i.push("NULL")}else{i.push(e.get("value"))}});return i.toString()},toRaw:function e(t){t.each(function(e){e.set("value",parseFloat(e.get("value")),{silent:true})});return t}});b.Extension.InputStringArrayCell=b.Cell.extend({className:"width_percent_25",formatter:h,editor:p,initialize:function e(){b.Cell.prototype.initialize.apply(this,arguments);var t=arguments[0].model;if(g.isUndefined(this.collection)){this.collection=new(r.Collection.extend({model:s}))(t.get("value"))}this.model.set(this.column.get("name"),this.collection);this.listenTo(this.collection,"remove",this.render)}});b.Extension.InputIntegerArrayCell=b.IntegerCell.extend({className:"width_percent_25",formatter:m,editor:p,initialize:function e(){b.IntegerCell.prototype.initialize.apply(this,arguments);var t=arguments[0].model;g.each(t.get("value"),function(e){if(e.value==="NULL"){e.value=null}});if(g.isUndefined(this.collection)){this.collection=new(r.Collection.extend({model:s}))(t.get("value"))}this.model.set(this.column.get("name"),this.collection);this.listenTo(this.collection,"remove",this.render)}});b.Extension.InputNumberArrayCell=b.NumberCell.extend({className:"width_percent_25",formatter:y,editor:p,initialize:function e(){b.NumberCell.prototype.initialize.apply(this,arguments);var t=arguments[0].model;g.each(t.get("value"),function(e){if(e.value==="NULL"){e.value=null}});if(g.isUndefined(this.collection)){this.collection=new(r.Collection.extend({model:s}))(t.get("value"))}this.model.set(this.column.get("name"),this.collection);this.listenTo(this.collection,"remove",this.render)}});b.Extension.InputBooleanArrayCell=b.BooleanCell.extend({className:"width_percent_25",editor:p,initialize:function e(){b.BooleanCell.prototype.initialize.apply(this,arguments);var t=arguments[0].model;if(g.isUndefined(this.collection)){this.collection=new(r.Collection.extend({model:s}))(t.get("value"))}this.model.set(this.column.get("name"),this.collection);this.listenTo(this.collection,"remove",this.render)}});var C=b.Extension.DependentCell=function(){};g.extend(C.prototype,{initialize:function e(){var t=this.column.get("deps");var n=this;if(t&&g.isArray(t)){g.each(t,function(e){var t=e.split("."),i=t.shift();n.listenTo(n.model,"change:"+i,n.dependentChanged)})}},remove:function e(){var n=this,t=n.column.get("deps");if(t&&g.isArray(t)){g.each(t,function(e){var t=e.split("."),i=t.shift();n.stopListening(n.model,"change:"+i,n.dependentChanged)})}}});var _=b.PasswordFormatter=function(){};_.prototype=new b.CellFormatter;g.extend(_.prototype,{fromRaw:function e(t){if(g.isUndefined(t)||g.isNull(t))return"";var i="";for(var n=0;n<t.length;n++){i+="*"}return i}});b.Extension.PasswordCell=b.StringCell.extend({formatter:_,editor:b.InputCellEditor.extend({attributes:{type:"password",autocomplete:"new-password"},render:function e(){var t=this.model;this.$el.val(t.get(this.column.get("name")));return this}})});g.extend(b.NumberFormatter.prototype,{fromRaw:function e(t){if(g.isNull(t)||g.isUndefined(t))return"";t=parseFloat(t).toFixed(~~this.decimals);var i=t.split(".");var n=i[0];var s=i[1]?(this.decimalSeparator||".")+i[1]:"";return n.replace(this.HUMANIZED_NUM_RE,"$1"+this.orderSeparator)+s}});var w=b.Extension.JSONBCellFormatter=function(){};g.extend(w.prototype,{fromRaw:function e(t){if(g.isArray(t)){var i="";i=g.map(t,function(e){return JSON.stringify(JSON.stringify(e))});return"{"+i.join()+"}"}else if(g.isObject(t)){return JSON.stringify(t)}else{return t}},toRaw:function e(t){return t}});b.Extension.JSONBCell=b.StringCell.extend({className:"jsonb-cell",formatter:w});b.Extension.DatepickerCell=b.Cell.extend({editor:x});var x=b.InputCellEditor.extend({events:{},initialize:function e(){b.InputCellEditor.prototype.initialize.apply(this,arguments);var n=this;v(this.el).prop("readonly",true);v(this.el).datepicker({onClose:function e(t){var i=new b.Command({});n.model.set(n.column.get("name"),t);n.model.trigger("backgrid:edited",n.model,n.column,i);i=n=null}})}});var k=b.Extension.MomentFormatter=function(e){g.extend(this,this.defaults,e)};k.prototype=new b.CellFormatter;g.extend(k.prototype,{defaults:{modelInUnixOffset:false,modelInUnixTimestamp:false,modelInUTC:true,modelLang:n.locale(),modelFormat:n.defaultFormat,displayInUnixOffset:false,displayInUnixTimestamp:false,displayInUTC:true,displayLang:n.locale(),displayFormat:n.defaultFormat,allowEmpty:false},fromRaw:function e(t){if(t==null)return"";var i=this.modelInUnixOffset?n(t):this.modelInUnixTimestamp?n.unix(t):this.modelInUTC?n.utc(t,this.modelFormat,this.modelLang):n(t,this.modelFormat,this.modelLang);if(this.displayInUnixOffset)return+i;if(this.displayInUnixTimestamp)return i.unix();if(this.displayLang)i.locale(this.displayLang);if(this.displayInUTC)i.utc();else i.local();if(this.displayFormat!=n.defaultFormat){return i.format(this.displayFormat)}return i.format()},toRaw:function e(t){var i=this.displayInUnixOffset?n(+t):this.displayInUnixTimestamp?n.unix(+t):this.displayInUTC?n.utc(t,this.displayFormat,this.displayLang):n(t,this.displayFormat,this.displayLang);if(!i||!i.isValid())return this.allowEmpty&&t===""?null:undefined;if(this.modelInUnixOffset)return+i;if(this.modelInUnixTimestamp)return i.unix();if(this.modelLang)i.locale(this.modelLang);if(this.modelInUTC)i.utc();else i.local();if(this.modelFormat!=n.defaultFormat){return i.format(this.modelFormat)}return i.format()}});var N=b.Extension.MomentCell=b.Cell.extend({editor:b.InputCellEditor,className:"datetime-cell",formatter:k,initialize:function e(t){N.__super__.initialize.apply(this,arguments);var i=k.prototype.defaults;var n=g.keys(i);var s=g.pick(this,n);var a=g.pick(t,n);var l=g.pick(this.column.toJSON(),n);g.extend(this.formatter,i,s,a,l);this.editor=this.editor.extend({attributes:g.extend({},this.editor.prototype.attributes||this.editor.attributes||{},{placeholder:this.formatter.displayFormat}),options:this.column.get("options")})}});b.Extension.DatetimePickerEditor=b.InputCellEditor.extend({postRender:function e(){var n=this,t=function e(){var t=[];Array.prototype.push.apply(t,arguments);var i=t.shift();if(typeof i==="function"){return i.apply(n,t)}return i},i=g.extend({format:"YYYY-MM-DD HH:mm:ss Z",icons:{clear:"fa fa-trash"},buttons:{showToday:true},toolbarPlacement:"top",keepOpen:false},t(this.column.get("options")),{keyBinds:{"shift tab":function e(t){if(t){setTimeout(function(){n.closeIt({keyCode:9,shiftKey:true})},10)}},tab:function e(t){if(t){setTimeout(function(){n.closeIt({keyCode:9})},10)}}}});this.tabKeyPress=false;this.$el.datetimepicker(i);this.$el.datetimepicker("show");this.picker=this.$el.data("DateTimePicker")},events:{"hide.datetimepicker":"closeIt",focusout:"closeIt",keydown:"keydownHandler"},keydownHandler:function e(t){var i=this;var n=true;if(t.keyCode===9&&i.el===t.target){i.closeIt(t,n)}},closeIt:function e(t,i){if(this.is_closing||this.tabKeyPress)return;this.is_closing=true;this.tabKeyPress=i;var n=this.formatter,s=this.model,a=this.column,l=this.$el.val(),r=n.toRaw(l,s);this.$el.datetimepicker("destroy");this.is_closing=false;if(g.isUndefined(r)){s.trigger("backgrid:error",s,a,l)}else{s.set(a.get("name"),r);var o=new b.Command(t);setTimeout(function(){s.trigger("backgrid:edited",s,a,o)},20)}}});g.extend(N.prototype,k.prototype.defaults);b.Extension.StringDepCell=b.StringCell.extend({initialize:function e(){b.StringCell.prototype.initialize.apply(this,arguments);b.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function e(){this.$el.empty();var t=this,i=this.model,n=this.column,s=this.column.get("editable");this.render();var a=g.isFunction(s)?!!s.apply(n,[i]):!!s;setTimeout(function(){t.$el.removeClass("editor");if(a){t.$el.addClass("editable")}else{t.$el.removeClass("editable")}},10);this.delegateEvents();return this},remove:b.Extension.DependentCell.prototype.remove});b.Extension.Select2DepCell=b.Extension.Select2Cell.extend({initialize:function e(){b.Extension.Select2Cell.prototype.initialize.apply(this,arguments);b.Extension.DependentCell.prototype.initialize.apply(this,arguments)},dependentChanged:function e(){var t=this.model,i=this.column,n=this.column.get("editable");this.render();if(g.isFunction(n)?!!n.apply(i,[t]):!!n){this.$el.addClass("editable")}else{this.$el.removeClass("editable")}this.delegateEvents();return this},remove:b.Extension.DependentCell.prototype.remove});b.Extension.ClientSideFilter=b.Extension.ClientSideFilter.extend({$customSearchBox:null,searchBox:function e(){if(this.$customSearchBox){return this.$customSearchBox}else{return this.$el.find("input[type=search]")}},setCustomSearchBox:function e(t){this.$customSearchBox=t;this.$customSearchBox.attr("type","search");this.$customSearchBox.on("keydown",this.search.bind(this))},unsetCustomSearchBox:function e(){this.$customSearchBox.off("keydown",this.search.bind(this));this.$customSearchBox=null}});b.BooleanCellFormatter=g.extend(b.CellFormatter.prototype,{fromRaw:function e(t){if(g.isUndefined(t)||g.isNull(t)){return false}else if(t==="1"||t==="True"){return true}else if(t==="0"||t==="False"){return false}return t},toRaw:function e(t){return t}});return b}.apply(s,t),i!==undefined&&(n.exports=i))}).call(this,a(3),a(0))},16:function(e,t,i){"use strict";var n,s;!(n=[i(2),i(1),i(0),i(9),i(22),i(19),i(18),i(27),i(35)],s=function(b,d,y,a,e,o,t,r){var c=r.Model.extend({idAttribute:"privilege_type",defaults:{privilege_type:undefined,privilege:false,with_grant:false},validate:function e(){return null}});var i=r.PrivilegeRoleModel=r.Model.extend({idAttribute:"grantee",defaults:{grantee:undefined,grantor:undefined,privileges:undefined},keys:["grantee","grantor"],privileges:[],schema:[{id:"grantee",label:b("Grantee"),type:"text",group:null,editable:true,cellHeaderClasses:"width_percent_40",node:"role",options_cached:false,disabled:function e(t){if(!(t instanceof a.Model)){return false}return!(t.top&&t.top.node_info&&t.top.node_info.server.user.name==t.get("grantor"))},transform:function e(){var t=o.Extension.NodeListByNameCell.prototype.defaults.transform.apply(this,arguments);t.unshift({label:"PUBLIC",value:"PUBLIC"});return t},cell:o.Extension.NodeListByNameCell.extend({initialize:function e(t){var i=this,n=true;if(t&&t.column&&t.column instanceof a.Model&&t.column.get("options_cached")){n=false}o.Extension.NodeListByNameCell.prototype.initialize.apply(i,arguments);if(n){t=i.column.get("options");i.column.set("options",i.omit_selected_roles.bind(i,t))}var s=function(e){var t=this;if("grantee"in e.changed&&this.model.cid!=e.cid){setTimeout(function(){t.render()},50)}}.bind(this);this.listenTo(i.model.collection,"change",s,this);this.listenTo(i.model.collection,"remove",s,this)},omit_selected_roles:function e(t,i){var n=t(i),s={},a=i.model,l=a.cid,r=d.has(a.top,"node_info")&&!d.isUndefined(a.top.node_info)?a.top.node_info:a.handler.top.node_info,o=r.server.user.name;a.collection.each(function(e){var t=e.get("grantee");if(e.cid!=l&&!d.isUndefined(t)&&o==e.get("grantor")){s[t]=e.cid}});n=d.filter(n,function(e){return!(e.value in s)});return n}})},{id:"privileges",label:b("Privileges"),type:"collection",model:c,group:null,cell:"privilege",control:"text",cellHeaderClasses:"width_percent_40",disabled:function e(t){if(t instanceof a.Collection){return false}return!(this.node_info&&this.node_info.server.user.name==t.get("grantor")||this.attributes.node_info.server.user.name==t.get("grantor"))}},{id:"grantor",label:b("Grantor"),type:"text",disabled:true,cell:"node-list-by-name",node:"role"}],initialize:function e(t,i){r.Model.prototype.initialize.apply(this,arguments);if(d.isNull(t)){this.set("grantor",i&&i.top&&i.top.node_info&&i.top.node_info.server.user.name,{silent:true})}var n=this,s=n.get("privileges"),a=this.get("privileges")||{};if(d.isArray(a)){a=new r.Collection(s,{model:c,top:this.top||this,handler:this,silent:true,parse:false});this.set("privileges",a,{silent:true})}var l={};d.each(n.privileges,function(e){l[e]={privilege_type:e,privilege:false,with_grant:false}});a.each(function(e){delete l[e.get("privilege_type")]});d.each(l,function(e){a.add(e,{silent:true})});n.on("change:grantee",n.granteeChanged);a.on("change",function(){n.trigger("change:privileges",n)});return n},granteeChanged:function e(){var t=this.get("privileges"),i=this.get("grantee");if(i=="PUBLIC"){t.each(function(e){e.set("with_grant",false,{silent:true})})}},toJSON:function e(){var t=[];if(this.attributes&&!this.attributes["privileges"]){return null}this.attributes["privileges"].each(function(e){if(e.get("privilege")){t.push(e.toJSON())}});return{grantee:this.get("grantee"),grantor:this.get("grantor"),privileges:t}},validate:function e(){var t=null,i;if(d.isUndefined(this.get("grantee"))){i=b("A grantee must be selected.");this.errorModel.set("grantee",i);t=i}else{this.errorModel.unset("grantee")}if(this.attributes&&this.attributes["privileges"]){var n=false;this.attributes["privileges"].each(function(e){if(e.get("privilege")){n=true}});if(!n){i=b("At least one privilege should be selected.");this.errorModel.set("privileges",i);t=t||i}else{this.errorModel.unset("privileges")}}return t}});var n=o.Extension.PrivilegeCellEditor=o.CellEditor.extend({tagName:"div",Labels:{C:"CREATE",T:"TEMPORARY",c:"CONNECT",a:"INSERT",r:"SELECT",w:"UPDATE",d:"DELETE",D:"TRUNCATE",x:"REFERENCES",t:"TRIGGER",U:"USAGE",X:"EXECUTE"},template:d.template(['<tr class="<%= header ? "header" : "" %>">',' <td class="renderable">','  <label class="privilege_label">','   <input type="checkbox" tabindex="1" name="privilege" privilege="<%- privilege_type %>" target="<%- target %>" <%= privilege ? \'checked\' : "" %>></input>',"   <%- privilege_label %>","  </label>"," </td>",' <td class="renderable">','  <label class="privilege_label">','   <input type="checkbox" tabindex="1" name="with_grant" privilege="<%- privilege_type %>" target="<%- target %>" <%= with_grant ? \'checked\' : "" %> <%= enable_with_grant ? "" : \'disabled\'%>></input>',"   WITH GRANT OPTION","  </label>"," </td>","</tr>"].join(" "),null,{variable:null}),events:{change:"privilegeChanged",blur:"lostFocus",keydown:"lostFocus"},render:function e(){this.$el.empty();this.$el.attr("tabindex","1");this.$el.attr("target",this.elId);var t=this.model.get(this.column.get("name")),i=y("<table></table>").appendTo(this.$el),n=this,s=true,a=true;t.each(function(e){var t=e.toJSON();s=s&&t.privilege;a=a&&s&&t.with_grant;d.extend(t,{target:n.cid,header:false,privilege_label:n.Labels[t.privilege_type],with_grant:n.model.get("grantee")!="PUBLIC"&&t.with_grant,enable_with_grant:n.model.get("grantee")!="PUBLIC"&&t.privilege});s=s&&t.privilege;a=a&&s&&t.with_grant;i.append(n.template(t))});if(t.length>1){i.prepend(n.template({target:n.cid,privilege_label:"ALL",privilege_type:"ALL",privilege:s,with_grant:n.model.get("grantee")!="PUBLIC"&&a,enable_with_grant:n.model.get("grantee")!="PUBLIC"&&s,header:true}))}n.$el.find("input[type=checkbox]").first().trigger("focus");y(n.$el.find("input[type=checkbox]")).on("blur",function(){n.$el.trigger("blur")});y(n.$el).pgMakeVisible("backform-tab");n.delegateEvents();return this},privilegeChanged:function e(t){if(t&&t.target){var i=y(t.target),n=i.attr("privilege"),s=i.attr("name"),a=i.prop("checked"),l=i.closest("tr"),r=l.closest("table"),o=this.model.get("privileges"),d=this.model.get("grantee"),c,u,f;this.undelegateEvents();if(n=="ALL"){var p,h;f=l.find("input[name=with_grant]");u=r.find("input[name=privilege][privilege!='ALL']");c=r.find("input[name=with_grant][privilege!='ALL']");if(s=="privilege"){p=a;h=false;if(a){u.prop("checked",true);if(d=="PUBLIC"){c.prop("disabled",true);f.prop("disabled",true)}else{c.prop("disabled",false);f.prop("disabled",false)}}else{u.prop("checked",false);f.prop("checked",false),c.prop("checked",false);f.prop("disabled",true);c.prop("disabled",true)}}else{p=true;h=a;c.prop("checked",a)}o.each(function(e){e.set({privilege:p,with_grant:h},{silent:true})})}else{var m={};r=l.closest("table");u=r.find("input[name=privilege][privilege='ALL']");c=r.find("input[name=with_grant][privilege='ALL']");m[s]=a;if(s=="privilege"){f=i.closest("tr").find("input[name=with_grant]");if(!a){m["with_grant"]=false;f.prop("checked",false).prop("disabled",true);u.prop("checked",false);c.prop("disabled",true);c.prop("checked",false)}else if(d!="PUBLIC"){f.prop("disabled",false)}}else if(!a){c.prop("checked",false)}o.get(n).set(m,{silent:true});if(a){u=r.find("input[name=privilege][privilege!='ALL']:checked");if(u.length>1&&u.length==o.models.length){u.prop("checked",true);if(s=="with_grant"){c=r.find("input[name=with_grant][privilege!='ALL']:checked");if(c.length==o.models.length){c.prop("disabled",false);c.prop("checked",true)}}else if(d!="PUBLIC"){c.prop("disabled",false)}}}}this.model.trigger("change",this.model);var g=false,v=null;o.each(function(e){g=g||e.get("privilege")});if(g){this.model.errorModel.unset("privileges");if(this.model.errorModel.has("grantee")){v=this.model.errorModel.get("grantee")}}else{this.model.errorModel.set("privileges",b("At least one privilege should be selected."));v=b("At least one privilege should be selected.")}if(v){this.model.collection.trigger("pgadmin-session:model:invalid",v,this.model)}else{this.model.collection.trigger("pgadmin-session:model:valid",this.model)}}this.delegateEvents()},lostFocus:function e(i){var n=this,s=function e(t,i){var n=i.parentNode;while(n!=null){if(n==t){return true}n=n.parentNode}return false},t=this.model,a=this.column,l=new o.Command(i),r=this.model.get(this.column.get("name"));if(l.moveUp()||l.moveDown()||l.save()){i.preventDefault();i.stopPropagation();t.trigger("backgrid:edited",t,a,l);return}else if(l.cancel()){i.stopPropagation();t.trigger("backgrid:edited",t,a,l);return}else if(l.moveRight()){if(r.last().get("privilege_type")===y(i.target).attr("privilege")){if(i.target.name==="privilege"&&!i.target.checked||y(i.target).attr("name")==="with_grant"){i.stopPropagation();t.trigger("backgrid:edited",t,a,l);return}}}else if(l.moveLeft()&&i.target.name==="privilege"&&y(i.target).attr("privilege")==="ALL"){i.stopPropagation();t.trigger("backgrid:edited",t,a,l);return}setTimeout(function(){var e=document.activeElement.tagName=="DIV"||document.activeElement.tagName=="BUTTON";if(e&&n.$el[0]!=document.activeElement&&!s(n.$el[0],document.activeElement)){var t=n.model;t.trigger("backgrid:edited",t,n.column,new o.Command(i))}},10)}});var s=o.Extension.PrivilegeCellFormatter=function(){};d.extend(s.prototype,{notation:{CREATE:"C",TEMPORARY:"T",CONNECT:"c",INSERT:"a",SELECT:"r",UPDATE:"w",DELETE:"d",TRUNCATE:"D",REFERENCES:"x",TRIGGER:"t",USAGE:"U",EXECUTE:"X"},fromRaw:function e(t){var i="";if(t instanceof a.Collection){t.each(function(e){if(e.get("privilege")){i+=e.get("privilege_type");if(e.get("with_grant")){i+="*"}}})}return i}});o.Extension.PrivilegeCell=o.Cell.extend({className:"edit-cell",formatter:s,editor:n,initialize:function e(){var t=this;o.Cell.prototype.initialize.apply(this,arguments);t.model.on("change:grantee",function(){if(!t.$el.hasClass("editor")){setTimeout(function(){t.render()},10)}})},events:{click:"enterEditMode",keydown:"saveOrCancel"},saveOrCancel:function e(t){var i=this.model;var n=this.column;var s=new o.Command(t);if(s.moveUp()||s.moveDown()||s.moveLeft()||s.moveRight()||s.save()){t.preventDefault();t.stopPropagation();i.trigger("backgrid:edited",i,n,s)}else if(s.cancel()){t.stopPropagation();i.trigger("backgrid:edited",i,n,s)}}});return i}.apply(t,n),s!==undefined&&(e.exports=s))},192:function(e,t,i){"use strict";var n,s;function l(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){l=function e(t){return typeof t}}else{l=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return l(e)}!(n=[i(1),i(8),i(3),i(0)],s=function(y,s,C,p){"use strict";C.Browser=C.Browser||{};var _=C.Browser.MenuItem=function(e){var t=["name","label","priority","module","callback","data","enable","category","target","url","node","checked","menu_items"],i={url:"#",target:"_self",enable:true};y.extend(this,i,y.pick(e,t))};y.extend(C.Browser.MenuItem.prototype,{$el:null,generate:function e(t,i){this.create_el(t,i);this.context={name:this.label,disabled:this.is_disabled,callback:this.context_menu_callback.bind(this,i)};return this.$el},create_el:function e(t,i){if(this.menu_items){y.each(this.menu_items,function(e){e.generate(t,i)});var n=C.Browser.MenuGroup({label:this.label,id:this.name},this.menu_items);this.$el=n.$el}else{var s=p("<a></a>",{id:this.name,href:this.url,target:this.target,"data-toggle":"pg-menu"}).data("pgMenu",{module:this.module||C.Browser,cb:this.callback,data:this.data}).addClass("dropdown-item");this.is_disabled=this.disabled(t,i);if(this.icon){s.append(p("<i></i>",{class:this.icon}))}else if(!y.isUndefined(this.checked)){s.append(p("<i></i>",{class:"fa fa-check "+(this.checked?"":"visibility-hidden")}))}s.addClass(this.is_disabled?" disabled":"");var a=p('<span data-test="menu-item-text"></span>').text("  "+this.label);s.append(a);this.$el=p("<li/>").append(s)}},update:function e(t,i){if(this.$el&&!this.$el.find(".dropdown-item").hasClass("disabled")){this.$el.find(".dropdown-item").addClass("disabled")}this.is_disabled=this.disabled(t,i);if(this.$el&&!this.is_disabled){this.$el.find(".dropdown-item").removeClass("disabled")}this.context={name:this.label,disabled:this.is_disabled,callback:this.context_menu_callback.bind(this,i)}},context_menu_callback:function e(t){var i=this,n;if(i.module["callbacks"]&&i.callback in i.module["callbacks"]){n=i.module["callbacks"][i.callback]}else if(i.callback in i.module){n=i.module[i.callback]}if(n){n.apply(i.module,[i.data,t])}else{C.Browser.report_error(s('Developer Warning: Callback - "%s" not found!').sprintf(i.cb).value())}},disabled:function e(t,i){if(this.enable==undefined){return false}if(this.node){if(!t){return true}if(y.isArray(this.node)?y.indexOf(this.node,t)==-1:this.node!=t._type){return true}}if(y.isBoolean(this.enable))return!this.enable;if(y.isFunction(this.enable))return!this.enable.apply(this.module,[t,i,this.data]);if(this.module&&y.isBoolean(this.module[this.enable]))return!this.module[this.enable];if(this.module&&y.isFunction(this.module[this.enable]))return!this.module[this.enable].apply(this.module,[t,i,this.data]);return false},change_checked:function e(t){if(!y.isUndefined(this.checked)){this.checked=t;if(this.checked){this.$el.find(".fa-check").removeClass("visibility-hidden")}else{this.$el.find(".fa-check").addClass("visibility-hidden")}}}});C.Browser.MenuGroup=function(e,t,i,n){var s=y.template(['<% if (above) { %><li class="dropdown-divider"></li><% } %>','<li class="dropdown-submenu">',' <a href="#" class="dropdown-item">','  <% if (icon) { %><i class="<%= icon %>"></i><% } %>',"  <span><%= label %></span>"," </a>",' <ul class="dropdown-menu">'," </ul>","</li>",'<% if (below) { %><li class="dropdown-divider"></li><% } %>'].join("\n")),a={label:e.label,icon:e.icon,above:e.above&&!i,below:e.below},l,r=p(s(a)),o=r.find(".dropdown-menu"),d={},c=1;n=y.uniqueId(n+"_sub_");t.sort(function(e,t){return e.label.localeCompare(t.label)});t.sort(function(e,t){return e.priority-t.priority});for(var u in t){l=t[u];o.append(l.$el);if(!l.is_disabled){d[n+c]=l.context}c++}var f=y.size(d)==0;return{$el:r,priority:e.priority||10,label:e.label,above:a["above"],below:e.below,is_disabled:f,context:{name:e.label,icon:e.icon,items:d,disabled:f}}};C.Browser.MenuCreator=function(e,t,i,s,a,n){var l={common:[]},r,o=0,d=y.uniqueId("ctx_"),c=function e(t){if(t instanceof _){if(t.$el){t.$el.remove();delete t.$el}t.generate(s,a);var i=l[t.category||"common"]=l[t.category||"common"]||[];i.push(t)}else{for(var n in t){e(t[n])}}},u=1;for(o in t){c(t[o])}n=n||{};r=l["common"];delete l["common"];var f=true;for(var p in l){var h=l[p],m=i[p]||{label:p,single:false},g=C.Browser.MenuGroup(m,h,f,d);if(h.length<=1&&!m.single){f=false;for(o in h){r.push(h[o])}}else{f=h.below;r.push(g)}}r.sort(function(e,t){return e.label.localeCompare(t.label)});r.sort(function(e,t){return e.priority-t.priority});var v=y.size(r);for(o in r){a=r[o];a.priority=a.priority||10;e.append(a.$el);var b=d+"_"+a.priority+"_"+u;if(u!=1&&a.above&&!a.is_disabled){n[b+"_ma"]="----"}if(!a.is_disabled){n[b+"_ms"]=a.context}if(d!=v&&a.below&&!a.is_disabled){n[b+"_mz"]="----"}u++}return v>0};var a=function e(t,i){this.$element=p(t);this.options=p.extend({},e.DEFAULTS,i);this.isLoading=false};a.DEFAULTS={};a.prototype.toggle=function(e){var t=this.$element.closest(".dropdown-item");if(t.hasClass("disabled")){e.preventDefault();return false}var i=this.$element.data("pgMenu");if(i.cb){var n=i.module&&i.module["callbacks"]&&i.module["callbacks"][i.cb]||i.module&&i.module[i.cb];if(n){n.apply(i.module,[i.data,C.Browser.tree.selected()]);e.preventDefault()}else{C.Browser.report_error('Developer Warning: Callback - "'+i.cb+'" not found!')}}};function i(n,s){return this.each(function(){var e=p(this);var t=e.data("pg.menu");var i=l(n)=="object"&&n;if(!t)e.data("pg.menu",t=new a(this,i));t.toggle(s)})}var e=p.fn.button;p.fn.pgmenu=i;p.fn.pgmenu.Constructor=a;p.fn.pgmenu.noConflict=function(){p.fn.pgmenu=e;return this};p(document).on("click.pg.menu.data-api",'[data-toggle^="pg-menu"]',function(e){var t=p(e.target);if(!t.hasClass("dropdown-item"))t=t.closest(".dropdown-item");i.call(t,"toggle",e)}).on("focus.pg.menu.data-api blur.pg.menu.data-api",'[data-toggle^="pg-menu"]',function(e){p(e.target).closest(".menu").toggleClass("focus",/^focus(in)?$/.test(e.type))}).on("mouseenter",".dropdown-submenu",function(e){p(e.currentTarget).removeClass("dropdown-submenu-visible").addClass("dropdown-submenu-visible");p(e.currentTarget).find(".dropdown-menu").first().addClass("show")}).on("mouseleave",".dropdown-submenu",function(e){p(e.currentTarget).removeClass("dropdown-submenu-visible");p(e.currentTarget).find(".dropdown-menu").first().removeClass("show")}).on("hidden.bs.dropdown",function(e){p(e.target).find(".dropdown-submenu.dropdown-submenu-visible").removeClass("dropdown-submenu-visible").find(".dropdown-menu.show").removeClass("show")});return C.Browser.MenuItem}.apply(t,n),s!==undefined&&(e.exports=s))},193:function(e,t,i){"use strict";var n,s;!(n=[i(1),i(3),i(0),i(21)],s=function(a,e,l){var r=e.Browser=e.Browser||{},o=window.wcDocker,d=window.wcIFrame;e.Browser.Frame=function(e){var t=["name","title","width","height","showTitle","isCloseable","isPrivate","url","icon","onCreate"];a.extend(this,a.pick(e,t))};a.extend(e.Browser.Frame.prototype,{name:"",title:"",width:300,height:600,showTitle:true,isClosable:true,isPrivate:false,url:"",icon:"",panel:null,frame:null,onCreate:null,load:function e(t){var s=this;if(!s.panel){t.registerPanelType(this.name,{title:s.title,isPrivate:s.isPrivate,onCreate:function e(i){l(i).data("pgAdminName",s.name);i.initSize(s.width,s.height);if(i.showTitle==false)i.title(false);i.icon(s.icon);i.closeable(!!s.isCloseable);var t=l('<div style="position:absolute;top:0 !important;width:100%;height:100%;display:table;z-index:0;">');i.layout().addItem(t);s.panel=i;var n=new d(t,i);l(i).data("frameInitialized",false);l(i).data("embeddedFrame",n);if(s.url!=""&&s.url!="about:blank"){setTimeout(function(){n.openURL(s.url);l(i).data("frameInitialized",true);r.Events.trigger("pgadmin-browser:frame:urlloaded:"+s.name,n,s.url,self)},50)}else{n.openURL("about:blank");l(i).data("frameInitialized",true);r.Events.trigger("pgadmin-browser:frame:urlloaded:"+s.name,n,s.url,self)}if(s.events&&a.isObject(s.events)){a.each(s.events,function(e,t){if(e&&a.isFunction(e)){i.on(t,e)}})}a.each([o.EVENT.UPDATED,o.EVENT.VISIBILITY_CHANGED,o.EVENT.BEGIN_DOCK,o.EVENT.END_DOCK,o.EVENT.GAIN_FOCUS,o.EVENT.LOST_FOCUS,o.EVENT.CLOSED,o.EVENT.BUTTON,o.EVENT.ATTACHED,o.EVENT.DETACHED,o.EVENT.MOVE_STARTED,o.EVENT.MOVE_ENDED,o.EVENT.MOVED,o.EVENT.RESIZE_STARTED,o.EVENT.RESIZE_ENDED,o.EVENT.RESIZED,o.EVENT.SCROLLED],function(e){i.on(e,s.eventFunc.bind(i,e))});if(s.onCreate&&a.isFunction(s.onCreate)){s.onCreate.apply(s,[i,n])}}})}},eventFunc:function e(t){var i=l(this).data("pgAdminName");try{r.Events.trigger("pgadmin-browser:frame",t,this,arguments);r.Events.trigger("pgadmin-browser:frame:"+t,this,arguments);if(i){r.Events.trigger("pgadmin-browser:frame-"+i,t,this,arguments);r.Events.trigger("pgadmin-browser:frame-"+i+":"+t,this,arguments)}}catch(e){console.warn(e.stack||e)}}});return e.Browser.Frame}.apply(t,n),s!==undefined&&(e.exports=s))},194:function(e,t,i){"use strict";var n,s;i(195);i(196);!(n=[i(2),i(4),i(0),i(1),i(3),i(10)],s=function(e,t,i,n,s,a){s=s||window.pgAdmin||{};if(s.FileManager){return s.FileManager}s.FileManager={init:function e(){if(this.initialized){return}this.initialized=true},show_dialog:function e(t){if(t.dialog_type=="create_file"){a.createModeDlg(t).resizeTo(s.Browser.stdW.md,s.Browser.stdH.lg)}else{a.fileSelectionDlg(t).resizeTo(s.Browser.stdW.md,s.Browser.stdH.lg)}}};return s.FileManager}.apply(t,n),s!==undefined&&(e.exports=s))},27:function(e,t,i){"use strict";var n,s;!(n=[i(20),i(4),i(2),i(0),i(1),i(8),i(3),i(192),i(9),i(10),i(294),i(22),i(81),i(80),i(17),i(48),i(6)],s=function(e,t,E,T,S,x,D,i,n,M,I,k,h,A,$){var O=window.wcDocker,B={ENTER:13,ESCAPE:27,F1:112};if(I.Node)return I.Node;I.Nodes=I.Nodes||{};I.Node=function(){};I.Node.extend=function(e,t){var i=this;var n;n=function e(){return i.apply(this,arguments)};S.extend(n,i,S.omit(e,"callbacks"));n.callbacks=S.extend({},i.callbacks,e.callbacks);if(t===false)return n;var s=function e(t){if(typeof n.callbacks[t]=="function"){n.callbacks[t]=n.callbacks[t].bind(n)}},a=S.keys(n.callbacks);for(var l=0;l<a.length;l++){s(a[l])}n.Init.apply(n);this.Init.apply(n);return n};S.extend(D.Browser.Node,n.Events,{type:undefined,label:"",sqlAlterHelp:"",sqlCreateHelp:"",dialogHelp:"",title:function e(t,i){return t.label+(i?" - "+i.label:"")},hasId:true,Init:function e(){var i=this;if(i.node_initialized)return;i.node_initialized=true;D.Browser.add_menus([{name:"refresh",node:i.type,module:i,applies:["object","context"],callback:"refresh",priority:1,label:E("Refresh..."),icon:"fa fa-refresh"}]);if(i.canEdit){D.Browser.add_menus([{name:"show_obj_properties",node:i.type,module:i,applies:["object","context"],callback:"show_obj_properties",priority:999,label:E("Properties..."),data:{action:"edit"},icon:"fa fa-pencil-square-o"}])}if(i.canDrop){D.Browser.add_menus([{name:"delete_object",node:i.type,module:i,applies:["object","context"],callback:"delete_obj",priority:2,label:E("Delete/Drop"),data:{url:"drop"},icon:"fa fa-trash",enable:S.isFunction(i.canDrop)?function(){return!!i.canDrop.apply(i,arguments)}:!!i.canDrop}]);if(i.canDropCascade){D.Browser.add_menus([{name:"delete_object_cascade",node:i.type,module:i,applies:["object","context"],callback:"delete_obj",priority:3,label:E("Drop Cascade"),data:{url:"delete"},icon:"fa fa-trash",enable:S.isFunction(i.canDropCascade)?function(){return i.canDropCascade.apply(i,arguments)}:!!i.canDropCascade}])}}if(S.indexOf(D.unsupported_nodes,i.type)==-1){D.Browser.add_menus([{name:"show_query_tool",node:i.type,module:i,applies:["context"],callback:"show_query_tool",priority:998,label:E("Query Tool..."),icon:"fa fa-bolt",enable:function e(t){if(t._type=="database"&&t.allowConn)return true;else if(t._type!="database")return true;else return false}}])}if(i.hasScriptTypes&&S.isArray(i.hasScriptTypes)&&i.hasScriptTypes.length>0){S.each(i.hasScriptTypes,function(e){var t=x(E("%s Script")).sprintf(e.toUpperCase()).value();e=e.toLowerCase();D.Browser.add_menus([{name:"show_script_"+e,node:i.type,module:i,applies:["object","context"],callback:"show_script",priority:4,label:t,category:"Scripts",data:{script:e},icon:"fa fa-pencil",enable:i.check_user_permission}])})}},check_user_permission:function e(t,i,n){if(t._type=="server_group"||t._type=="server"){return false}if(t._type=="database"&&!t.allowConn)return false;var s=I.Nodes[t._type],a=s.getTreeNodeHierarchy(i);if(S.indexOf(["create","insert","update","delete"],n.script)!=-1){if(t.type=="role"&&a.server.user.can_create_role){return true}else if(a.server&&(a.server.user.is_superuser||a.server.user.can_create_db)||a.schema&&a.schema.can_create){return true}else{return false}}else{return true}},getView:function e(l,t,i,n,s,a,r,o){var d=this;if(!this.type||this.type=="")return null;if(this.model){var c=this.generate_url(l,t,n,false);if(!c)return null;var u={};if(t!=="create"){u[this.model.idAttribute||this.model.prototype.idAttribute||"id"]=n._id}var f=this.getTreeNodeHierarchy.apply(this,[l]),p=new(this.model.extend({urlRoot:c}))(u,{node_info:f}),h=k.generateViewSchema(f,p,t,this,n);if(t=="create"||t=="edit"){if(a&&r){a=a.bind(r)}else{a=function e(){console.warn("Broke something!!! Why we don't have the callback or the context???")}}var m=function e(t){var i='\n            <div class="error-in-footer">\n              <div class="d-flex px-2 py-1">\n                <div class="pr-2">\n                  <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i>\n                </div>\n                <div class="alert-text">'.concat(t,'</div>\n                <div class="ml-auto close-error-bar">\n                  <a class="close-error fa fa-times text-danger"></a>\n                </div>\n              </div>\n            </div>');if(!S.isUndefined(d.statusBar)){d.statusBar.html(i).css("visibility","visible");d.statusBar.find("a.close-error").bind("click",function(){this.empty().css("visibility","hidden")}.bind(d.statusBar))}a(true);return true};var g=function e(t){if(!S.isUndefined(d.statusBar)){d.statusBar.empty().css("visibility","hidden")}a(false,t)};a(false,false);p.on("pgadmin-session:valid",g);p.on("pgadmin-session:invalid",m)}if(S.size(h)){var v;if(s=="fieldset"){v=new k.Accordian({el:i,model:p,schema:h})}else{v=new k.Dialog({el:i,model:p,schema:h})}var b=function e(){var t=T(i).find(".tab-content:first > .tab-pane.active:first");$.findAndSetFocus(t)};if(!p.isNew()){var y='<div class="alert alert-info pg-panel-message pg-panel-properties-message">'+E("Retrieving data from the server...")+"</div>",C=T(y);var _=setTimeout(function(e){if(!S.isUndefined(e)){C.appendTo(e)}},1e3,r);var w=function a(){p.fetch({success:function e(){clearTimeout(_);C.addClass("d-none");v.render();b();p.startNewSession()},error:function e(t,i,n){var s=d&&l?d.getTreeNodeHierarchy(l)[d.type].label:"";I.Events.trigger("pgadmin:node:retrieval:error","properties",i,n.textStatus,n.errorThrown,l);if(!M.pgHandleItemError(i,n.textStatus,n.errorThrown,{item:l,info:f})){M.pgNotifier(n.textStatus,i,x(E("Error retrieving properties - %s")).sprintf(n.errorThrown||s).value(),function(e){if(e==="CRYPTKEY_SET"){a()}else{console.warn(arguments)}})}if(o){o()}}})};w()}else{v.render();b();p.startNewSession()}}return v}return null},register_node_panel:function e(){var t=I.docker,i=t.findPanels("node_props");if(i&&i.length==1)return;var n={};n[O.EVENT.RESIZE_ENDED]=function(){var e=this.$container.find(".obj_properties").first(),t=e.data("obj-view");if(t&&t.model&&t.model){t.model.trigger("pg-browser-resized",{view:t,panel:this,container:e})}};i=new I.Panel({name:"node_props",showTitle:true,isCloseable:true,isPrivate:true,isLayoutMember:false,elContainer:true,content:'<div class="obj_properties container-fluid"><div class="alert alert-info pg-panel-message">'+E("Please wait while we fetch information about the node from the server...")+"</div></div>",onCreate:function e(t,i){i.addClass("pg-no-overflow")},events:n});i.load(I.docker)},hasScriptTypes:["create"],canEdit:true,canDrop:false,canDropCascade:false,callbacks:{show_obj_properties:function e(t,i){var n=I.tree,s=t&&t.item||i||n.selected(),a=s&&s.length==1?n.itemData(s):undefined,l=this,r=l.title.apply(this,[a]);I.Node.register_node_panel();if(!a)return;var d=this,o=S.isArray(this.parent_type)?function(e){return S.indexOf(d.parent_type,e._type)!=-1}:function(e){return d.parent_type==e._type},c=function e(){var t=window.document,i=t.body,n=t.createElement("div");t.body.insertBefore(n,t.body.firstChild);var s,a,l,r;if(screen.width<800){s=D.toPx(n,"95%","width",true)}else{s=D.toPx(n,d.width||I.stdW.default+"px","width",true);if(s<=I.stdW.sm){s=I.stdW.sm}else{if(s<=I.stdW.md){s=I.stdW.md}else{s=I.stdW.lg}}}if(screen.height<600){a=D.toPx(n,"95%","height",true)}else{a=D.toPx(n,d.height||I.stdH.default+"px","height",true);if(a<=I.stdH.sm){a=I.stdH.sm}else{if(a<=I.stdH.md){a=I.stdH.md}else{a=I.stdH.lg}}}l=(i.offsetWidth-s)/2,r=(i.offsetHeight-a)/4;var o=I.docker.addPanel("node_props",O.DOCK.FLOAT,undefined,{w:s+"px",h:a+"px",x:l+"px",y:r+"px"});i.removeChild(n);return o};if(t.action=="create"){if(d.parent_type&&!o(a)){while(s&&n.hasParent(s)){s=n.parent(s);var u=n.itemData(s);if(o(u)){a=u;break}}}if(!a||this.parent_type!=null&&!o(a)){return}if(!a)return;r=x(E("Create - %s")).sprintf([this.label]).value();f=c();setTimeout(function(){l.showProperties(s,a,f,t.action)},10)}else{if(I.Node.panels&&I.Node.panels[a.id]&&I.Node.panels[a.id].$container){var f=I.Node.panels[a.id];var p=f.$container.attr("action-mode");if(p){var h=E('Are you sure want to stop editing the properties of %s "%s"?');if(t.action=="edit"){h=E('Are you sure want to reset the current changes and re-open the panel for %s "%s"?')}M.confirm(E("Edit in progress?"),x(h).sprintf(l.label.toLowerCase(),a.label).value(),function(){setTimeout(function(){l.showProperties(s,a,f,t.action)},10)},null).show()}else{setTimeout(function(){l.showProperties(s,a,f,t.action)},10)}}else{I.Node.panels=I.Node.panels||{};f=I.Node.panels[a.id]=c();setTimeout(function(){l.showProperties(s,a,f,t.action)},10)}}f.title(r);f.icon("icon-"+this.type);f.focus()},delete_obj:function e(t,i){var n=t||{url:"drop"},s=this,a=I.tree,l=n.item||i||a.selected(),r=l&&l.length==1?a.itemData(l):undefined;if(!r)return;s=I.Nodes[r._type];var o=r.label;var d,c;if(n.url=="delete"){d=x(E('Are you sure you want to drop %s "%s" and all the objects that depend on it?')).sprintf(s.label.toLowerCase(),r.label).value();c=x(E("DROP CASCADE %s?")).sprintf(s.label).value();if(!(S.isFunction(s.canDropCascade)?s.canDropCascade.apply(s,[r,l]):s.canDropCascade)){M.error(x(E('The %s "%s" cannot be dropped.')).sprintf(s.label,r.label).value(),10);return}}else{d=x(E('Are you sure you want to drop %s "%s"?')).sprintf(s.label.toLowerCase(),r.label).value();c=x(E("DROP %s?")).sprintf(s.label).value();if(!(S.isFunction(s.canDrop)?s.canDrop.apply(s,[r,l]):s.canDrop)){M.error(x(E('The %s "%s" cannot be dropped.')).sprintf(s.label,r.label).value(),10);return}}M.confirm(c,d,function(){T.ajax({url:s.generate_url(l,n.url,r,true),type:"DELETE"}).done(function(e){if(e.success==0){I.report_error(e.errormsg,e.info)}else{I.removeTreeNode(l,true)}return true}).fail(function(e){var t=e.responseText;if(e.status==417||e.status==410||e.status==500){try{var i=JSON.parse(e.responseText);t=i.errormsg}catch(e){console.warn(e.stack||e)}}I.report_error(x(E('Error dropping %s: "%s"')).sprintf(s.label,o).value(),t)})},null).show()},show_script:function e(t,i){var n=t.script,s=this,a=I.tree,l=i||a.selected(),r=l&&l.length==1?a.itemData(l):undefined;if(!r)return;s=I.Nodes[r._type];var o;if(n=="insert"){o="insert_sql"}else if(n=="update"){o="update_sql"}else if(n=="delete"){o="delete_sql"}else if(n=="select"){o="select_sql"}else if(n=="exec"){o="exec_sql"}else{o="sql"}D.DataGrid.show_query_tool(s.generate_url(l,o,r,true),l,n)},show_query_tool:function e(t,i){var n=I.tree,s=i||n.selected(),a=s&&s.length==1?n.itemData(s):undefined;if(!a)return;D.DataGrid.show_query_tool("",s)},change_server_background:function e(t,i){if(!t||!i)return;if(i&&i._type&&i._type=="server"){var n=T(t).find("span.aciTreeItem").first()||null,s=i.icon.split(" ")[1]||null,a=i.icon.split(" ")[2]||"";if(s){var l=n.parents()[3]||null,r="pga_server_"+i._id+"_bgcolor",o;o="<style id="+r+" type='text/css'> \n";o+="."+r+" .aciTreeItem {";o+=" border-radius: 3px; margin-bottom: 2px;";o+=" background: "+s+"} \n";if(a){o+="."+r+" .aciTreeText {";o+=" color: "+a+";} \n"}o+="</style>";T("#"+r).remove();T(o).appendTo("head");if(l)T(l).addClass(r)}}},added:function e(t,i,n){var s=n||I,a=s.tree,l=a.parent(t),r=l&&a.itemData(l),o=r&&I.Nodes[r._type];if(o&&o.is_collection){if(!("collection_count"in r)){r.collection_count=0}r.collection_count++;a.setLabel(l,{label:S.escape(r._label)+" <span>("+r.collection_count+")</span>"})}I.Events.trigger("pgadmin:browser:tree:expand-from-previous-tree-state",t);I.Node.callbacks.change_server_background(t,i)},selected:function e(t,i,n){var s=n||I,a=s.tree,l=i||a.itemData(t);D.Browser.enable_disable_menus.apply(s,[t]);if(l&&s){if("properties"in s.panels&&s.panels["properties"]&&s.panels["properties"].panel&&s.panels["properties"].panel.isVisible()){this.showProperties(t,l,s.panels["properties"].panel)}}I.Events.trigger("pgadmin:browser:tree:update-tree-state",t);return true},removed:function e(t){var i=this,n=I.tree,s=n.parent(t),a=s&&n.itemData(s),l=a&&I.Nodes[a._type];if(l&&l.is_collection&&"collection_count"in a){a.collection_count--;n.setLabel(s,{label:S.escape(a._label)+" <span>("+a.collection_count+")</span>"})}setTimeout(function(){i.clear_cache.apply(i,t)},0)},unloaded:function e(t){var i=this,n=I.tree,s=t&&n.itemData(t);if(i.is_collection&&"collection_count"in s){delete s.collection_count;n.setLabel(t,{label:S.escape(s._label)})}},refresh:function e(t,i){var n=this,s=I.tree,a=i&&s.itemData(i);T(I.panels["properties"].panel).removeData("node-prop");I.Events.trigger("pgadmin:browser:tree:refresh",i||I.tree.selected(),{success:function e(){n.callbacks.selected.apply(n,[i,a,I])}})},opened:function e(t){var i=I.tree,n=I.get_preference("browser","auto_expand_sole_children");I.Events.trigger("pgadmin:browser:tree:update-tree-state",t);if(n&&n.value==true&&i.children(t).length==1){i.open(i.first(t))}},closed:function e(t){I.Events.trigger("pgadmin:browser:tree:remove-from-tree-state",t)}},showProperties:function e(l,r,n,i){var o=this,d=D.Browser.tree,c=n.$container.find(".obj_properties").first(),u=c.data("obj-view"),f=T('<div tabindex="1"></div>').addClass("pg-prop-content col-12");var t=function(e,t){if(n&&n["_type"]!=="node_props")return;switch(e.which){case B.ESCAPE:b();break;case B.ENTER:if(e.target!==t)return;if(u&&u.model&&u.model.sessChanged()){var i=T(e.target).closest(".obj_properties").find(".pg-prop-btn-group").find("button.btn-primary");g.call(this,u,i)}break;case B.F1:m();break;default:break}}.bind(n);setTimeout(function(){n.$container.find(".backform-tab").on("keydown",function(e){t(e,this)})},200);var s=function(e){var t=T("<div></div>").addClass("pg-prop-status-bar").appendTo(c);t.css("visibility","hidden");if(e=="header"){t.appendTo(o.header)}else{t.prependTo(o.footer)}o.statusBar=t;return t}.bind(n),p=function(e,t,i){if(e&&S.isArray(e)&&e.length>0){var n=T('<div class="pg-prop-btn-group"></div>'),s=S.template(['<button tabindex="0" type="<%= type %>" ',"class=\"btn <%=extraClasses.join(' ')%>\"",'<% if (disabled) { %> disabled="disabled"<% } %> title="<%-tooltip%>">','<span class="<%= icon %>"></span><% if (label != "") { %>&nbsp;<%-label%><% } %></button>'].join(" "));if(t=="header"){n.appendTo(o.header)}else{n.appendTo(o.footer)}if(i){n.addClass(i)}S.each(e,function(e){if(!e.icon){e.icon=""}var t=T(s(e));n.append(t);e.register(t)});return n}return null}.bind(n),a=function(){var e=this,t=d.selected(),i=t&&d.itemData(t),n=t&&i&&I.Nodes[i._type],s=n.getTreeNodeHierarchy(t);if(S.isEqual(T(e).data("node-prop"),s)){return}T(e).data("node-prop",s);if(!f.hasClass("has-pg-prop-btn-group"))f.addClass("has-pg-prop-btn-group");if(u){u.remove({data:true,internal:true,silent:true});u=null;c.data("obj-view",null)}c.empty();o.header=T("<div></div>").addClass("pg-prop-header").appendTo(c);o.footer=T("<div></div>").addClass("pg-prop-footer").appendTo(c);u=o.getView(l,"properties",f,r,"fieldset",undefined,c);if(u){c.data("obj-view",u);var a=[];a.push({label:E("Edit"),type:"edit",tooltip:E("Edit"),extraClasses:["btn","btn-primary","pull-right","m-1"],icon:"fa fa-sm fa-pencil",disabled:!o.canEdit,register:function e(t){t.on("click",function(){k()})}});a.push({label:"",type:"help",tooltip:E("SQL help for this object type."),extraClasses:["btn-secondary","btn-secondary","m-1"],icon:"fa fa-lg fa-info",disabled:o.sqlAlterHelp==""&&o.sqlCreateHelp==""?true:false,register:function e(t){t.on("click",function(){h()})}});p(a,"header","pg-prop-btn-group-above")}c.append(f)}.bind(n),h=function(){var e=o.getTreeNodeHierarchy(l).server;var t=I.utils.pg_help_path;if(e.server_type=="ppas"){t=I.utils.edbas_help_path}var i="";if(o.sqlCreateHelp==""&&o.sqlAlterHelp!=""){i=A.getHelpUrl(t,o.sqlAlterHelp,e.version)}else if(o.sqlCreateHelp!=""&&o.sqlAlterHelp==""){i=A.getHelpUrl(t,o.sqlCreateHelp,e.version)}else{if(u.model.isNew()){i=A.getHelpUrl(t,o.sqlCreateHelp,e.version)}else{i=A.getHelpUrl(t,o.sqlAlterHelp,e.version)}}window.open(i,"postgres_help")}.bind(n),m=function(){window.open(o.dialogHelp,"pgadmin_help")}.bind(n),g=function(e,n){var t=e.model,i=t.toJSON(true),l=setTimeout(function(){T(".obj_properties").addClass("show_progress")},1e3);if(n)T(n).prop("disabled",true);if(i&&!S.isEmpty(i)){t.save({},{attrs:i,validate:false,cache:false,wait:true,success:function e(){x.call();T(".obj_properties").removeClass("show_progress");clearTimeout(l);var t=I.docker.findPanels("properties")[0],i=I.docker.findPanels("sql")[0],n=I.docker.findPanels("statistics")[0],s=I.docker.findPanels("dependencies")[0],a=I.docker.findPanels("dependents")[0];if(t)T(t).removeData("node-prop");if(i)T(i).removeData("node-prop");if(n)T(n).removeData("node-prop");if(s)T(s).removeData("node-prop");if(a)T(a).removeData("node-prop")},error:function e(t,i){M.pgNotifier("error",i,E("Error saving properties"));T(".obj_properties").removeClass("show_progress");clearTimeout(l);if(n)T(n).prop("disabled",false)}})}}.bind(n),v=function(){var n=this;if(i&&i=="properties"){i="edit"}n.$container.attr("action-mode",i);if(u){u.remove({data:true,internal:true,silent:true});u=null;c.data("obj-view",null)}c.empty();o.header=T("<div></div>").addClass("pg-prop-header").appendTo(c);o.footer=T("<div></div>").addClass("pg-prop-footer").appendTo(c);var e=function e(t,i){var n=this.find(".pg-prop-btn-group"),s=n.find("button.btn-primary"),a=n.find('button.btn-secondary[type="reset"]');if(t||!i){s.prop("disabled",true);s.attr("disabled","disabled")}else{s.prop("disabled",false);s.removeAttr("disabled")}if(!i){a.prop("disabled",true);a.attr("disabled","disabled")}else{a.prop("disabled",false);a.removeAttr("disabled")}};u=o.getView(l,i,f,r,"dialog",e,c,w);if(u){c.data("obj-view",u);n.icon(S.isFunction(o["node_image"])?o["node_image"].apply(o,[r,u.model]):o["node_image"]||"icon-"+o.type);var t=p([{label:"",type:"help",tooltip:E("SQL help for this object type."),extraClasses:["btn-secondary","pull-left","mx-1"],icon:"fa fa-lg fa-info",disabled:o.sqlAlterHelp==""&&o.sqlCreateHelp==""?true:false,register:function e(t){t.on("click",function(){h()})}},{label:"",type:"help",tooltip:E("Help for this dialog."),extraClasses:["btn-secondary","pull-left","mx-1"],icon:"fa fa-lg fa-question",disabled:o.dialogHelp==""?true:false,register:function e(t){t.on("click",function(){m()})}},{label:E("Cancel"),type:"cancel",tooltip:E("Cancel changes to this object."),extraClasses:["btn-secondary","mx-1"],icon:"fa fa-close pg-alertify-button",disabled:false,register:function e(t){var i=arguments;t.on("click",function(){n.$container.removeAttr("action-mode");w.call(i)})}},{label:E("Reset"),type:"reset",tooltip:E("Reset the fields on this dialog."),extraClasses:["btn-secondary","mx-1"],icon:"fa fa-recycle pg-alertify-button",disabled:true,register:function e(t){t.on("click",function(){setTimeout(function(){v.call()},0)})}},{label:E("Save"),type:"save",tooltip:E("Save this object."),extraClasses:["btn-primary","mx-1"],icon:"fa fa-save pg-alertify-button",disabled:true,register:function e(t){var i=this;t.on("click",function(){g.call(i,u,t)})}}],"footer","pg-prop-btn-group-below");t.on("keydown","button",function(e){if(e.keyCode==9&&T(this).nextAll("button:not([disabled])").length==0){$.findAndSetFocus(u.$el.find(".tab-content div.active"));return false}});setTimeout(function(){I.keyboardNavigation.getDialogTabNavigator(n.pgElContainer)},200)}s("footer");f.addClass("pg-prop-has-btn-group-below");c.prepend(f)}.bind(n),b=function(){this.close()}.bind(n),y=function e(t){var i=r,n=S.clone(u.model.tnode),s=S.clone(u.model.node_info);setTimeout(function(){t.clear_cache.apply(t,l)},0);I.Events.trigger("pgadmin:browser:tree:update",i,n,s,{success:function e(t,i,n){I.Events.trigger("pgadmin:browser:node:updated",t,i,n);I.Events.trigger("pgadmin:browser:node:"+i._type+":updated",t,i,n)}});b()},C=function(e){var t=this,i=t.$container.find(".obj_properties").first(),n=i.data("obj-view");setTimeout(function(){e.clear_cache.apply(e,l)},0);try{I.Events.trigger("pgadmin:browser:tree:add",S.clone(n.model.tnode),S.clone(n.model.node_info))}catch(e){console.warn(e.stack||e)}b()}.bind(n,o),_=function e(){setTimeout(function(){o.callbacks.show_obj_properties.apply(o,[{action:"edit",item:l}])},0)},w=b,x=y.bind(n,o),k=v.bind(n);if(i){if(i=="create"){w=b;x=C}if(i!="properties"){v()}else{a()}}else{a();k=_.bind(n)}if(n.closeable()){var N=function(){var e=this.$container.find(".obj_properties").first(),t=e&&e.data("obj-view");if(t){t.remove({data:true,internal:true,silent:true})}}.bind(n);n.on(O.EVENT.CLOSED,N)}},_find_parent_node:function e(t,i,n){if(this.parent_type){n=n||t.itemData(i);if(S.isString(this.parent_type)){if(this.parent_type==n._type){return i}while(t.hasParent(i)){i=t.parent(i);n=t.itemData(i);if(this.parent_type==n._type)return i}}else{if(S.indexOf(this.parent_type,n._type)>=0){return i}while(t.hasParent(i)){i=t.parent(i);n=t.itemData(i);if(S.indexOf(this.parent_type,n._type)>=0)return i}}}return null},generate_url:function e(t,i,n,s,a){var l={create:"obj",drop:"obj",edit:"obj",properties:"obj",statistics:"stats"},r=this,o=-Infinity;var d=S.isUndefined(t)||S.isNull(t)?a||{}:this.getTreeNodeHierarchy(t);var c=i in l?l[i]:i;var u=s&&n._type==r.type?encodeURIComponent(n._id):"";if(r.parent_type){if(S.isString(r.parent_type)){var f=d[r.parent_type];if(f){o=f.priority}}else{S.each(r.parent_type,function(e){var t=d[e];if(t){if(o<t.priority){o=t.priority}}})}}var p=function e(t){return t.priority<=o};return h.generate_url(I.URL,d,c,r.type,p,u)},Collection:I.DataCollection,Model:I.DataModel,getTreeNodeHierarchy:e.getTreeNodeHierarchyFromIdentifier.bind(I),cache:function e(t,i,n,s){var a=this.cached=this.cached||{},l=t,r=i&&i[n]&&i[n].priority||0;if(i){S.each(S.sortBy(S.values(S.pick(i,function(e){return e.priority<=r})),function(e){return e.priority}),function(e){l=x("%s/%s").sprintf(l,encodeURI(e._id)).value()})}if(S.isUndefined(s)){var o=a[l];if(!S.isUndefined(o)&&o.at-Date.now()>3e5){o=undefined}return o}o=a[l]={data:s,at:Date.now(),level:n};return o},clear_cache:function e(t){this.cached={};var i=this;I.Events.trigger("pgadmin:browser:node:"+i.type+":cache_cleared",t,i)},cache_level:function e(t,i){if(t){if(i&&this.type in t){return this.type}if(S.isArray(this.parent_type)){for(var n in this.parent_type){if(n in t){return n}}return this.type}return this.parent_type}}});return D.Browser.Node}.apply(t,n),s!==undefined&&(e.exports=s))},292:function(e,t,i){"use strict";var n,s;!(n=[i(1),i(3),i(0),i(21)],s=function(l,n,r){var s=n.Browser=n.Browser||{},o=window.wcDocker;n.Browser.Panel=function(e){var t=["name","title","width","height","showTitle","isCloseable","isPrivate","isLayoutMember","content","icon","events","onCreate","elContainer","canHide","limit","extraClasses"];l.extend(this,l.pick(e,t))};l.extend(n.Browser.Panel.prototype,{name:"",title:"",width:300,height:600,showTitle:true,isCloseable:true,isPrivate:false,isLayoutMember:true,content:"",icon:"",panel:null,onCreate:null,elContainer:false,limit:null,extraClasses:null,load:function e(t,s){var a=this;if(!a.panel){t.registerPanelType(a.name,{title:a.title,isPrivate:a.isPrivate,limit:a.limit,isLayoutMember:a.isLayoutMember,onCreate:function e(i){r(i).data("pgAdminName",a.name);i.initSize(a.width,a.height);if(!a.showTitle)i.title(false);else{var t='<a href="#" tabindex="-1" class="panel-link-heading">'+(s||a.title)+"</a>";i.title(t);if(a.icon!="")i.icon(a.icon)}var n=r("<div>",{class:"pg-panel-content"}).append(r(a.content));if(!l.isNull("extraClasses")){n.addClass(a.extraClasses)}i.closeable(!!a.isCloseable);i.layout().addItem(n);a.panel=i;if(a.events&&l.isObject(a.events)){l.each(a.events,function(e,t){if(e&&l.isFunction(e)){i.on(t,e)}})}l.each([o.EVENT.UPDATED,o.EVENT.VISIBILITY_CHANGED,o.EVENT.BEGIN_DOCK,o.EVENT.END_DOCK,o.EVENT.GAIN_FOCUS,o.EVENT.LOST_FOCUS,o.EVENT.CLOSED,o.EVENT.BUTTON,o.EVENT.ATTACHED,o.EVENT.DETACHED,o.EVENT.MOVE_STARTED,o.EVENT.MOVE_ENDED,o.EVENT.MOVED,o.EVENT.RESIZE_STARTED,o.EVENT.RESIZE_ENDED,o.EVENT.RESIZED,o.EVENT.SCROLLED],function(e){i.on(e,a.eventFunc.bind(i,e))});if(a.onCreate&&l.isFunction(a.onCreate)){a.onCreate.apply(a,[i,n])}if(a.elContainer){i.pgElContainer=n;n.addClass("pg-el-container");l.each([o.EVENT.RESIZED,o.EVENT.ATTACHED,o.EVENT.DETACHED,o.EVENT.VISIBILITY_CHANGED],function(e){i.on(e,a.resizedContainer.bind(i))});a.resizedContainer.apply(i)}if(a.canHide){l.each([o.EVENT.CLOSED,o.EVENT.VISIBILITY_CHANGED],function(e){i.on(e,a.handleVisibility.bind(i,e))})}}})}},eventFunc:function e(t){var i=r(this).data("pgAdminName");try{s.Events.trigger("pgadmin-browser:panel",t,this,arguments);s.Events.trigger("pgadmin-browser:panel:"+t,this,arguments);if(i){s.Events.trigger("pgadmin-browser:panel-"+i,t,this,arguments);s.Events.trigger("pgadmin-browser:panel-"+i+":"+t,this,arguments)}}catch(e){console.warn(e.stack||e)}},resizedContainer:function e(){var i=this;if(i.pgElContainer&&!i.pgResizeTimeout){if(!i.isVisible()){clearTimeout(i.pgResizeTimeout);i.pgResizeTimeout=null;return}i.pgResizeTimeout=setTimeout(function(){var e=i.width(),t="xs";i.pgResizeTimeout=null;if(e<480){t="xs"}if(e>=480){t="sm"}if(e>=768){t="md"}if(e>=992){t="lg"}if(e>=1200){t="xl"}i.pgElContainer.attr("el",t)},100)}},handleVisibility:function e(t){if(this._type!="dashboard"||l.isUndefined(n.Dashboard))return;if(t=="panelClosed"){n.Dashboard.toggleVisibility(false,true)}else if(t=="panelVisibilityChanged"){if(s.tree){var i=s.tree.selected();if(!l.isUndefined(n.Dashboard)){n.Dashboard.toggleVisibility(s.panels.dashboard.panel.isVisible())}if(i.length){s.Events.trigger("pgadmin-browser:tree:selected",i,s.tree.itemData(i),s.Node)}}}}});return n.Browser.Panel}.apply(t,n),s!==undefined&&(e.exports=s))},293:function(e,t,i){"use strict";var n,s;!(n=[i(2),i(1),i(18),i(3)],s=function(a,l,r,e){e.Browser=e.Browser||{};l.extend(e.Browser,{report_error:function e(t,i,n){t=l.escape(t);i=l.escape(i);n=l.escape(n);var s='<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">           <div class="panel panel-default">           <div class="panel-heading" role="tab" id="headingOne">           <h4 class="panel-title">           <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">           '+a("Error message")+'</a>        </h4>        </div>        <div id="collapseOne" class="panel-collapse collapse show" role="tabpanel" aria-labelledby="headingOne">        <div class="panel-body" style="overflow: auto;">'+i+"</div>        </div>        </div>";if(n!=null&&n!=""){s+='<div class="panel panel-default">            <div class="panel-heading" role="tab" id="headingTwo">            <h4 class="panel-title">            <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">            '+a("Additional info")+'</a>          </h4>          </div>          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">          <div class="panel-body" style="overflow: auto;">'+n+"</div>          </div>          </div>          </div>"}s+="</div>";r.alert(t,s).set("closable",true)}});return e.Browser.report_error}.apply(t,n),s!==undefined&&(e.exports=s))},294:function(e,t,i){"use strict";var n,s;function f(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){f=function e(t){return typeof t}}else{f=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return f(e)}!(n=[i(1),i(8),i(3),i(0),i(9)],s=function(c,l,r,e,u){var o=r.Browser=r.Browser||{};o.DataModel=u.Model.extend({on_server:false,parse:function e(s){var a=this;if(s&&c.isObject(s)&&"node"in s&&s["node"]){a.tnode=c.extend({},s.node);delete s.node}var t=function n(e){if(e&&c.isArray(e)){c.each(e,function(e){var t,i;switch(e.type){case"collection":t=a.get(e.id);i=s[e.id];if(c.isArray(i)||c.isObject(i)){if(!t||!(t instanceof u.Collection)){t=new o.Node.Collection(i,{model:c.isString(e.model)&&e.model in o.Nodes?o.Nodes[e.model].model:e.model,top:a.top||a,handler:a,parse:true,silent:true,attrName:e.id});a.set(e.id,t,{silent:true,parse:true,on_server:true})}else{t.reset(i,{silent:true,parse:true,on_server:true})}}else{t=null}a.set(e.id,t,{silent:true});s[e.id]=t;break;case"model":t=a.get(e.id);i=s[e.id];if(!c.isUndefined(i)&&!c.isNull(i)){if(!t||!(t instanceof u.Model)){if(c.isString(e.model)&&e.model in o.Nodes[e.model]){t=new o.Nodes[e.model].Model(t,{silent:true,top:a.top||a,handler:a,attrName:e.id})}else{t=new e.model(t,{silent:true,top:a.top||a,handler:a,attrName:e.id})}}t.set(i,{parse:true,silent:true})}else{t=null}s[e.id]=t;break;case"nested":n(e.schema);break;default:break}})}};t(a.schema);return s},isNew:function e(){if(this.has(this.idAttribute)){return!this.has(this.idAttribute)}return!this.on_server},primary_key:function e(){if(this.keys&&c.isArray(this.keys)){var t={},i=this;c.each(i.keys,function(e){t[e]=i.attributes[e]});return JSON.stringify(t)}return this.cid},initialize:function e(t,i){var n=this;n._previous_key_values={};if(!c.isUndefined(i)&&"on_server"in i&&i.on_server){n.on_server=true}u.Model.prototype.initialize.apply(n,arguments);if(c.isUndefined(i)||c.isNull(i)){i=t||{};t=null}n.sessAttrs={};n.fieldData={};n.origSessAttrs={};n.objects=[];n.arrays=[];n.attrName=i.attrName,n.top=i.top||n.collection&&n.collection.top||n.collection||n;n.handler=i.handler||n.collection&&n.collection.handler;n.trackChanges=false;n.errorModel=new u.Model;n.node_info=i.node_info;var s;var a=function i(e){if(e&&c.isArray(e)){c.each(e,function(e){switch(e.type){case"int":case"numeric":n.fieldData[e.id]={id:e.id,label:e.label,type:e.type,min:!c.isUndefined(e.min)?e.min:undefined,max:!c.isUndefined(e.max)?e.max:undefined};break;default:n.fieldData[e.id]={id:e.id,label:e.label,type:e.type}}switch(e.type){case"array":n.arrays.push(e.id);break;case"collection":s=n.get(e.id);if(!s||!(s instanceof o.Node.Collection)){if(c.isString(e.model)&&e.model in o.Nodes){var t=o.Nodes[e.model];s=new t.Collection(s,{model:t.model,top:n.top||n,handler:n,attrName:e.id})}else{s=new o.Node.Collection(s,{model:e.model,top:n.top||n,handler:n,attrName:e.id})}}s.name=e.id;n.objects.push(e.id);n.set(e.id,s,{silent:true});break;case"model":s=n.get(e.id);if(!s||!(s instanceof u.Model)){if(c.isString(e.model)&&e.model in o.Nodes[e.model]){s=new o.Nodes[e.model].Model(s,{top:n.top||n,handler:n,attrName:e.id})}else{s=new e.model(s,{top:n.top||n,handler:n,attrName:e.id})}}s.name=e.id;n.objects.push(e.id);n.set(e.id,s,{silent:true});break;case"nested":i(e.schema);break;default:return}})}};a(n.schema);if(n.handler&&n.handler.trackChanges){n.startNewSession()}if("keys"in n&&c.isArray(n.keys)){c.each(n.keys,function(t){n.on("change:"+t,function(e){n._previous_key_values[t]=e.previous(t)})})}return n},reset:function e(t){var i;if(t&&t.stop)this.stopSession();for(var n in this.objects){i=this.get(n);if(i){if(i instanceof o.DataModel){i.reset(t)}else if(i instanceof u.Model){i.clear(t)}else if(i instanceof o.DataCollection){i.reset(t)}else if(i instanceof u.Collection){i.each(function(e){if(e instanceof u.DataModel){i.reset();i.clear(t)}});if(!(t instanceof Array)){t=[t]}u.Collection.prototype.reset.apply(i,t)}}}this.clear(t)},sessChanged:function e(){var i=this;return c.size(i.sessAttrs)>0||c.some(i.objects,function(e){var t=i.get(e);if(!(c.isNull(t)||c.isUndefined(t))){return t.sessChanged()}return false})},sessValid:function e(){var t=this;if("default_validate"in t&&typeof t.default_validate=="function"&&c.isString(t.default_validate())){return false}if("validate"in t&&c.isFunction(t.validate)&&c.isString(t.validate.apply(t))){return false}return true},set:function e(t,i,n){var s=c.isObject(t)?i:n;this._changing=true;this._previousAttributes=c.clone(this.attributes);this.changed={};var a=u.Model.prototype.set.call(this,t,i,n);this._changing=false;if(s&&s.internal||!this.trackChanges){return true}if(t!=null&&a){var l={},r=this,o;var d=function e(t,i){if(i in r.objects){return}l[i]=t;if(c.isEqual(r.origSessAttrs[i],t)){delete r.sessAttrs[i]}else{r.sessAttrs[i]=t}};if(f(t)==="object"){c.each(t,d)}else{d(i,t)}r.trigger("pgadmin-session:set",r,l);if(!n||!n.silent){r.trigger("change",r,n)}if("default_validate"in r&&typeof r.default_validate=="function"){o=r.default_validate()}if("validate"in r&&typeof r["validate"]==="function"){if(!o){o=r.validate(c.keys(l))}}if(c.size(r.errorModel.attributes)==0){if(r.collection||r.handler){(r.collection||r.handler).trigger("pgadmin-session:model:valid",r,r.collection||r.handler)}else{r.trigger("pgadmin-session:valid",r.sessChanged(),r)}}else{o=o||c.values(r.errorModel.attributes)[0];if(r.collection||r.handler){(r.collection||r.handler).trigger("pgadmin-session:model:invalid",o,r,r.collection||r.handler)}else{r.trigger("pgadmin-session:invalid",o,r)}}return a}return a},toJSON:function e(i,n){var s=this,a,l=s.isNew();i=typeof i!="undefined"&&i==true;if(!i||l){a=u.Model.prototype.toJSON.call(this,arguments)}else{a={};a[s.idAttribute||"_id"]=s.get(s.idAttribute||"_id");a=c.extend(a,s.sessAttrs)}c.each(s.objects,function(e){var t=s.get(e);if(i){if(a[e]instanceof Array){a[e]=JSON.stringify(a[e])}else if(t&&t.sessChanged&&t.sessChanged()||l){a[e]=t&&t.toJSON(!l);if(t&&n&&n=="GET"){a[e]=JSON.stringify(a[e])}}else{delete a[e]}}else if(!(a[e]instanceof Array)){a[e]=t&&t.toJSON()}});if(i){c.each(s.arrays,function(e){if(a[e]&&a[e]instanceof Array){a[e]=JSON.stringify(a[e])}})}return a},startNewSession:function e(){var i=this;if(i.trackChanges){i.trigger("pgadmin-session:stop",i);i.off("pgadmin-session:model:invalid",i.onChildInvalid);i.off("pgadmin-session:model:valid",i.onChildValid);i.off("pgadmin-session:changed",i.onChildChanged);i.off("pgadmin-session:added",i.onChildChanged);i.off("pgadmin-session:removed",i.onChildChanged)}i.trackChanges=true;i.sessAttrs={};i.origSessAttrs=c.clone(i.attributes);c.each(i.objects,function(e){var t=i.get(e);if(c.isUndefined(t)||c.isNull(t)){return}delete i.origSessAttrs[e];if(t&&"startNewSession"in t&&c.isFunction(t.startNewSession)){t.startNewSession()}});i.trigger("pgadmin-session:start",i);i.on("pgadmin-session:model:invalid",i.onChildInvalid);i.on("pgadmin-session:model:valid",i.onChildValid);i.on("pgadmin-session:changed",i.onChildChanged);i.on("pgadmin-session:added",i.onChildChanged);i.on("pgadmin-session:removed",i.onChildChanged)},onChildInvalid:function e(t,i){var n=this;if(n.trackChanges&&i){var s=i.attrName;if(!s){var a=i.primary_key&&typeof i.primary_key==="function";var l=a?i.primary_key():i.cid,r=a?function(e){var t=n.get("k");if(t&&t.primary_key()===l){s=e;return true}return false}:function(e){var t=n.get(e);if(t.cid===l){s=e;return true}return false};c.findIndex(n.objects,r)}if(s){n.errorModel.set(s,t);if(n.handler){n.handler.trigger("pgadmin-session:model:invalid",t,n,n.handler)}else{n.trigger("pgadmin-session:invalid",t,n)}}}return this},onChildValid:function e(t){var i=this;if(i.trackChanges&&t){var n=t.attrName;if(!n){var s=t.primary_key&&typeof t.primary_key==="function";var a=s?t.primary_key():t.cid,l=s?function(e){var t=i.get("k");if(t&&t.primary_key()===a){n=e;return true}return false}:function(e){var t=i.get("k");if(t&&t.cid===a){n=e;return true}return false};c.findIndex(i.objects,l)}var r=null,o=function e(t,i){if("default_validate"in t&&typeof t.default_validate=="function"){r=t.default_validate();if(c.isString(r)){return r}}if("validate"in t&&typeof t.validate=="function"){r=t.validate(i);return r}return null};if(t instanceof u.Collection){for(var d in t.models){if(o(t.models[d]))break}}else if(t instanceof u.Model){o(t)}if(n&&i.errorModel.has(n)){if(!r){i.errorModel.unset(n)}else{i.errorModel.set(n,r)}}if(c.size(i.errorModel.attributes)==0&&!o(i,n&&[n])){if(i.handler){i.handler.trigger("pgadmin-session:model:valid",i,i.handler)}else{i.trigger("pgadmin-session:valid",i.sessChanged(),i)}}else{r=r||c.values(i.errorModel.attributes)[0];if(i.handler){i.handler.trigger("pgadmin-session:model:invalid",r,i,i.handler)}else{i.trigger("pgadmin-session:invalid",r,i)}}}},onChildChanged:function e(){var t=this;if(t.trackChanges&&t.collection){t.collection.trigger("change",t)}},stopSession:function e(){var i=this;if(i.trackChanges){i.off("pgadmin-session:model:invalid",i.onChildInvalid);i.off("pgadmin-session:model:valid",i.onChildValid);i.off("pgadmin-session:changed",i.onChildChanged);i.off("pgadmin-session:added",i.onChildChanged);i.off("pgadmin-session:removed",i.onChildChanged)}i.trackChanges=false;i.sessAttrs={};i.origSessAttrs={};c.each(i.objects,function(e){var t=i.get(e);if(c.isUndefined(t)||c.isNull(t)){return}i.origSessAttrs[e]=null;delete i.origSessAttrs[e];if(t&&"stopSession"in t&&c.isFunction(t.stopSession)){t.stopSession()}});i.trigger("pgadmin-session:stop")},default_validate:function e(){var t,i,n,s;for(var a=0,l=c.keys(this.attributes),r=l.length;a<r;a++){n=this.attributes[l[a]];i=this.fieldData[l[a]];t=null;if(!(c.isUndefined(n)||c.isNull(n)||String(n).replace(/^\s+|\s+$/g,"")=="")){if(!i){continue}s=i.type||undefined;if(!s){continue}switch(s){case"int":t=this.integer_validate(n,i);break;case"numeric":t=this.number_validate(n,i);break}if(t){this.errorModel.set(i.id,t);return t}else{this.errorModel.unset(i.id)}}else{if(i){this.errorModel.unset(i.id)}}}return null},check_min_max:function e(t,i){var n=i.label,s=i.min,a=i.max;if(!c.isUndefined(s)&&t<s){return l(r.Browser.messages.MUST_GR_EQ).sprintf(n,s).value()}else if(!c.isUndefined(a)&&t>a){return l(r.Browser.messages.MUST_LESS_EQ).sprintf(n,a).value()}return null},number_validate:function e(t,i){var n=new RegExp("^-?[0-9]+(.?[0-9]*)?$");if(!n.test(t)){return l(r.Browser.messages.MUST_BE_NUM).sprintf(i.label).value()}return this.check_min_max(t,i)},integer_validate:function e(t,i){var n=new RegExp("^-?[0-9]*$");if(!n.test(t)){return l(r.Browser.messages.MUST_BE_INT).sprintf(i.label).value()}return this.check_min_max(t,i)}});o.DataCollection=u.Collection.extend({initialize:function e(t,i){var n=this;i=i||{};n.sessAttrs={changed:[],added:[],deleted:[],invalid:[]};n.top=i.top||n;n.attrName=i.attrName;n.handler=i.handler;n.trackChanges=false;n.on("add",n.onModelAdd);n.on("remove",n.onModelRemove);n.on("change",n.onModelChange);if(n.handler&&n.handler.trackChanges){n.startNewSession()}return n},startNewSession:function e(){var t=this,i;if(t.trackChanges){t.trigger("pgadmin-session:stop",t);t.off("pgadmin-session:model:invalid",t.onModelInvalid);t.off("pgadmin-session:model:valid",t.onModelValid)}t.trackChanges=true;t.sessAttrs={changed:[],added:[],deleted:[],invalid:[]};c.each(t.models,function(e){if("startNewSession"in e&&c.isFunction(e.startNewSession)){e.startNewSession()}if("default_validate"in e&&typeof e.default_validate=="function"){i=e.default_validate()}if(c.isString(i)){t.sessAttrs["invalid"][e.cid]=i}else if("validate"in e&&typeof e.validate==="function"){i=e.validate();if(i){t.sessAttrs["invalid"][e.cid]=i}}});t.trigger("pgadmin-session:start",t);t.on("pgadmin-session:model:invalid",t.onModelInvalid);t.on("pgadmin-session:model:valid",t.onModelValid)},onModelInvalid:function e(t,i){var n=this,s=n.sessAttrs["invalid"];if(n.trackChanges){s[i.cid]=t;if(n.handler){n.handler.trigger("pgadmin-session:model:invalid",t,n,n.handler)}else{n.trigger("pgadmin-session:invalid",t,n)}}return true},onModelValid:function e(t){var i=this,n=i.sessAttrs["invalid"];if(i.trackChanges){var s=i.checkDuplicateWithModel(t);if(s&&t.cid in n){delete n[t.cid]}if(s){this.triggerValidationEvent.apply(this)}}return true},stopSession:function e(){var t=this;t.trackChanges=false;t.sessAttrs={changed:[],added:[],deleted:[],invalid:[]};c.each(t.models,function(e){if("stopSession"in e&&c.isFunction(e.stopSession)){e.stopSession()}})},sessChanged:function e(){return this.sessAttrs["changed"].length>0||this.sessAttrs["added"].length>0||this.sessAttrs["deleted"].length>0},toJSON:function e(t){var i=this;t=typeof t!="undefined"&&t==true;if(!t){return u.Collection.prototype.toJSON.call(i)}else{var n={};n["added"]=[];c.each(this.sessAttrs["added"],function(e){n["added"].push(e.toJSON())});if(n["added"].length==0){delete n["added"]}n["changed"]=[];c.each(i.sessAttrs["changed"],function(e){n["changed"].push(e.toJSON(true))});if(n["changed"].length==0){delete n["changed"]}n["deleted"]=[];c.each(i.sessAttrs["deleted"],function(e){n["deleted"].push(e.toJSON())});if(n["deleted"].length==0){delete n["deleted"]}return c.size(n)==0?null:n}},reset:function e(t){if(t&&t.stop)this.stopSession();this.each(function(e){if(!e)return;if(e instanceof o.DataModel){e.reset(t)}else{e.clear(t)}});u.Collection.prototype.reset.apply(this,arguments)},objFindInSession:function e(t,i){var n=t.primary_key&&typeof t.primary_key=="function",s=n?t.primary_key():t.cid,a=n?function(e){return e.primary_key()===s}:function(e){return e.cid===s};return c.findIndex(this.sessAttrs[i],a)},onModelAdd:function e(t){if(!this.trackChanges)return true;var i=this,n,s=i.objFindInSession(t,"deleted");if(s>=0){var a=i.sessAttrs["deleted"][s];t.origSessAttrs=c.clone(a.origSessAttrs);t.attributes=c.extend(t.attributes,a.attributes);t.sessAttrs=c.clone(a.sessAttrs);i.sessAttrs["deleted"].splice(s,1);if(!("sessChanged"in t)||t.sessChanged()){i.sessAttrs["changed"].push(t)}(i.handler||i).trigger("pgadmin-session:added",i,t);if("default_validate"in t&&typeof t.default_validate=="function"){n=t.default_validate()}if(c.isString(n)){i.sessAttrs["invalid"][t.cid]=n}else if("validate"in t&&typeof t.validate==="function"){n=t.validate();if(n){i.sessAttrs["invalid"][t.cid]=n}}}else{if("default_validate"in t&&typeof t.default_validate=="function"){n=t.default_validate()}if(c.isString(n)){i.sessAttrs["invalid"][t.cid]=n}else if("validate"in t&&typeof t.validate==="function"){n=t.validate();if(n){i.sessAttrs["invalid"][t.cid]=n}}i.sessAttrs["added"].push(t);(i.handler||i).trigger("pgadmin-session:added",i,t)}this.triggerValidationEvent.apply(this);return true},onModelRemove:function e(t){if(!this.trackChanges)return true;t.errorModel.clear();var i=this,n=i.sessAttrs["invalid"],s=c.clone(t),a=i.objFindInSession(t,"added");if(t.cid in n){delete n[t.cid]}if(a>=0){i.sessAttrs["added"].splice(a,1);(i.handler||i).trigger("pgadmin-session:removed",i,s);i.checkDuplicateWithModel(s);this.triggerValidationEvent.apply(this);return true}a=i.objFindInSession(t,"changed");if(a>=0){i.sessAttrs["changed"].splice(a,1);(i.handler||i).trigger("pgadmin-session:removed",i,s)}else{(i.handler||i).trigger("pgadmin-session:removed",i,s)}i.sessAttrs["deleted"].push(t);i.checkDuplicateWithModel(t);this.triggerValidationEvent.apply(this);return true},triggerValidationEvent:function e(){var t=this,i=null,n=t.sessAttrs["invalid"],s=[];for(var a in n){i=n[a];if(i){break}else{s.push(a)}}for(a in s){delete n[s[a]]}if(!i){if(t.handler){t.handler.trigger("pgadmin-session:model:valid",t,t.handler)}else{t.trigger("pgadmin-session:valid",t.sessChanged(),t)}}else{if(t.handler){t.handler.trigger("pgadmin-session:model:invalid",i,t,t.handler)}else{t.trigger("pgadmin-session:invalid",i,t)}}},onModelChange:function e(t){var i=this;if(!this.trackChanges||!(t instanceof o.Node.Model))return true;var n=i.objFindInSession(t,"added");if(n>=0){(i.handler||i).trigger("pgadmin-session:changed",i,t);return true}n=i.objFindInSession(t,"changed");if(!("sessChanged"in t)){(i.handler||i).trigger("pgadmin-session:changed",i,t);if(n>=0){return true}i.sessAttrs["changed"].push(t);return true}if(n>=0){if(!t.sessChanged()){i.sessAttrs["changed"].splice(n,1);(i.handler||i).trigger("pgadmin-session:changed",i,t);return true}(i.handler||i).trigger("pgadmin-session:changed",i,t);return true}if(t.sessChanged()){i.sessAttrs["changed"].push(t);(i.handler||i).trigger("pgadmin-session:changed",i,t)}return true},checkDuplicateWithModel:function e(t){if(!("keys"in t)||c.isEmpty(t.keys)){return true}var i=this,n={},s={};c.each(t.keys,function(e){n[e]=t.get(e);if(e in t._previous_key_values){s[e]=t._previous_key_values[e]}else{s[e]=t.previous(e)}});t._previous_key_values={};var a=i.where(s);if(a.length==1){var l=a[0];i.clearInvalidSessionIfModelValid(l)}var r=i.where(n);if(r.length==0){i.clearInvalidSessionIfModelValid(t)}else if(r.length==1){i.clearInvalidSessionIfModelValid(t);i.clearInvalidSessionIfModelValid(r[0])}else{var o="Duplicate rows.";setTimeout(function(){c.each(r,function(e){i.trigger("pgadmin-session:model:invalid",o,e,i.handler);e.trigger("pgadmin-session:model:duplicate",e,o)})},10);return false}return true},clearInvalidSessionIfModelValid:function e(t){var i=t.errorModel.attributes,n=this.sessAttrs["invalid"];t.trigger("pgadmin-session:model:unique",t);if(c.size(i)==0){delete n[t.cid]}else{n[t.cid]=i[Object.keys(i)[0]]}}});o.Events=c.extend({},u.Events);return o}.apply(t,n),s!==undefined&&(e.exports=s))},35:function(e,t,i){"use strict";var n,s;!(n=[i(2),i(0),i(1),i(3),i(9),i(22),i(18),i(19),i(68),i(27)],s=function(r,g,v,b,e,f,t,y){g.fn.select2.amd.define("select2/selectAllAdapter",["select2/utils","select2/dropdown","select2/dropdown/attachBody"],function(l,e,t){function i(){}i.prototype.render=function(e){var t=this;var i=e.call(this);var n=g(['<button class="btn btn-secondary btn-sm" type="button"',' style="width: 49%;margin: 0 0.5%;">','<i class="fa fa-check-square-o"></i>','<span style="padding: 0px 5px;">',r("Select All"),"</span></button>"].join(""));var s=g(['<button class="btn btn-secondary btn-sm" type="button"',' style="width: 49%;margin: 0 0.5%;">','<i class="fa fa-square-o"></i><span style="padding: 0px 5px;">',r("Unselect All"),"</span></button>"].join(""));var a=g('<div class="select2-select-all-adapter-container">').append(n).append(s);if(!this.$element.prop("multiple")){return i}i.find(".select2-dropdown").prepend(a);n.on("click",function(){i.find(".select2-results__option[aria-selected=false]").each(function(){var e=l.GetData(g(this)[0],"data");t.trigger("select",{data:e})});t.trigger("close")});s.on("click",function(){i.find(".select2-results__option[aria-selected=true]").each(function(){var e=l.GetData(g(this)[0],"data");t.trigger("unselect",{data:e})});t.trigger("close")});return i};return l.Decorate(l.Decorate(e,t),i)});var i=f.NodeAjaxOptionsControl=f.Select2Control.extend({defaults:v.extend(f.Select2Control.prototype.defaults,{url:undefined,transform:undefined,url_with_id:false,select2:{allowClear:true,placeholder:"Select an item...",width:"style"}}),initialize:function e(){f.Select2Control.prototype.initialize.apply(this,arguments);var t=this,i=t.field.get("url")||t.defaults.url,n=t.model.top||t.model;if(i){var s=this.field.get("schema_node"),a=this.field.get("node_info"),l=this.field.get("url_with_id")||false,r=s.generate_url.apply(s,[null,i,this.field.get("node_data"),l,a]),o,d=this.field.get("cache_node");d=d&&b.Browser.Nodes[d]||s;if(this.field.has("cache_level")){o=this.field.get("cache_level")}else{o=d.cache_level(a,l)}var c=d.cache(s.type+"#"+i,a,o);if(this.field.get("version_compatible")&&(v.isUndefined(c)||v.isNull(c))){n.trigger("pgadmin:view:fetching",n,t.field);g.ajax({async:false,url:r}).done(function(e){c=d.cache(s.type+"#"+i,a,o,e.data)}).fail(function(){n.trigger("pgadmin:view:fetch:error",n,t.field)});n.trigger("pgadmin:view:fetched",n,t.field)}c=c&&c.data||[];var u=this.field.get("transform")||t.defaults.transform;if(u&&v.isFunction(u)){t.field.set("options",u.bind(t,c))}else{t.field.set("options",c)}}}});var n=function e(t){if(!t.id){return t.text}var i=g(t.element).data("image");if(!i){return t.text}else{return g("<span></span>").append(g("<span></span>",{class:"wcTabIcon "+i})).append(g("<span></span>").text(t.text))}};var s=f.NodeListByIdControl=i.extend({controlClassName:"pgadmin-node-select form-control",defaults:v.extend({},i.prototype.defaults,{url:"nodes",filter:undefined,transform:function e(t){var n=this,s=n.field.get("schema_node"),a=[],l=n.field.get("filter")||function(){return true};l=l.bind(n);v.each(t,function(e){if(l(e)){var t=v.isFunction(s["node_label"])?s["node_label"].apply(s,[e,n.model,n]):e.label,i=v.isFunction(s["node_image"])?s["node_image"].apply(s,[e,n.model,n]):s["node_image"]||"icon-"+s.type;a.push({value:e._id,image:i,label:t})}});return a},select2:{allowClear:true,placeholder:"Select an item...",width:"style",templateResult:n,templateSelection:n}})});f.NodeListByNameControl=s.extend({defaults:v.extend({},s.prototype.defaults,{transform:function e(t){var n=this,s=n.field.get("schema_node"),a=[],l=n.field.get("filter")||function(){return true};l=l.bind(n);v.each(t,function(e){if(l(e)){var t=v.isFunction(s["node_label"])?s["node_label"].apply(s,[e,n.model,n]):e.label,i=v.isFunction(s["node_image"])?s["node_image"].apply(s,[e,n.model,n]):s["node_image"]||"icon-"+s.type;a.push({value:e.label,image:i,label:t})}});return a}})});g.fn.pgMakeVisible=function(n){return this.each(function(){if(!this||!g(this.length))return;var e,t=g(this),i=function e(t){if(t&&t.length>0){return t.get(0).scrollHeight>t.height()}return false};while(t&&t.length>0){e=t.get(0).offsetTop+t.height();t=t.parent();if(i(t)){t.scrollTop(e)}if(t.hasClass(n))return}})};g.fn.pgMakeBackgridVisible=function(r){return this.each(function(){if(!this||!g(this.length))return;var e=g(this),t=g(this).offsetParent().parent(),i=t.offset().top,n=t.height(),s=g(this).closest(r),a=s[0].offsetHeight-i;if(n>a){var l=e.get(0).offsetTop+e.height();s.find(".tab-content").scrollTop(l)}return})};var a=y.Extension.NodeAjaxOptionsCell=y.Extension.Select2Cell.extend({defaults:v.extend({},y.Extension.Select2Cell.prototype.defaults,{url:undefined,transform:undefined,url_with_id:false,select2:{allowClear:true,placeholder:"Select an item...",width:"style"},opt:{label:null,value:null,image:null,selected:false}}),template:v.template('<option <% if (image) { %> data-image=<%= image %> <% } %> value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- label %></option>'),initialize:function e(){y.Extension.Select2Cell.prototype.initialize.apply(this,arguments);var t=this.column.get("url")||this.defaults.url,i=v.has(this.column.attributes,"options_cached"),n=i&&this.column.get("options_cached");if(t&&!n){var s=this,a=this.model,l=this.column,r=a.top||a,o=l.get("schema_node"),d=l.get("node_info"),c=l.get("url_with_id")||false,u=o.generate_url.apply(o,[null,t,l.get("node_data"),c,d]),f,p=l.get("cache_node");p=p&&b.Browser.Nodes[p]||o;if(l.has("cache_level")){f=l.get("cache_level")}else{f=p.cache_level(d,c)}var h=p.cache(o.type+"#"+t,d,f);if(l.get("version_compatible")&&(v.isUndefined(h)||v.isNull(h))){r.trigger("pgadmin:view:fetching",a,l);g.ajax({async:false,url:u}).done(function(e){h=p.cache(o.type+"#"+t,d,f,e.data)}).fail(function(){r.trigger("pgadmin:view:fetch:error",a,l)});r.trigger("pgadmin:view:fetched",a,l)}h=h&&h.data||[];var m=l.get("transform")||s.defaults.transform;if(m&&v.isFunction(m)){l.set("options",m.bind(l,h))}else{l.set("options",h)}if(i){l.set("options_cached",true)}}}});y.Extension.NodeListByIdCell=a.extend({controlClassName:"pgadmin-node-select backgrid-cell",defaults:v.extend({},a.prototype.defaults,{url:"nodes",filter:undefined,transform:function e(t,i){var n=i||this,s=n.column.get("schema_node"),a=[],l=n.column.get("filter")||function(){return true};l=l.bind(n);v.each(t,function(e){if(l(e)){var t=v.isFunction(s["node_label"])?s["node_label"].apply(s,[e,n.model,n]):e.label,i=v.isFunction(s["node_image"])?s["node_image"].apply(s,[e,n.model,n]):s["node_image"]||"icon-"+s.type;a.push({value:e._id,image:i,label:t})}});return a},select2:{placeholder:"Select an item...",width:"style",templateResult:n,templateSelection:n}})});y.Extension.NodeListByNameCell=a.extend({controlClassName:"pgadmin-node-select backgrid-cell",defaults:v.extend({},a.prototype.defaults,{url:"nodes",filter:undefined,transform:function e(t,i){var n=i||this,s=n.column.get("schema_node"),a=[],l=n.column.get("filter")||function(){return true};l=l.bind(n);v.each(t,function(e){if(l(e)){var t=v.isFunction(s["node_label"])?s["node_label"].apply(s,[e,n.model,n]):e.label,i=v.isFunction(s["node_image"])?s["node_image"].apply(s,[e,n.model,n]):s["node_image"]||"icon-"+s.type;a.push({value:e.label,image:i,label:t})}});return a},select2:{placeholder:"Select an item...",width:"style",templateResult:n,templateSelection:n}})});y.Extension.MultiSelectAjaxCell=y.Extension.NodeAjaxOptionsCell.extend({defaults:v.extend({},a.prototype.defaults,{transform:undefined,url_with_id:false,select2:{allowClear:true,placeholder:"Select an item...",width:"style",multiple:true},opt:{label:null,value:null,image:null,selected:false}}),getValueFromDOM:function e(){var t=[];this.$el.find("select").find(":selected").each(function(){t.push(g(this).attr("value"))});return t}});f.MultiSelectAjaxControl=i.extend({defaults:v.extend({},i.prototype.defaults,{select2:{multiple:true,allowClear:true,width:"style"}})});return f}.apply(t,n),s!==undefined&&(e.exports=s))},5:function(i,a,l){"use strict";(function(x){var e,t;function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);if(e)n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable});i.push.apply(i,n)}return i}function k(t){for(var e=1;e<arguments.length;e++){var i=arguments[e]!=null?arguments[e]:{};if(e%2){n(i,true).forEach(function(e){s(t,e,i[e])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))}else{n(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}}return t}function s(e,t,i){if(t in e){Object.defineProperty(e,t,{value:i,enumerable:true,configurable:true,writable:true})}else{e[t]=i}return e}!(e=[l(51),l(2),l(4),l,l(0),l(1),l(8),l(95),l(3),l(10),l(23),l(96),l(55),l(80),l(47),l(17),l(48),l(21),l(289),l(290),l(291),l(98),l(99),l(192),l(292),l(100),l(293),l(193),l(27),l(7),l(34),l(101),l(83)],t=function(e,f,a,t,h,m,l,i,g,p,n,d,o,c,s,u){x=window.$=h;var v=window.wcDocker;h=h||x||window.$;i=i||window.Bootstrap;var b=n.default;var y=g.Browser=g.Browser||{};var C=f("Please select an object in the tree view.");s.setPGCSRFToken(g.csrf_token_header,g.csrf_token);var r={};r[v.EVENT.VISIBILITY_CHANGED]=function(){if(this.isVisible()){var e=g.Browser,t=e.tree?e.tree.selected():undefined,i=t&&t.length==1?e.tree.itemData(t):undefined;if(i&&e.Nodes[i._type].callbacks["selected"]&&m.isFunction(e.Nodes[i._type].callbacks["selected"])){return e.Nodes[i._type].callbacks["selected"].apply(e.Nodes[i._type],[t,i,e])}}};var _=function e(t){var i=JSON.parse(t).data;if(i.length&&i[0]._type!=="column"&&i[0]._type!=="catalog_object_column"){i=i.sort(function(e,t){return g.natural_sort(e.label,t.label)})}m.each(i,function(e){e._label=e.label;e.label=m.escape(e.label)});return i};var w=g.Browser.initializeBrowserTree=function(o){h("#tree").aciTree({ajax:{url:a("browser.nodes"),converters:{"text json":_}},ajaxHook:function e(t,i){if(t!=null){var n=this.itemData(t);var s=o.Nodes[n._type];if(s)i.url=s.generate_url(t,"children",n,true)}},loaderDelay:100,show:{duration:75},hide:{duration:75},view:{duration:75},animateRoot:true,unanimated:false});o.tree=h("#tree").aciTree("api");o.treeMenu.register(h("#tree"));o.treeMenu.registerDraggableType({"table partition type sequence package view mview foreign_table edbvar":function e(t,i){return u.fully_qualify(o,t,i)},"schema column":function e(t){return u.quote_ident(t._label)},"edbfunc function edbproc procedure":function e(t,i){var n=k({},t),s=null,a="",l={from:0,to:0};s=u.parseFuncParams(n._label);n._label=s.func_name;a=u.fully_qualify(o,n,i);if(s.params.length>0){a=a+"(";l.from=a.length;a=a+s.params[0][0];l.to=a.length;for(var r=1;r<s.params.length;r++){a=a+", "+s.params[r][0]}a=a+")"}else{a=a+"()";l.from=l.to=a.length+1}return{text:a,cur:l}}})};m.extend(g.Browser,{URL:a("browser.index"),docker:null,editor:null,tree:null,treeMenu:new e.Tree,scripts:{},stdW:{sm:500,md:700,lg:900,default:500},stdH:{sm:200,md:400,lg:550,default:550},panels:{browser:new g.Browser.Panel({name:"browser",title:f("Browser"),showTitle:true,isCloseable:false,isPrivate:true,icon:"",content:'<div id="tree" class="aciTree"></div>',onCreate:function e(t){o.initializeToolbar(t,v)}}),properties:new g.Browser.Panel({name:"properties",title:f("Properties"),icon:"",width:500,isCloseable:false,isPrivate:true,elContainer:true,content:'<div class="obj_properties container-fluid"><div class="alert alert-info pg-panel-message">'+C+"</div></div>",events:r,onCreate:function e(t,i){i.addClass("pg-no-overflow")}}),statistics:new g.Browser.Panel({name:"statistics",title:f("Statistics"),icon:"",width:500,isCloseable:false,isPrivate:true,content:'<div class="negative-space p-2"><div class="alert alert-info pg-panel-message pg-panel-statistics-message">'+C+'</div><div class="pg-panel-statistics-container d-none"></div></div>',events:r}),sql:new g.Browser.Panel({name:"sql",title:f("SQL"),icon:"",width:500,isCloseable:false,isPrivate:true,content:'<div class="sql_textarea"><textarea id="sql-textarea" name="sql-textarea"></textarea></div>'}),dependencies:new g.Browser.Panel({name:"dependencies",title:f("Dependencies"),icon:"",width:500,isCloseable:false,isPrivate:true,content:'<div class="negative-space p-2"><div class="alert alert-info pg-panel-message pg-panel-depends-message">'+C+'</div><div class="pg-panel-dependencies-container d-none"></div></div>',events:r}),dependents:new g.Browser.Panel({name:"dependents",title:f("Dependents"),icon:"",width:500,isCloseable:false,isPrivate:true,content:'<div class="negative-space p-2"><div class="alert alert-info pg-panel-message pg-panel-depends-message">'+C+'</div><div class="pg-panel-dependents-container d-none"></div></div>',events:r})},frames:{},menus:{context:{},file:{},edit:{},object:{},management:{},tools:{},help:{}},add_panels:function e(){var t=JSON.parse(y.panels_items);m.each(t,function(e){if(e.isIframe){y.frames[e.name]=new y.Frame({name:e.name,title:e.title,icon:e.icon,width:e.width,height:e.height,showTitle:e.showTitle,isCloseable:e.isCloseable,isPrivate:e.isPrivate,url:e.content})}else{y.panels[e.name]=new y.Panel({name:e.name,title:e.title,icon:e.icon,width:e.width,height:e.height,showTitle:e.showTitle,isCloseable:e.isCloseable,isPrivate:e.isPrivate,content:e.content?e.content:"",events:e.events?e.events:"",canHide:e.canHide?e.canHide:""})}})},menu_categories:{create:{label:f("Create"),priority:1,above:false,below:true,single:true}},register_script:function e(t,i,n){var s=this.scripts;s[t]=m.isArray(s[t])?s[t]:[];s[t].push({name:i,path:n,loaded:false})},masterpass_callback_queue:[],enable_disable_menus:function e(n){var t=this,i=h("#navbar-menu > ul").first(),s=i.find("li#mnu_obj .dropdown-menu").first(),a=t.tree.itemData(n),l=function e(t){if(t instanceof g.Browser.MenuItem){t.update(a,n)}else{for(var i in t){e(t[i])}}};o.enable(f("View Data"),false);o.enable(f("Filtered Rows"),false);s.empty();m.each([{m:"file",id:"#mnu_file"},{m:"edit",id:"#mnu_edit"},{m:"management",id:"#mnu_management"},{m:"tools",id:"#mnu_tools"},{m:"help",id:"#mnu_help"}],function(e){m.each(t.menus[e.m],function(e){l(e)})});if(n&&t.menus["object"]&&t.menus["object"][a._type]){g.Browser.MenuCreator(s,t.menus["object"][a._type],t.menu_categories,a,n)}else{var r=g.Browser.MenuGroup(t.menu_categories["create"],[{$el:h('<li><a class="dropdown-item disabled" href="#">'+f("No object selected")+"</a></li>"),priority:1,category:"create",update:function e(){}}],false);s.append(r.$el)}},init:function e(){var r=this;if(r.initialized){return}r.initialized=true;r.cache_preferences();r.add_panels();r.docker=new v("#dockerContainer",{allowContextMenu:true,allowCollapse:false,loadingClass:"pg-sp-icon",themePath:a("static",{filename:"css"}),theme:"webcabin.overrides.css"});if(r.docker){m.each(r.panels,function(e,t){r.panels[t].load(r.docker)});m.each(r.frames,function(e,t){r.frames[t].load(r.docker)});var t=y.utils.layout;r.restore_layout(r.docker,t,r.buildDefaultLayout.bind(r));r.docker.on(v.EVENT.LAYOUT_CHANGED,function(){r.save_current_layout("Browser/Layout",r.docker)})}r.editor=b.fromTextArea(document.getElementById("sql-textarea"),{lineNumbers:true,mode:"text/x-pgsql",readOnly:true,extraKeys:g.Browser.editor_shortcut_keys});var i=setInterval(function(){var e=r.get_preferences_for_module("sqleditor");if(e){clearInterval(i);r.reflectPreferences("sqleditor")}},500);r.onPreferencesChange("sqleditor",function(){r.reflectPreferences("sqleditor")});setTimeout(function(){r.editor.setValue("-- "+C);r.editor.refresh()},10);w(r);h("#tree").contextMenu({selector:".aciTreeLine",autoHide:false,build:function e(t){var i=r.tree.itemFrom(t),n=r.tree.itemData(i),s=r.menus["context"][n._type],a=h("<div></div>"),l={};g.Browser.MenuCreator(a,s,r.menu_categories,n,i,l);return{autoHide:false,items:l}},events:{hide:function e(){r.keyboardNavigation.bindLeftTree()}}});h("#tree").on("acitree",function(e,t,i,n,s){var a=i?r.tree.itemData(i):null;var l;if(a&&r.Nodes[a._type]){l=r.Nodes[a._type];if(m.isObject(l.callbacks)&&n in l.callbacks&&typeof l.callbacks[n]=="function"&&!l.callbacks[n].apply(l,[i,a,r,s,n])){return false}try{l.trigger("browser-node."+n,l,i,a)}catch(e){console.warn(e.stack||e)}}try{r.Events.trigger("pgadmin-browser:tree",n,i,a);r.Events.trigger("pgadmin-browser:tree:"+n,i,a,l)}catch(e){console.warn(e.stack||e)}return true});y.utils.registerScripts(this);y.utils.addMenus(r);var n={};n[g.csrf_token_header]=g.csrf_token;setInterval(function(){h.ajax({url:a("misc.cleanup"),type:"POST",headers:n}).done(function(){}).fail(function(){})},3e5);r.set_master_password("");r.Events.on("pgadmin:browser:tree:add",r.onAddTreeNode,r);r.Events.on("pgadmin:browser:tree:update",r.onUpdateTreeNode,r);r.Events.on("pgadmin:browser:tree:refresh",r.onRefreshTreeNode,r);r.Events.on("pgadmin-browser:tree:loadfail",r.onLoadFailNode,r);r.bind_beforeunload()},init_master_password:function e(){var n=this;if(!p.dlgMasterPass){p.dialog("dlgMasterPass",function e(){return{main:function e(t,i,n){this.set("title",t);this.message=i;this.reset=n},build:function e(){p.pgDialogBuild.apply(this)},setup:function e(){return{buttons:[{text:"",className:"btn btn-secondary pull-left fa fa-question pg-alertify-icon-button",attrs:{name:"dialog_help",type:"button",label:f("Master password"),url:a("help.static",{filename:"master_password.html"})}},{text:f("Reset Master Password"),className:"btn btn-secondary fa fa-trash-o pg-alertify-button pull-left"},{text:f("Cancel"),className:"btn btn-secondary fa fa-times pg-alertify-button",key:27},{text:f("OK"),key:13,className:"btn btn-primary fa fa-check pg-alertify-button"}],focus:{element:"#password",select:true},options:{modal:true,resizable:false,maximizable:false,pinnable:false}}},prepare:function e(){var t=this;t.setContent(t.message);if(!t.reset){h(t.__internal.buttons[1].element).addClass("d-none")}else{h(t.__internal.buttons[1].element).removeClass("d-none")}},callback:function e(t){var i=this;if(t.index==3){n.set_master_password(h("#frmMasterPassword #password").val(),i.set_callback)}else if(t.index==2){n.masterpass_callback_queue=[]}else if(t.index==1){t.cancel=true;p.confirm(f("Reset Master Password"),f("This will remove all the saved passwords. This will also remove established connections to "+"the server and you may need to reconnect again. Do you wish to continue ?"),function(){n.reset_master_password();i.close();return true},function(){return true}).set("labels",{ok:f("Yes"),cancel:f("No")})}else if(t.index==0){t.cancel=true;n.showHelp(t.button.element.name,t.button.element.getAttribute("url"),null,null);return}}}})}},check_master_password:function e(t){h.ajax({url:a("browser.check_master_password"),type:"GET",contentType:"application/json"}).done(function(e){if(t){if(e.data){t(true)}else{t(false)}}}).fail(function(e,t,i){p.pgRespErrorNotify(e,i)})},reset_master_password:function e(){var t=this;h.ajax({url:a("browser.set_master_password"),type:"DELETE",contentType:"application/json"}).done(function(e){if(!e.data){t.set_master_password("")}}).fail(function(e,t,i){p.pgRespErrorNotify(e,i)})},set_master_password:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:function(){};var n=null,s=this;if(t!=null||t!=""){n=JSON.stringify({password:t})}s.masterpass_callback_queue.push(i);h.ajax({url:a("browser.set_master_password"),type:"POST",data:n,dataType:"json",contentType:"application/json"}).done(function(e){if(!e.data.present){s.init_master_password();p.dlgMasterPass(e.data.title,e.data.content,e.data.reset)}else{setTimeout(function(){while(s.masterpass_callback_queue.length>0){var e=s.masterpass_callback_queue.shift();e()}},500)}}).fail(function(e,t,i){p.pgRespErrorNotify(e,i)})},bind_beforeunload:function e(){h(window).on("beforeunload",function(e){var t=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;var i=y.get_preference("browser","browser_tree_state_save_interval"),n=t.get_preference("browser","confirm_on_refresh_close");if(!m.isUndefined(i)&&i.value!==-1)g.Browser.browserTreeState.save_state();if(!m.isUndefined(n)&&n.value){var s=l(f("Are you sure you want to close the %s browser?")).sprintf(y.utils.app_name).value();e.originalEvent.returnValue=s;return s}})},add_menu_category:function e(t,i,n,s,a,l,r){this.menu_categories[t]={label:i,priority:n,icon:s,above:a===true,below:l===true,single:r}},add_menus:function e(t){var l=this,r=this.menus,o=g.Browser.MenuItem;m.each(t,function(a){m.each(a.applies,function(e){if(h.inArray(e,["context","file","edit","object","management","tools","help"])>=0){var t;if(!d(l,a.node)){return}else if(m.has(a,"module")&&!m.isUndefined(a.module)){if(!d(l,a.module.type)){return}}r[e]=r[e]||{};if(m.isString(a.node)){t=r[e][a.node]=r[e][a.node]||{}}else if(m.isString(a.category)){t=r[e][a.category]=r[e][a.category]||{}}else{t=r[e]}var i=function e(t){return new o({name:t.name,label:t.label,module:t.module,category:t.category,callback:t.callback,priority:t.priority,data:t.data,url:t.url||"#",target:t.target,icon:t.icon,enable:t.enable==""?true:m.isString(t.enable)&&t.enable.toLowerCase()=="false"?false:t.enable,node:t.node,checked:t.checked})};if(!m.has(t,a.name)){t[a.name]=i(a);if(a.menu_items){var n=[];for(var s=0;s<a.menu_items.length;s++){n.push(i(a.menu_items[s]))}t[a.name]["menu_items"]=n}}}else{console.warn("Developer warning: Category '"+e+"' is not supported!\nSupported categories are: context, file, edit, object, tools, management, help")}})})},create_menus:function e(){var n=h("#navbar-menu > ul").first();var s=this;m.each([{menu:"file",id:"#mnu_file"},{menu:"edit",id:"#mnu_edit"},{menu:"management",id:"#mnu_management"},{menu:"tools",id:"#mnu_tools"},{menu:"help",id:"#mnu_help"}],function(e){var t=n.children(e.id).first(),i=t.children(".dropdown-menu").first();i.empty();if(g.Browser.MenuCreator(i,s.menus[e.menu],s.menu_categories)){t.removeClass("d-none")}});n.children("#mnu_obj").removeClass("d-none");s.enable_disable_menus()},showHelp:function e(t,i,n,s){if(t=="object_help"){var a=n.getTreeNodeHierarchy(s).server;var l=y.utils.pg_help_path;if(a.server_type=="ppas"){l=y.utils.edbas_help_path}var r=c.getHelpUrl(l,i,a.version);window.open(r,"postgres_help")}else if(t=="dialog_help"){window.open(i,"pgadmin_help")}},_findTreeChildNode:function e(r,o,d){var t=d.t.wasLoad(r),i=function e(){var t=d.t.children(r),i,n,s,a=0,l=t.length;for(;a<l;a++){i=t.eq(a);n=d.t.itemData(i);if(n._type===o._type){if(!d.hasId||n._id==o._id){d.i=i;d.d=o;d.pathOfTreeItems.push({coll:false,item:i,d:o});d.success();return}}else{s=d.b.Nodes[n._type];if(s&&s.collection_node&&n.nodes&&m.indexOf(n.nodes,o._type)!=-1){d.i=i;d.d=null;d.pathOfTreeItems.push({coll:true,item:i,d:n});if(!d.t.isInode(i)){d.load=false}d.b._findTreeChildNode(i,o,d);return}}}d.notFound&&typeof d.notFound=="function"&&d.notFound(o)};if(!t&&d.load){d.t.open(r,{success:i,unanimated:true,fail:function e(){var e=d&&d.o&&d.o.fail;if(e&&typeof e=="function"){e.apply(d.t,[])}}})}else if(t){i()}else{d.notFound&&typeof d.notFound=="function"&&d.notFound(o)}return},onAddTreeNode:function e(c,t,i){var n={b:this,d:null,hasId:true,i:null,p:m.toArray(t||{}).sort(function(e,t){return e.priority===t.priority?0:e.priority<t.priority?-1:1}),pathOfTreeItems:[],t:this.tree,o:i},s=function(){var e=this,t;e.success=s;if(e.p.length){t=e.p.shift();if(!e.p.length){t._id=c._pid;e.success=a}e.b._findTreeChildNode(e.i,t,e);if(!c._pid){a.apply(e,arguments)}}return true}.bind(n),a=function(){var e=this,t=(e.i||this.t.wasLoad(e.i))&&this.t.first(e.i),i=function(e,t){var i=this;i.success=e;i.notFound=t;i.b._findTreeChildNode(i.i,c,i)}.bind(e),n=function(){this.t.openPath(this.i);this.t.select(this.i);if(e.o&&e.o.success&&typeof e.o.success=="function"){e.o.success.apply(e.t,[e.i,c])}}.bind(e),s=function(){var s=this,a=s.t.children(s.i),l=0,r=a.length-1,o,d=function e(){while(r>=l){o=a.eq(l);var t=s.t.itemData(o);if(g.natural_sort(t._label,c._label)==1)return true;l++}if(r!=a.length-1){o=a.eq(r);return true}o=null;return false},e=function e(){var t,i,n;while(r-l>22){o=a.eq(l);t=s.t.itemData(o);if(g.natural_sort(t._label,c._label)!=-1)return true;o=a.eq(r);t=s.t.itemData(o);if(g.natural_sort(t._label,c._label)!=1)return true;i=l+Math.round((r-l)/2);o=a.eq(i);t=s.t.itemData(o);n=g.natural_sort(t._label,c._label);if(n==0)return true;if(n==-1){l=i+1;r--}else{l++;r=i-1}}return d()};if(e()){s.t.before(o,{itemData:c,success:function e(){if(s.o&&s.o.success&&typeof s.o.success=="function"){s.o.success.apply(s.t,[o,c])}},fail:function e(){console.warn("Failed to add before...",arguments);if(s.o&&s.o.fail&&typeof s.o.fail=="function"){s.o.fail.apply(s.t,[o,c])}}})}else{var t=function(){var s=this,a=s.t.wasLoad(s.i),l=s.t.itemData(s.i);s.t.append(s.i,{itemData:c,success:function e(t,i){var n=h(i.items[0]);if(a&&l&&l._type.search(c._type)>-1){s.t.openPath(n);s.t.select(n)}else{if(l){s.t.unload(s.i,{success:function e(t){s.t.open(t)}})}}if(s.o&&s.o.success&&typeof s.o.success=="function"){s.o.success.apply(s.t,[n,c])}},fail:function e(){console.warn("Failed to append...",arguments);if(s.o&&s.o.fail&&typeof s.o.fail=="function"){s.o.fail.apply(s.t,[s.i,c])}}})}.bind(s);if(s.i&&!s.t.isInode(s.i)){s.t.setInode(s.i,{success:t})}else{t()}}}.bind(e);if(!t&&e.t.wasLoad(e.i)){e.t.unload(e.i,{success:function(){i(n,function(){var e=this&&this.o;if(e&&e.fail&&typeof e.fail=="function"){e.fail.apply(this.t,[this.i,c])}}.bind(this))}.bind(this),fail:function(){var e=this&&this.o;if(e&&e.fail&&typeof e.fail=="function"){e.fail.apply(this.t,[this.i,c])}}.bind(this)});return}i(n,s)}.bind(n);if(!n.t.wasInit()||!c){return}c._label=c.label;c.label=m.escape(c.label);s()},onUpdateTreeNode:function e(c,u,t,i){var s={b:this,d:null,i:null,hasId:true,p:m.toArray(t||{}).sort(function(e,t){return e.priority===t.priority?0:e.priority<t.priority?-1:1}),pathOfTreeItems:[],t:this.tree,o:i,load:true,old:c,new:u,op:null},d=function(){var e=this.o&&this.o.fail;if(e&&typeof e=="function"){e.apply(this.t,[this.i,u,c])}}.bind(s),n=function(){var a=this,t=this.pathOfTreeItems,l=function(){if(t.length){t.pop();var e=t.length;this.i=e&&t[e-1].item||null;this.d=e&&t[e-1].d||null;if(e&&t[e-1].coll){t.pop();e=t.length;this.i=e&&t[e-1].item||null;this.d=e&&t[e-1].d||null}}else{this.i=null;this.d=null}}.bind(this);var r=this.i&&this.t.hasParent(this.i)&&this.t.parent(this.i)||null,o=r?this.t.hasParent(r)&&this.t.parent(r):null;if(this.i&&this.d&&this.old._id==this.d._id&&this.old._type==this.d._type){var i=this.t.parent(this.i)||null;if(i.length==0&&s.op=="UPDATE"){f()}else{var n=function(){if(r&&!o){var i=null;var e=this.t.siblings(this.i)||[];e.push(this.i[0]);m.each(e,function(e){var t=a.t.itemData(h(e));if(t._id==a.new._pid){i=e;a.pathOfTreeItems.push({coll:true,item:i,d:t})}});if(i){this.load=true;this.success=function(){p()}.bind(this);this.notFound=d;i=h(i);var t=this.t.wasLoad(i),n=function e(){a.i=i;a.pathOfTreeItems.push({coll:false,item:i,d:a.d});a.success();return};if(!t&&a.load){a.t.open(i,{success:n,unanimated:true,fail:function e(){var e=a&&a.o&&a.o.fail;if(e&&typeof e=="function"){e.apply(a.t,[])}}})}else{n()}}return}else{var s=this.d;l();if(this.i){this.load=true;this.success=function(){p()}.bind(this);this.notFound=d;this.b._findTreeChildNode(this.i,{_id:this.new._pid,_type:s._type},this)}else{p()}return}}.bind(this);this.t.remove(this.i,{success:function e(){l();if(r&&!o&&i&&a.t.children(i).length==0){a.t.setInode(i,{success:function e(){a.t.unload(i,{success:function e(){setTimeout(n)}})}})}else{setTimeout(n)}return true}})}}d()}.bind(s),a=function(e){var t=function(){var e=this.pathOfTreeItems;if(e.length){e.pop();var t=e.length;this.i=t&&e[t-1].item||null;this.d=t&&e[t-1].d||null;if(t&&e[t-1].coll){e.pop();t=e.length;this.i=t&&e[t-1].item||null;this.d=t&&e[t-1].d||null}}else{this.i=null;this.d=null}}.bind(this);if(this.i){this.load=true;this.success=function(){p()}.bind(this);if(e._type==this.old._type){t();e=this.d;t()}e=this.new._pid;this.notFound=d;this.b._findTreeChildNode(this.i,e,this)}else{p()}}.bind(s),f=function(){if(this.i&&this.d&&this.new._type==this.d._type){var e=this,t=this.d._id;if(this.new._id!=this.d._id){var i=this.t.itemData(s.i);i._id=t=this.new._id}if(this.new._id==t){m.extend(this.d,{_id:this.new._id,_label:this.new._label,label:this.new.label});this.t.setLabel(s.i,{label:this.new.label});this.t.addIcon(s.i,{icon:this.new.icon});this.t.setId(s.i,{id:this.new.id});this.t.openPath(this.i);this.t.deselect(this.i);setTimeout(function(){e.t.select(e.i)},10)}}var n=this.o&&this.o.success;if(n&&typeof n=="function"){n.apply(this.t,[this.i,c,u])}}.bind(s),l=function(){var e=this,t;e.success=l;if(e.p.length){t=e.p.shift();if(!e.p.length){if(e.op=="RECREATE"){e.load=false;e.success=n;e.notFound=a}else{e.success=f;e.notFound=d}}e.b._findTreeChildNode(e.i,t,e)}else if(e.p.length==1){e.notFound=a}return true}.bind(s),p=function(){var e=this,t=(e.i||this.t.wasLoad(e.i))&&this.t.first(e.i),i=function(e,t){var i=this;i.success=e;i.notFound=t;i.b._findTreeChildNode(i.i,u,i)}.bind(e),n=function(){this.t.openPath(this.i);this.t.select(this.i);if(e.o&&e.o.success&&typeof e.o.success=="function"){e.o.success.apply(e.t,[e.i,u])}}.bind(e),s=function(){var s=this,a=s.t.children(s.i),l=0,r=a.length-1,o,d=function e(){while(r>=l){o=a.eq(l);var t=s.t.itemData(o);if(g.natural_sort(t._label,u._label)==1)return true;l++}if(r!=a.length-1){o=a.eq(r);return true}o=null;return false},e=function e(){while(r-l>22){o=a.eq(l);var t=s.t.itemData(o);if(g.natural_sort(t._label,u._label)!=-1)return true;o=a.eq(r);t=s.t.itemData(o);if(g.natural_sort(t._label,u._label)!=1)return true;var i=l+Math.round((r-l)/2);o=a.eq(i);t=s.t.itemData(o);var n=g.natural_sort(t._label,u._label);if(n==0)return true;if(n==-1){l=i+1;r--}else{l++;r=i-1}}return d()};if(e()){s.t.before(o,{itemData:u,success:function e(){var t=h(arguments[1].items[0]);s.t.openPath(t);s.t.select(t);if(s.o&&s.o.success&&typeof s.o.success=="function"){s.o.success.apply(s.t,[o,c,u])}},fail:function e(){console.warn("Failed to add before..",arguments);if(s.o&&s.o.fail&&typeof s.o.fail=="function"){s.o.fail.apply(s.t,[o,c,u])}}})}else{var t=function e(){s.t.append(s.i,{itemData:u,success:function e(){var t=h(arguments[1].items[0]);s.t.openPath(t);s.t.select(t);if(s.o&&s.o.success&&typeof s.o.success=="function"){s.o.success.apply(s.t,[s.i,c,u])}},fail:function e(){console.warn("Failed to append...",arguments);if(s.o&&s.o.fail&&typeof s.o.fail=="function"){s.o.fail.apply(s.t,[s.i,c,u])}}})};if(s.i&&!s.t.isInode(s.i)){s.t.setInode(s.i,{success:t})}else{t()}}}.bind(e);if(!t&&e.t.wasLoad(e.i)){e.t.unload(e.i,{success:function(){i(n,function(){var e=this&&this.o;if(e&&e.fail&&typeof e.fail=="function"){e.fail.apply(this.t,[this.i,c,u])}}.bind(this))}.bind(this),fail:function(){var e=this&&this.o;if(e&&e.fail&&typeof e.fail=="function"){e.fail.apply(this.t,[this.i,c,u])}}.bind(this)});return}i(n,s)}.bind(s);if(!s.t.wasInit()||!u||!c){return}s.pathOfTreeItems.push(c);u._label=u.label;u.label=m.escape(u.label);if(s.b.Nodes[u._type].is_collection){if("collection_count"in c&&c["collection_count"]>0){u.label=m.escape(u._label)+" <span>("+c["collection_count"]+")</span>"}}if(c._type=="server"&&u._type=="server"&&(c._pid!=u._pid||c._label!=u._label||c.icon!=u.icon)){s.op="RECREATE";l()}else if(c._pid!=u._pid||c._label!=u._label){s.op="RECREATE";l()}else{s.op="UPDATE";l()}},onRefreshTreeNode:function e(t,i){var n=t&&this.tree.itemData(t),s=n&&n._type&&this.Nodes[n._type],c={b:this,d:n,i:t,p:null,pathOfTreeItems:[],t:this.tree,o:i},a,l=-1;this.Events.trigger("pgadmin-browser:tree:refreshing",t,n,s);if(!s){t=null;c.i=null;c.d=null}else{a=this.tree.isInode(t)&&this.tree.isOpen(t)}c.branch=c.t.serialize(t,{},function(e,t,i){l++;if(!l||i.inode&&i.open){return{_id:i._id,_type:i._type,branch:i.branch,open:i.open}}});if(!s){c.t.destroy({success:function e(){w(c.b);c.t=c.b.tree;c.i=null;c.b._refreshNode(c,c.branch)},error:function e(){var t=i.o&&i.o.fail||i.fail;if(typeof t=="function"){t()}}});return}var u=function(l,r,o){var d=o.getTreeNodeHierarchy(l),e=o.generate_url(l,"nodes",r,true);h.ajax({url:e,type:"GET",cache:false,dataType:"json"}).done(function(e){var t=e.result||e.data;t._label=t.label;t.label=m.escape(t.label);c.t.setLabel(c.i,{label:t.label});c.t.addIcon(c.i,{icon:t.icon});c.t.setId(c.i,{id:t.id});if(t.inode)c.t.setInode(c.i,{inode:true});var i=c.t.itemData(c.i);m.extend(i,t);if(o.can_expand&&typeof o.can_expand=="function"){if(!o.can_expand(i)){c.t.unload(c.i);return}}c.b._refreshNode(c,c.branch);var n=c.o&&c.o.success||c.success;if(n&&typeof n=="function"){n()}}).fail(function(e,t,i){if(!p.pgHandleItemError(e,t,i,{item:l,info:d})){var n=e.getResponseHeader("Content-Type"),s=n&&n.indexOf("application/json")==0&&JSON.parse(e.responseText)||{};if(e.status==410&&s.success==0){var a=c.t.parent(c.i);c.t.remove(c.i,{success:function e(){if(a){try{y.Events.trigger("pgadmin:browser:tree:refresh",a)}catch(e){console.warn(e.stack||e)}}}})}p.pgNotifier(t,e,f("Error retrieving details for the node."),function(e){if(e=="CRYPTKEY_SET"){u(l,r,o)}else{console.warn(arguments)}})}})}.bind(this);if(s&&s.collection_node){var r=c.i=this.tree.parent(t),o=function(){this.tree.unload(t,{success:function e(){t=r;n=c.d=c.t.itemData(c.i);s=c.b.Nodes[n._type];t=r;u(t,n,s)},fail:function e(){console.warn(arguments)}})}.bind(this);if(!this.tree.isInode(t)){this.tree.setInode(t,{success:o})}else{o()}}else if(a){this.tree.unload(t,{success:u.bind(this,t,n,s),fail:function e(){console.warn(arguments)}})}else if(!this.tree.isInode(t)&&n.inode){this.tree.setInode(t,{success:u.bind(this,t,n,s),fail:function e(){console.warn(arguments)}})}else{u(t,n,s)}},onLoadFailNode:function e(t){var i=this,n=i.tree.isSelected(t);i.check_master_password(function(e){if(!e){i.set_master_password("",function(){if(n){i.tree.select(t)}i.tree.open(t)})}})},removeChildTreeNodesById:function e(t,i,n){var s=y.tree;if(t&&i){var a=s.children(t),l=0,r=a.length,o,d;t=null;for(;l<r;l++){o=a.eq(l);d=s.itemData(o);if(d._type==i){t=o;break}}}if(t){a=s.children(t);l=0;r=a.length;for(;l<r;l++){o=a.eq(l);d=s.itemData(o);if(n.indexOf(d._id)!=-1){y.removeTreeNode(o,false,t)}}return true}return false},removeTreeNode:function e(t,i,n){var s=y.tree,a=null;if(!t)return false;if(i){a=s.next(t);if(!a||!a.length){a=s.prev(t);if(!a||!a.length){if(!n){a=s.parent(t)}else{a=n}}}if(a)s.select(a)}s.remove(t);return true},findSiblingTreeNode:function e(t,i){var n=y.tree,s=n.parent(t),a=n.children(s),l=0,r,o;for(;l<a.length;l++){o=a.eq(l);r=n.itemData(o);if(r&&r._id==i)return o}return null},findParentTreeNodeByType:function e(t,i){var n=y.tree,s,a=t;do{s=n.itemData(a);if(s&&s._type==i)return a;a=n.hasParent(a)?n.parent(a):null}while(a);return null},findChildCollectionTreeNode:function e(t,i){var n=y.tree,s,a=0,l=t,r=t&&n.children(t);if(!r||!r.length)return null;for(;a<r.length;a++){l=r.eq(a);s=n.itemData(l);if(s&&s._type==i)return l}return null},addChildTreeNodes:function e(t,i,a,l,n){var r=a in y.Nodes&&y.Nodes[a],o=l.length&&m.extend({},m.mapObject(t,function(e){e.priority-=1;return e})),d=[],s=function n(s){if(!l.length){if(s){s()}return}var e={_id:l.pop(),_type:a,priority:0},t;o[a]=e;t=r.generate_url(null,"nodes",e,true,o);h.ajax({url:t,dataType:"json"}).done(function(e){if(e.success){d.push(e.data)}n(s)}).fail(function(e,t,i){p.pgRespErrorNotify(e,i);n(s)})};if(!r){console.warn("Developer: Couldn't find the module for the given child: ",m.clone(arguments));return}if(y.tree.wasLoad(i)||y.tree.isLeaf(i)){s(function(){m.each(d,function(e){y.Events.trigger("pgadmin:browser:tree:add",e,t)});if(n){n()}})}else{if(n){n()}}},_refreshNode:function e(t,i){var n=function(e){var t=this,i=0,n,s,a=e.branch&&e.branch.length||0,l=function e(t,i,n){setTimeout(function(){n.b._findTreeChildNode(t,i,n)},0)};for(;i<a;i++){s=e.branch[i];var r=t.b.Nodes[s._type];n={b:t.b,t:t.t,pathOfTreeItems:[],i:t.i,d:s,select:t.select,hasId:r&&!r.collection_node,o:t.o,load:true};n.success=function(){this.b._refreshNode.call(this.b,this,this.d)}.bind(n);l(t.i,s,n)}}.bind(t,i);if(!i||!i.open)return;if(!t.t.isOpen(t.i)){t.t.open(t.i,{unanimated:true,success:n,fail:function e(){}})}else{n()}},editor_shortcut_keys:{"Ctrl-Space":"autocomplete","Cmd-Space":"autocomplete","Ctrl-A":"selectAll","Cmd-A":"selectAll","Ctrl-Y":"redo","Cmd-Y":"redo","Ctrl-Z":"undo","Cmd-Z":"undo","Ctrl-D":"deleteLine","Cmd-D":"deleteLine","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Alt-Left":"goGroupLeft","Cmd-Alt-Left":"goGroupLeft","Ctrl-Alt-Right":"goGroupRight","Cmd-Alt-Right":"goGroupRight","Shift-Tab":"indentLess"},editor_options:{tabSize:parseInt(y.utils.tabSize),wrapCode:y.utils.wrapCode,insert_pair_brackets:y.utils.insertPairBrackets,brace_matching:y.utils.braceMatching,indent_with_tabs:y.utils.is_indent_with_tabs},get_browser:function e(){var t=navigator.userAgent,i,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(n[1])){i=/\brv[ :]+(\d+)/g.exec(t)||[];return{name:"IE",version:i[1]||""}}if(n[1]==="Chrome"){i=t.match(/\bOPR|Edge\/(\d+)/);if(i!=null){return{name:i[0],version:i[1]}}}n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"];if((i=t.match(/version\/(\d+)/i))!=null){n.splice(1,1,i[1])}return{name:n[0],version:n[1]}}});delete b.keyMap.emacsy["Ctrl-V"];if(y.utils.useSpaces=="True"){g.Browser.editor_shortcut_keys.Tab="insertSoftTab"}return g.Browser}.apply(a,e),t!==undefined&&(i.exports=t))}).call(this,l(0))},6:function(n,s,a){"use strict";(function(e){var t,i;!(t=[a(2),a(1),a(8),a(0),a(9),a(22),a(19),a(15),a(24),a(28),a(268),a(12),a(68),a(94)],i=function(y,C,e,b,c,_,w,p,s,x){var k=window.pgAdmin=window.pgAdmin||{},N=k.Browser;k.editableCell=function(){if(this.attributes&&!C.isUndefined(this.attributes.disabled)&&!C.isNull(this.attributes.disabled)){if(C.isFunction(this.attributes.disabled)){return!this.attributes.disabled.apply(this,arguments)}if(C.isBoolean(this.attributes.disabled)){return!this.attributes.disabled}}};C.extend(_,{controlLabelClassName:"control-label pg-el-sm-3 pg-el-12",controlsClassName:"pgadmin-controls pg-el-sm-9 pg-el-12",controlContainerClassName:"pgadmin-controls pg-el-sm-9 pg-el-12",groupClassName:"pgadmin-control-group form-group row pg-el-12",setGroupClassName:"set-group pg-el-12",tabClassName:"backform-tab pg-el-12",setGroupContentClassName:"fieldset-content pg-el-12",accordianGroupClassName:"accordian-group pg-el-12",accordianContentClassName:"accordian-content pg-el-12",hiddenClassName:"d-none",helpMessageClassName:"form-text text-muted help-block",helpBlockControlClass:"pgadmin-controls offset-sm-3 pg-el-sm-9 pg-el-12"});_.controlMapper={int:["uneditable-input","numeric","integer"],text:["uneditable-input","input","string"],numeric:["uneditable-input","numeric","numeric"],date:"datepicker",datetime:"datetimepicker",boolean:"boolean",options:["readonly-option","select",w.Extension.PGSelectCell],multiline:["textarea","textarea","string"],collection:["sub-node-collection","sub-node-collection","string"],uniqueColCollection:["unique-col-collection","unique-col-collection","string"],switch:"switch",select2:"select2",note:"note",color:"color",radioModern:"radioModern"};_.getMappedControl=function(e,t){if(e in _.controlMapper){var i=_.controlMapper[e];if(!C.isArray(i)){return i}var n=1,s=C.size(i);switch(t){case"properties":n=0;break;case"edit":case"create":case"control":n=1;break;case"cell":n=2;break;default:n=0;break}return i[n>s?0:n]}return e};var t=_.RawFormatter=function(){};C.extend(t.prototype,{fromRaw:function e(t){return t},toRaw:function e(t){return t}});var i=_.Control.prototype.initialize,a=_.Control.prototype.remove;C.extend(_.Control.prototype,{defaults:C.extend(_.Control.prototype.defaults,{helpMessage:null}),initialize:function e(){i.apply(this,arguments);var t=this.field.get("deps");var n=this;if(t&&C.isArray(t)){C.each(t,function(e){var t=e.split(".");var i=t.shift();n.listenTo(n.model,"change:"+i,n.render)})}},remove:function e(){var n=this,t=n.field.get("deps");var i=this.field.get("name").split(".");var s=i.shift();n.stopListening(n.model,"change:"+s,n.render);if(n.model.errorModel instanceof c.Model){n.stopListening(n.model.errorModel,"change:"+s,n.updateInvalid)}if(t&&C.isArray(t)){C.each(t,function(e){var t=e.split(".");var i=t.shift();n.stopListening(n.model,"change:"+i,n.render)})}if(this.cleanup){this.cleanup.apply(this)}if(a){a.apply(n,arguments)}else{c.View.prototype.remove.apply(n,arguments)}},template:C.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <span class="<%=Backform.controlClassName%> uneditable-input" <%=disabled ? "disabled readonly" : ""%>>',"    <%-value%>","  </span>","  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),clearInvalid:function e(){this.$el.removeClass(_.errorClassName);this.$el.find(".pgadmin-control-error-message").remove();return this},updateInvalid:function e(){var n=this,s=this.model.errorModel;if(!(s instanceof c.Model))return this;this.clearInvalid();this.$el.find(":input[name]").not("button").each(function(e,t){var i=n.keyPathAccessor(s.toJSON(),b(t).attr("name"));if(C.isEmpty(i))return;n.$el.addClass(_.errorClassName)})},render:function e(){var t=C.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=t.name.split("."),s=n.shift(),a=n.join("."),l=this.keyPathAccessor(i[s],a),r=C.extend(t,{rawValue:l,value:this.formatter.fromRaw(l,this.model),attributes:i,formatter:this.formatter}),o=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};C.extend(r,{disabled:o(r.disabled,r,this.model),visible:o(r.visible,r,this.model),required:o(r.required,r,this.model)});this.$el.removeClass(_.hiddenClassName);if(!r.visible)this.$el.addClass(_.hiddenClassName);this.$el.html(this.template(r)).addClass(t.name);this.updateInvalid();return this}});C.extend(_.InputControl.prototype,{events:{"change input":"onChange","blur input":"onChange","keyup input":"onKeyUp","focus input":"clearInvalid"},onKeyUp:function e(t){if(this.key_timeout){clearTimeout(this.key_timeout)}this.keyup_timeout=setTimeout(function(){this.onChange(t)}.bind(this),400)}});C.extend(_.TextareaControl.prototype,{defaults:C.extend(_.TextareaControl.prototype.defaults,{rows:5,helpMessage:null,maxlength:null}),events:{"change textarea":"onChange","keyup textarea":"onKeyUp","paste textarea":"onChange","selectionchange textarea":"onChange","focus textarea":"clearInvalid"},template:C.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">',"  <textarea ",'    class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>"',"  <% if (maxlength) { %>",'    maxlength="<%=maxlength%>"',"  <% } %>",'    placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%>','    rows=<%=rows ? rows : ""%>','    <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),onKeyUp:function e(t){if(this.key_timeout){clearTimeout(this.key_timeout)}this.keyup_timeout=setTimeout(function(){this.onChange(t)}.bind(this),400)}});_.SelectControl.prototype.render=function(){var e=C.defaults(this.field.toJSON(),this.defaults),t=this.model.toJSON(),i=e.name.split("."),n=i.shift(),s=i.join("."),a=this.keyPathAccessor(t[n],s),l=C.extend(e,{rawValue:a,value:this.formatter.fromRaw(a,this.model),attributes:t,formatter:this.formatter}),r=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};C.extend(l,{disabled:r(l.disabled,l,this.model),visible:r(l.visible,l,this.model),required:r(l.required,l,this.model)});if(C.isFunction(l.options)){try{l.options=l.options(this)}catch(e){l.options=[];this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}}this.$el.removeClass(_.hiddenClassName);if(!l.visible)this.$el.addClass(_.hiddenClassName);this.$el.html(this.template(l)).addClass(e.name);this.updateInvalid();return this};C.extend(_.SelectControl.prototype.defaults,{helpMessage:null});_.ReadonlyOptionControl=_.SelectControl.extend({template:C.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">',"<% for (var i=0; i < options.length; i++) { %>"," <% var option = options[i]; %>"," <% if (option.value === rawValue) { %>",' <span class="<%=Backform.controlClassName%> uneditable-input" disabled readonly><%-option.label%></span>'," <% } %>","<% } %>","<% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>","</div>"].join("\n")),events:{},getValueFromDOM:function e(){return this.formatter.toRaw(this.$el.find("span").text(),this.model)}});C.extend(_.RadioControl.prototype,{updateInvalid:function e(){var n=this,s=this.model.errorModel;if(!(s instanceof c.Model))return this;this.clearInvalid();this.$el.find(":input[name]").not("button").each(function(e,t){var i=n.keyPathAccessor(s.toJSON(),b(t).attr("name"));if(C.isEmpty(i))return;n.$el.addClass(_.errorClassName).find('[type="radio"]').append(b("<div></div>").addClass("pgadmin-control-error-message pg-el-offset-4 pg-el-8 pg-el-8 help-block").text(i))})}});_.RadioModernControl=_.RadioControl.extend({defaults:{controlLabelClassName:_.controlLabelClassName,controlsClassName:_.controlsClassName,extraClasses:[],helpMessage:"",name:""},template:C.template(['<label class="<%=controlLabelClassName%>"><%=label%></label>',"<div class=\"<%=controlsClassName%> <%=extraClasses.join(' ')%>\">",' <div class="btn-group pgadmin-controls-radio-none<% if (disabled) {%> disabled <%}%>"  data-toggle="buttons">',"  <% for (var i=0; i < options.length; i++) { %>","  <% var option = options[i]; %>",'  <label class="btn btn-primary<% if (option.value == value) { %> active<%}%><% if (!option.disabled && !disabled) { %>" tabindex="0"<% } else { %> disabled"<% } %>>','   <input type="radio" name="<%=name%>" autocomplete="off" value=<%-formatter.fromRaw(option.value)%> <% if (option.value == value) { %> checked<%}%> <% if (option.disabled || disabled) { %> disabled <%}%>> <%-option.label%>',"  </label>","  <% } %>"," </div>"," <% if (helpMessage && helpMessage.length) { %>",'  <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>'," <% } %>","</div>"].join("\n")),formatter:t,getValueFromDOM:function e(){return this.formatter.toRaw(this.$el.find('input[type="radio"]:checked').attr("value"),this.model)},render:function e(){var t=C.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=t.name.split("."),s=n.shift(),a=n.join("."),l=this.keyPathAccessor(i[s],a),r=C.extend(t,{rawValue:l,value:this.formatter.fromRaw(l,this.model),attributes:i,formatter:this.formatter}),o=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};C.extend(r,{disabled:o(r.disabled,r,this.model),visible:o(r.visible,r,this.model),required:o(r.required,r,this.model)});r.options=C.isFunction(r.options)?r.options.apply(r,[this.model]):r.options;this.$el.removeClass(_.hiddenClassName);if(!r.visible)this.$el.addClass(_.hiddenClassName);this.$el.html(this.template(r)).addClass(t.name);this.updateInvalid();this.$el.find(".btn").on("keyup",function(e){switch(e.keyCode){case 32:b(e.currentTarget).trigger("click");break}});return this}});_.SwitchControl=_.InputControl.extend({defaults:{label:"",options:{onText:y("Yes"),offText:y("No"),onColor:"success",offColor:"primary",size:"mini",width:null,height:null},controlLabelClassName:_.controlLabelClassName,controlsClassName:_.controlsClassName,extraClasses:[],helpMessage:null,extraToggleClasses:null},template:C.template(['<label class="<%=controlLabelClassName%>"><%=label%></label>',"<div class=\"<%=controlsClassName%> <%=extraClasses.join(' ')%>\">",'      <input tabindex="-1" type="checkbox" data-style="quick" data-toggle="toggle"','      data-size="<%=options.size%>" data-height="<%=options.height%>"  ','      data-on="<%=options.onText%>" data-off="<%=options.offText%>" ','      data-onstyle="<%=options.onColor%>" data-offstyle="<%=options.offColor%>" data-width="<%=options.width%>" ','      name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),getValueFromDOM:function e(){return this.formatter.toRaw(this.$input.prop("checked"),this.model)},events:{"change input":"onChange",keyup:"toggleSwitch"},toggleSwitch:function e(t){if(t.keyCode==32){this.$el.find("input[type=checkbox]").bootstrapToggle("toggle");t.preventDefault()}},render:function e(){var t=C.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=t.name.split("."),s=n.shift(),a=n.join("."),l=this.keyPathAccessor(i[s],a),r=C.extend(t,{rawValue:l,value:this.formatter.fromRaw(l,this.model),attributes:i,formatter:this.formatter}),o=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};C.extend(r,{disabled:o(t.disabled,t,this.model),visible:o(r.visible,t,this.model),required:o(r.required,t,this.model)});this.$el.removeClass(_.hiddenClassName);if(!r.visible)this.$el.addClass(_.hiddenClassName);if(_.requiredInputClassName){this.$el.removeClass(_.requiredInputClassName)}if(r.required){this.$el.addClass(_.requiredInputClassName)}r.options=C.defaults({disabled:o(t.disabled,t,this.model)},this.field.get("options"),this.defaults.options,b.fn.bootstrapToggle.defaults);this.$el.html(this.template(r)).addClass(t.name);if(!C.isNull(t.extraToggleClasses))this.$el.addClass(t.extraToggleClasses);this.$input=this.$el.find("input[type=checkbox]").first();this.$input.bootstrapToggle();this.$el.find(".toggle.btn").attr("tabindex","0");this.updateInvalid();return this}});_.Dialog=_.Form.extend({schema:undefined,tagName:"div",legend:true,className:function e(){return"pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-12"},tabPanelClassName:function e(){return _.tabClassName},tabIndex:0,initialize:function e(t){var i=t.schema;if(i&&C.isArray(i)){this.schema=C.each(i,function(e){if(e.fields&&!(e.fields instanceof c.Collection))e.fields=new _.Fields(e.fields);e.cId=e.cId||C.uniqueId("pgC_");e.hId=e.hId||C.uniqueId("pgH_");e.disabled=e.disabled||false;e.legend=t.legend});if(t.tabPanelClassName&&C.isFunction(t.tabPanelClassName)){this.tabPanelClassName=t.tabPanelClassName}}this.model.errorModel=t.errorModel||this.model.errorModel||new c.Model;this.controls=[]},template:{header:C.template(['<li class="nav-item" role="presentation" <%=disabled ? "disabled" : ""%>>',' <a class="nav-link" data-toggle="tab" tabindex="-1" data-tab-index="<%=tabIndex%>" href="#<%=cId%>"','  id="<%=hId%>" aria-controls="<%=cId%>">',"<%=label%></a></li>"].join(" ")),panel:C.template('<div role="tabpanel" tabindex="-1" class="tab-pane <%=label%> <%=tabPanelCodeClass%> pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-12 fade" id="<%=cId%>" aria-labelledby="<%=hId%>"></div>')},render:function e(){this.cleanup();var t=this.$el.children().first().children(".active").first().attr("id"),n=this.model,s=this.controls,a=this.template,l=this,r=this.tabIndex*100,o=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};this.$el.empty().attr("role","tabpanel").attr("class",C.result(this,"tabPanelClassName"));n.panelEl=this.$el;var d=b('<ul class="nav nav-tabs" role="tablist"></ul>').appendTo(this.$el);var c=b('<div class="tab-content pg-el-sm-12 pg-el-md-12 pg-el-lg-12 pg-el-12"></div>').appendTo(this.$el);C.each(this.schema,function(e){r++;if(!e.version_compatible||!o(e.visible,e,n)){return}var i=b(a["panel"](C.extend(e,{tabIndex:r}))).appendTo(c).removeClass("collapse").addClass("collapse");b(a["header"](e)).appendTo(d);e.fields.each(function(e){var t=new(e.get("control"))({field:e,model:n,dialog:l,tabIndex:r});i.append(t.render().$el);s.push(t)});d.find('a[data-toggle="tab"]').off("shown.bs.tab").off("hidden.bs.tab").on("hidden.bs.tab",function(){l.hidden_tab=b(this).data("tabIndex")}).on("shown.bs.tab",function(){var e=this;e.shown_tab=b(e).data("tabIndex");n.trigger("pg-property-tab-changed",{model:n,shown:e.shown_tab,hidden:e.hidden_tab,tab:e})})});var i=d.find('[id="'+t+'"]').first();if(i.length==1){i.addClass("active show");c.find("#"+i.attr("aria-controls")).addClass("active show")}else{d.find(".nav-link").first().addClass("active show");c.find(".tab-pane").first().addClass("active show")}return this},remove:function e(t){if(t&&t.data){if(this.model){if(this.model.reset){this.model.reset({validate:false,silent:true,stop:true})}this.model.clear({validate:false,silent:true,stop:true});delete this.model}if(this.errorModel){this.errorModel.clear({validate:false,silent:true,stop:true});delete this.errorModel}}this.cleanup();_.Form.prototype.remove.apply(this,arguments)}});_.Accordian=_.Dialog.extend({className:function e(){return"set-group pg-el-12"},tabPanelClassName:function e(){return _.tabClassName},legendClass:"badge",contentClass:_.accordianContentClassName+" collapse show",template:{header:C.template(['<div class="<%=Backform.accordianGroupClassName%>" <%=disabled ? "disabled" : ""%>>'," <% if (legend != false) { %>",'  <div class="<%=legendClass%>" <%=collapse ? "data-toggle=\'collapse\'" : ""%> data-target="#<%=cId%>"><%=collapse ? "<span class=\'caret\'></span>" : "" %><%=label%></legend>'," <% } %>","</div>"].join("\n")),content:C.template('  <div id="<%= cId %>" class="<%=contentClass%>"></div>')},collapse:true,render:function e(){this.cleanup();var s=this.model,a=this.$el,l=this.template,r=this.controls,o={className:C.result(this,"className"),legendClass:C.result(this,"legendClass"),contentClass:C.result(this,"contentClass"),collapse:C.result(this,"collapse")},d=this.tabIndex*100,c=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};this.$el.empty();C.each(this.schema,function(e){d++;if(!e.version_compatible||!c(e.visible,e,s)){return}if(!e.fields)return;var t=C.extend({},o,e),i=b(l["header"](t)).appendTo(a),n=b(l["content"](t)).appendTo(i);e.fields.each(function(e){var t=new(e.get("control"))({field:e,model:s,tabIndex:d});n.append(t.render().$el);r.push(t)})});return this},getValueFromDOM:function e(){return""},events:{}});_.Fieldset=_.Dialog.extend({className:function e(){return"set-group pg-el-12"},tabPanelClassName:function e(){return _.tabClassName},fieldsetClass:_.setGroupClassName,legendClass:"badge",contentClass:_.setGroupContentClassName+" collapse show",template:{header:C.template(['<fieldset class="<%=fieldsetClass%>" <%=disabled ? "disabled" : ""%>>'," <% if (legend != false) { %>",'  <legend class="<%=legendClass%>" <%=collapse ? "data-toggle=\'collapse\'" : ""%> data-target="#<%=cId%>"><%=collapse ? "<span class=\'caret\'></span>" : "" %><%=label%></legend>'," <% } %>","</fieldset>"].join("\n")),content:C.template('  <div id="<%= cId %>" class="<%=contentClass%>"></div>')},collapse:true,render:function e(){this.cleanup();var s=this.model,a=this.$el,l=this.template,r=this.controls,o={className:C.result(this,"className"),fieldsetClass:C.result(this,"fieldsetClass"),legendClass:C.result(this,"legendClass"),contentClass:C.result(this,"contentClass"),collapse:C.result(this,"collapse")},d=this.tabIndex*100,c=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};this.$el.empty();C.each(this.schema,function(e){d++;if(!e.version_compatible||!c(e.visible,e,s)){return}if(!e.fields)return;var t=C.extend({},o,e),i=b(l["header"](t)).appendTo(a),n=b(l["content"](t)).appendTo(i);e.fields.each(function(e){var t=new(e.get("control"))({field:e,model:s,tabIndex:d});n.append(t.render().$el);r.push(t)})});return this},getValueFromDOM:function e(){return""},events:{}});_.generateGridColumnsFromModel=function(e,t,i,s,n){var a=_.generateViewSchema(e,t,i,n,true,true),l=[],r=[],o,d=0;if(C.isNull(s)||C.isUndefined(s)){o=function e(t){t.cell_priority=d;d=d+1;if(!t.headerCell&&t.cellHeaderClasses){t.headerCell=w.Extension.CustomHeaderCell}}}else if(C.isArray(s)){o=function e(t){t.cell_priority=C.indexOf(s,t.name);if(!t.headerCell&&t.cellHeaderClasses){t.headerCell=w.Extension.CustomHeaderCell}}}else if(C.isObject(s)){var c=Object.keys(s);o=function e(t){var i=t.name in s&&s[t.name],n;if(C.isNull(i)||C.isUndefined(i)){t.cell_priority=-1;return}if(C.isObject(i)){if("index"in i){t.cell_priority=i["index"];d=d>i["index"]?d+1:i["index"]}else{n=C.indexOf(c,t.name);t.cell_priority=d=n>d?n:d;d=d+1}if(!t.headerCell){if(t.cellHeaderClasses){t.headerCell=w.Extension.CustomHeaderCell}if("class"in i&&C.isString(i["class"])){t.headerCell=w.Extension.CustomHeaderCell;t.cellHeaderClasses=(t.cellHeaderClasses||"")+" "+i["class"]}}}if(C.isString(i)){n=C.indexOf(c,t.name);t.cell_priority=d=n>d?n:d;d=d+1;if(!t.headerCell){t.headerCell=w.Extension.CustomHeaderCell}t.cellHeaderClasses=(t.cellHeaderClasses||"")+" "+i}}}C.each(a,function(e){C.each(e.fields,function(e){if(!e.cell){return}o(e);if(e.cell_priority!=-1){r.push(e)}});l.push(e)});return{columns:C.sortBy(r,function(e){return e.cell_priority}),schema:l}};_.UniqueColCollectionControl=_.Control.extend({initialize:function e(){_.Control.prototype.initialize.apply(this,arguments);var t=this.field.get("uniqueCol")||[],i=this.field.get("model"),n=i.prototype.schema||i.__super__.schema,s=[],a=this;C.each(n,function(e){s.push(e.id)});if(t.length>C.intersection(s,t).length){var l="Developer: Unique columns [ "+C.difference(t,s)+" ] not found in collection model [ "+s+" ].";alert(l)}var r=a.collection=a.model.get(a.field.get("name"));if(!r){r=a.collection=new k.Browser.Node.Collection(null,{model:a.field.get("model"),silent:true,handler:a.model,top:a.model.top||a.model,attrName:a.field.get("name")});a.model.set(a.field.get("name"),r,{silent:true})}if(this.field.get("version_compatible")){a.listenTo(r,"add",a.collectionChanged);a.listenTo(r,"change",a.collectionChanged)}},cleanup:function e(){this.stopListening(this.collection,"change",this.collectionChanged);if(this.field.get("version_compatible")){this.stopListening(self.collection,"add",this.collectionChanged);this.stopListening(self.collection,"change",this.collectionChanged)}if(this.grid){this.grid.remove();delete this.grid}this.$el.empty()},collectionChanged:function e(s,t,i){var a=this.field.get("uniqueCol")||[],n=[],l=this;if(s.attributes){C.each(a,function(e){if(C.has(s.attributes,e)){n.push(e)}});if(n.length==0){return}}else{return}var r=this.model.get(this.field.get("name"));this.stopListening(r,"change",this.collectionChanged);var o=undefined,d=undefined;r.each(function(i){if(s!=i){var n=[];C.each(a,function(e){var t=s.get(e);if(!C.isUndefined(t)&&t==i.get(e)){n.push(t)}});if(n.length==a.length){o=s;d=i}}});if(o){if(i&&i.add){setTimeout(function(){r.remove(o)},0)}else{o.set(n[0],o.previous(n[0]))}if(d){var c=r.indexOf(d);if(c>-1){var u=l.grid.body.rows[c].$el;u.addClass("new");b(u).pgMakeVisible("backform-tab");setTimeout(function(){u.removeClass("new")},3e3)}}}this.listenTo(r,"change",this.collectionChanged)},render:function e(){this.undelegateEvents();this.$el.empty();var t=C.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=t.name.split("."),s=n.shift(),a=n.join("."),l=this.keyPathAccessor(i[s],a),r=C.extend(t,{rawValue:l,value:this.formatter.fromRaw(l,this.model),attributes:i,formatter:this.formatter}),o=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};C.extend(r,{disabled:t.version_compatible&&o.apply(this.field,[r.disabled,r,this.model]),visible:o.apply(this.field,[r.visible,r,this.model]),required:o.apply(this.field,[r.required,r,this.model]),canAdd:t.version_compatible&&o.apply(this.field,[r.canAdd,r,this.model]),canAddRow:r.canAddRow,canDelete:o.apply(this.field,[r.canDelete,r,this.model]),canEdit:o.apply(this.field,[r.canEdit,r,this.model])});C.extend(r,{add_label:""});if(!r.visible){return this}this.control_data=C.clone(r);var d=this.showGridControl(r);this.$el.html(d).addClass(t.name);this.updateInvalid();this.delegateEvents();return this},showGridControl:function e(r){var o=this,t=C.template(['<div class="subnode-header">','  <label class="control-label pg-el-sm-10"><%-label%></label>','  <button class="btn btn-sm-sq btn-secondary add fa fa-plus" <%=canAdd ? "" : "disabled=\'disabled\'"%> title="'+C("Add new row")+'"><%-add_label%></button>',"</div>"].join("\n")),i=b('<div class="pgadmin-control-group backgrid form-group pg-el-12 object subnode "></div>').append(t(r));if(o.grid){o.grid.remove()}if(!r.subnode){return""}var n=r.subnode.schema?r.subnode:r.subnode.prototype,s=_.generateGridColumnsFromModel(r.node_info,n,this.field.get("mode"),r.columns);if(r.mode=="properties"){b(i).find("button.add").remove()}if(!r.disabled&&r.canDelete){s.columns.unshift({name:"pg-backform-delete",label:"",cell:w.Extension.DeleteCell,editable:false,cell_priority:-1,canDeleteRow:r.canDeleteRow})}if(r.disabled==false&&r.canEdit){var a=w.Extension.ObjectCell.extend({schema:s.schema});s.columns.unshift({name:"pg-backform-edit",label:"",cell:a,cell_priority:-2,canEditRow:r.canEditRow})}var d=this.model.get(r.name);var l=function e(t){var a=this,l=t[0];this.each(function(e){if(l.model!=e){var t=a.indexOf(e);if(t>-1){var i=o.grid.body.rows[t],n=i.$el.find(".subnode-edit-in-process").parent();if(n.length>0){var s=new Event("click");n[0].dispatchEvent(s)}}}})};d.on("enteringEditMode",l,d);o.grid=new w.Grid({columns:s.columns,collection:d,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});var c=o.grid.render().$el;if(r.canDelete&&r.canEdit){b(c).find("th.pg-backform-delete").remove();b(c).find("th.pg-backform-edit").attr("colspan","2")}var u=i.append(c);var f=N;if(N.preferences_cache.length==0)f=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;var p=f.get_preferences_for_module("browser");if(p){var h=u.find(".add");b(h).attr("title",x.shortcut_title(y("Add new row"),p.add_grid_row))}if(!(r.disabled||r.canAdd==false)){u.find("button.add").first().on("click",function(e){e.preventDefault();var t=C.isFunction(r.canAddRow)?r.canAddRow.apply(o,[o.model]):true;if(t){C.each(o.grid.body.rows,function(e){var t=e.$el.find(".subnode-edit-in-process").parent();if(t.length>0){var i=new Event("click");t[0].dispatchEvent(i)}});var i=!!o.field.get("allowMultipleEmptyRows");if(!i&&d){var n=false;d.each(function(e){var t=[];C.each(e.attributes,function(e){t.push(e)});if(!C.some(t,C.identity)){n=true}});if(n){return false}}b(o.grid.body.$el.find(b("tr.new"))).removeClass("new");var s=new r.model(null,{silent:true,handler:d,top:o.model.top||o.model,collection:d,node_info:o.model.node_info});d.add(s);var a=d.indexOf(s),l=o.grid.body.rows[a].$el;l.addClass("new");try{b(l).pgMakeBackgridVisible(".backform-tab")}catch(e){b(l).pgMakeBackgridVisible(".set-group")}return false}})}return u},clearInvalid:function e(){this.$el.removeClass("subnode-error");this.$el.find(".pgadmin-control-error-message").remove();return this},updateInvalid:function e(){var t=this,i=this.model.errorModel;if(!(i instanceof c.Model))return this;this.clearInvalid();this.$el.find(".subnode-body").each(function(){var e=t.keyPathAccessor(i.toJSON(),t.field.get("name"));if(C.isEmpty(e))return;t.$el.addClass("subnode-error").append(b("<div></div>").addClass("pgadmin-control-error-message pg-el-offset-4 pg-el-8 help-block").text(e))})}});_.SubNodeCollectionControl=_.Control.extend({row:w.Row,render:function e(){var t=C.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=t.name.split("."),s=n.shift(),a=n.join("."),l=this.keyPathAccessor(i[s],a),r=C.extend(t,{rawValue:l,value:this.formatter.fromRaw(l,this.model),attributes:i,formatter:this.formatter}),o=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};C.extend(r,{disabled:o(r.disabled,r,this.model),visible:o(r.visible,r,this.model),required:o(r.required,r,this.model),canAdd:o(r.canAdd,r,this.model),canAddRow:r.canAddRow,canEdit:o(r.canEdit,r,this.model),canDelete:o(r.canDelete,r,this.model),showError:r.showError||true});var d=r.subnode==undefined?"":this.showGridControl(r);this.$el.removeClass(_.hiddenClassName);if(!r.visible)this.$el.addClass(_.hiddenClassName);this.$el.html(d).addClass(t.name);this.updateInvalid();return this},updateInvalid:function e(){var t=this;var i=this.model.errorModel;if(!(i instanceof c.Model))return this;this.clearInvalid();var n=t.field.get("name").split("."),s=n.join("."),a=t.keyPathAccessor(i.toJSON(),s);if(C.isEmpty(a))return;if(t.field.get("showError")){t.$el.addClass("subnode-error").append(b("<div></div>").addClass("pgadmin-control-error-message pg-el-offset-4 pg-el-8 help-block").text(a))}},cleanup:function e(){if(this.grid){this.grid.remove()}if(this.collection){this.collection.off("enteringEditMode")}},clearInvalid:function e(){if(this.field.get("showError")){this.$el.removeClass("subnode-error");this.$el.find(".pgadmin-control-error-message").remove()}return this},showGridControl:function e(n){var s=this;var a=this,t=["<div class='subnode-header'>","  <label class='control-label pg-el-sm-10'>"+n.label+"</label>","  <button class='btn btn-sm-sq btn-secondary add fa fa-plus' title='"+C("Add new row")+"'></button>","</div>"].join("\n"),i=b("<div class='pgadmin-control-group backgrid form-group pg-el-12 object subnode'></div>").append(t);var l=n.subnode.schema?n.subnode:n.subnode.prototype,r=_.generateGridColumnsFromModel(n.node_info,l,this.field.get("mode"),n.columns,n.schema_node);if(a.grid){a.grid.remove()}if(n.disabled||n.canAdd==false){b(i).find("button.add").remove()}if(n.disabled==false&&n.canDelete){r.columns.unshift({name:"pg-backform-delete",label:"",cell:w.Extension.DeleteCell,editable:false,cell_priority:-1,canDeleteRow:n.canDeleteRow,customDeleteMsg:n.customDeleteMsg,customDeleteTitle:n.customDeleteTitle})}if(n.disabled==false&&n.canEdit){var o=w.Extension.ObjectCell.extend({schema:r.schema}),d=a.field.has("canEdit")&&a.field.get("canEdit")||true;r.columns.unshift({name:"pg-backform-edit",label:"",cell:o,cell_priority:-2,editable:d,canEditRow:n.canEditRow})}var c=a.model.get(n.name);if(!c){c=new N.Node.Collection(null,{handler:a.model.handler||a.model,model:n.model,top:a.model.top||a.model,silent:true});a.model.set(n.name,c,{silent:true})}var u=function e(t){var a=this,l=t[0];this.each(function(e){if(l.model!=e){var t=a.indexOf(e);if(t>-1){var i=f.body.rows[t],n=i.$el.find(".subnode-edit-in-process").parent();if(n.length>0){var s=new Event("click");n[0].dispatchEvent(s)}}}})};c.on("enteringEditMode",u,c);var f=a.grid=new w.Grid({columns:r.columns,collection:c,row:this.row,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});var p=f.render().$el;if(n.canDelete&&n.canEdit){b(p).find("th.pg-backform-delete").remove();b(p).find("th.pg-backform-edit").attr("colspan","2")}var h=i.append(p);var m=N;if(N.preferences_cache.length==0)m=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;var g=m.get_preferences_for_module("browser");if(g){var v=h.find(".add");b(v).attr("title",x.shortcut_title(y("Add new row"),g.add_grid_row))}h.find("button.add").on("click",function(e){e.preventDefault();var t=C.isFunction(n.canAddRow)?n.canAddRow.apply(a,[a.model]):true;if(t){C.each(f.body.rows,function(e){var t=e.$el.find(".subnode-edit-in-process").parent();if(t.length>0){var i=new Event("click");t[0].dispatchEvent(i)}});f.insertRow({});var i=b(f.body.rows[c.length-1].$el);i.attr("class","new").on("click",function(){b(s).attr("class","editable")});try{b(i).pgMakeBackgridVisible(".backform-tab")}catch(e){b(i).pgMakeBackgridVisible(".set-group")}return false}});return h}});_.SqlTabControl=_.Control.extend({defaults:{label:"",controlsClassName:"pgadmin-controls pg-el-sm-12 SQL",extraClasses:[],helpMessage:null},template:C.template(['<div class="<%=controlsClassName%>">','  <textarea class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),initialize:function e(t){_.Control.prototype.initialize.apply(this,arguments);this.dialog=t.dialog;this.tabIndex=t.tabIndex;C.bindAll(this,"onTabChange","onPanelResized")},getValueFromDOM:function e(){return this.formatter.toRaw(this.$el.find("textarea").val(),this.model)},reflectPreferences:function e(){var t=this;if(t.sqlCtrl){var i=k.Browser.get_preferences_for_module("sqleditor");b(t.sqlCtrl.getWrapperElement()).css("font-size",s.calcFontSize(i.sql_font_size));t.sqlCtrl.setOption("tabSize",i.tab_size);t.sqlCtrl.setOption("lineWrapping",i.wrap_code);t.sqlCtrl.setOption("autoCloseBrackets",i.insert_pair_brackets);t.sqlCtrl.setOption("matchBrackets",i.brace_matching);t.sqlCtrl.refresh()}},render:function e(){if(this.sqlCtrl){this.sqlCtrl.toTextArea();delete this.sqlCtrl;this.sqlCtrl=null;this.$el.empty();this.model.off("pg-property-tab-changed",this.onTabChange,this);this.model.off("pg-browser-resized",this.onPanelResized,this)}_.Control.prototype.render.apply(this,arguments);this.sqlCtrl=p.fromTextArea(this.$el.find("textarea")[0],{lineNumbers:true,mode:"text/x-pgsql",readOnly:true,extraKeys:k.Browser.editor_shortcut_keys});this.reflectPreferences();var t=this;N.onPreferencesChange("sqleditor",function(){t.reflectPreferences()});this.model.on("pg-property-tab-changed",this.onTabChange,this);this.model.on("pg-browser-resized",this.onPanelResized,this);return this},onTabChange:function e(t){if(this.dialog&&t.shown==this.tabIndex){if(this.model.sessChanged()){if(C.size(this.model.errorModel.attributes)==0){var i=this,n=i.field.get("schema_node"),s=n.generate_url.apply(n,[null,"msql",this.field.get("node_data"),!i.model.isNew(),this.field.get("node_info")]);i.model.trigger("pgadmin-view:msql:fetching",i.method,n);b.ajax({url:s,type:"GET",cache:false,data:i.model.toJSON(true,"GET"),dataType:"json",contentType:"application/json"}).done(function(e){i.sqlCtrl.clearHistory();i.sqlCtrl.setValue(e.data)}).fail(function(){i.model.trigger("pgadmin-view:msql:error",i.method,n,arguments)}).always(function(){i.model.trigger("pgadmin-view:msql:fetched",i.method,n,arguments)})}else{this.sqlCtrl.clearHistory();this.sqlCtrl.setValue("-- "+y("Definition incomplete."))}}else{this.sqlCtrl.clearHistory();this.sqlCtrl.setValue("-- "+y("No updates."))}this.sqlCtrl.refresh.apply(this.sqlCtrl)}},onPanelResized:function e(t){if(t&&t.container){var i=t.container.find(".backform-tab > .tab-content").first(),n=i.find("div[role=tabpanel].tab-pane.SQL");if(n.hasClass("active")){n.find(".CodeMirror").css("cssText","height: "+(i.height()+8)+"px !important;")}}},remove:function e(){if(this.sqlCtrl){this.sqlCtrl.toTextArea();delete this.sqlCtrl;this.sqlCtrl=null;this.$el.empty()}this.model.off("pg-property-tab-changed",this.onTabChange,this);this.model.off("pg-browser-resized",this.onPanelResized,this);_.Control.__super__.remove.apply(this,arguments)}});_.NumericControl=_.InputControl.extend({defaults:{type:"number",label:"",min:undefined,max:undefined,maxlength:255,extraClasses:[],helpMessage:null},template:C.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input type="<%=type%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" min="<%=min%>" max="<%=max%>"maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n"))});_.generateViewSchema=function(o,d,c,u,f,e,t){var i=d&&d.prototype||d,n=t||i&&i.schema,s=[],p={};if(n&&C.isArray(n)){var h=h=function e(t){return t&&i[t]&&typeof i[t]=="function"?i[t]:t};var m={},g=o&&"server"in o&&N.serverInfo&&N.serverInfo[o.server._id],v=o&&"catalog"in o,b;C.each(n,function(e){if(e.type=="group"){var t=true;b=C.isUndefined(g)?true:(C.isUndefined(e.server_type)?true:g.type in e.server_type)&&(C.isUndefined(e.min_version)?true:g.version>=e.min_version)&&(C.isUndefined(e.max_version)?true:g.version<=e.max_version);if(e.mode&&C.isObject(e.mode))t=C.indexOf(e.mode,c)>-1;if(t)t=h(e.visible);p[e.id]={label:e.label||e.id,version_compatible:b,visible:t,tabPanelCodeClass:""};return}if(!e.mode||e&&e.mode&&C.isObject(e.mode)&&C.indexOf(e.mode,c)!=-1){var i=e.group||y("General"),n=e.control||_.getMappedControl(e.type,c),s=e.cell||_.getMappedControl(e.type,"cell");if(n==null){return}m[i]=m[i]||[];b=C.isUndefined(g)?true:(C.isUndefined(e.server_type)?true:g.type in e.server_type)&&(C.isUndefined(e.min_version)?true:g.version>=e.min_version)&&(C.isUndefined(e.max_version)?true:g.version<=e.max_version);var a=c=="properties"||!b||v,l=e.node&&C.isString(e.node)&&e.node in N.Nodes&&N.Nodes[e.node]||u;var r=C.extend(C.clone(e),{name:e.id,disabled:a?true:h(e.disabled),editable:C.isUndefined(e.editable)?k.editableCell:h(e.editable),subnode:C.isString(e.model)&&e.model in N.Nodes?N.Nodes[e.model].model:e.model,canAdd:a?false:h(e.canAdd),canAddRow:a?false:h(e.canAddRow),canEdit:a?false:h(e.canEdit),canDelete:a?false:h(e.canDelete),canEditRow:a?false:h(e.canEditRow),canDeleteRow:a?false:h(e.canDeleteRow),transform:h(e.transform),mode:c,control:n,cell:s,node_info:o,schema_node:l,visible:h(e.visible),node:u,node_data:f,version_compatible:b});delete r.id;m[i].push(r);if(e.type=="nested"){delete r.name;delete r.cell;r.schema=_.generateViewSchema(o,d,c,u,f,true,e.schema);r.control=r.control||"tab"}}});if(C.isEmpty(m)){return null}if(!e&&u&&u.hasSQL&&(c=="create"||c=="edit")){m[y("SQL")]=[{name:"sql",visible:true,disabled:false,type:"text",control:"sql-tab",node_info:o,schema_node:u,node_data:f}]}C.each(m,function(e,t){var i=C.pluck(e,"tabPanelCodeClass");if(i){i=i.join(" ").trim()}s.push(C.extend(C.defaults(p[t]||{label:t,tabPanelCodeClass:i},{version_compatible:true,visible:true}),{fields:e}))})}return s};var n=function e(){};C.extend(n.prototype,{fromRaw:function e(t){return encodeURIComponent(t)},toRaw:function e(t){if(C.isArray(t)){var i=C.map(t,encodeURIComponent);return C.map(i,decodeURIComponent)}else{if(!C.isNull(t)&&!C.isUndefined(t)){return decodeURIComponent(t)}else{return null}}}});_.Select2Control=_.SelectControl.extend({defaults:C.extend({},_.SelectControl.prototype.defaults,{select2:{first_empty:true,multiple:false,emptyOptions:false,preserveSelectionOrder:false,isDropdownParent:false}}),events:function e(){return C.extend({},_.SelectControl.prototype.events,{"select2:select":"onSelect"})},onSelect:function e(t){var i=this.field.get("select2");if(!C.isUndefined(i)&&!C.isNull(i)&&i.multiple&&i.preserveSelectionOrder){var n=t.params.data.element;var s=b(n);s.detach();b(this.$sel).append(s);b(this.$sel).trigger("change")}},formatter:n,template:C.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">'," <select class=\"<%=Backform.controlClassName%> <%=extraClasses.join(' ')%>\"",'  name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%>','  <%=required ? "required" : ""%><%= select2.multiple ? " multiple>" : ">" %>','  <%=select2.first_empty ? " <option></option>" : ""%>',"  <% for (var i=0; i < options.length; i++) {%>","   <% var option = options[i]; %>","   <option ","    <% if (option.image) { %> data-image=<%=option.image%> <%}%>","    value=<%- formatter.fromRaw(option.value) %>",'    <% if (option.selected) {%>selected="selected"<%} else {%>','    <% if (!select2.multiple && option.value === rawValue) {%>selected="selected"<%}%>','    <% if (select2.multiple && rawValue && rawValue.indexOf(option.value) != -1){%>selected="selected" data-index="rawValue.indexOf(option.value)"<%}%>',"    <%}%>",'    <%= disabled ? "disabled" : ""%>><%-option.label%></option>',"  <%}%>"," </select>"," <% if (helpMessage && helpMessage.length) { %>",' <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>'," <% } %>","</div>"].join("\n")),render:function e(){if(this.$sel&&this.$sel.select2&&this.$sel.select2.hasOwnProperty("destroy")){this.$sel.select2("destroy")}var t=C.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=t.name.split("."),s=n.shift(),a=n.join("."),l=this.keyPathAccessor(i[s],a),r=C.extend(t,{rawValue:l,value:this.formatter.fromRaw(l,this.model),attributes:i,formatter:this.formatter}),o=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};r.select2=r.select2||{};C.defaults(r.select2,this.defaults.select2,{first_empty:true,multiple:false,emptyOptions:false,preserveSelectionOrder:false,isDropdownParent:false});C.extend(r,{disabled:o(r.disabled,r,this.model),visible:o(r.visible,r,this.model),required:o(r.required,r,this.model)});if(C.isFunction(r.options)){try{r.options=r.options(this)}catch(e){r.options=[];this.model.trigger("pgadmin-view:transform:error",this.model,this.field,e)}}this.$el.removeClass(_.hiddenClassName);if(!r.visible)this.$el.addClass(_.hiddenClassName);this.$el.html(this.template(r)).addClass(t.name);var d=C.extend({disabled:r.disabled},t.select2,{options:this.field.get("options")||this.defaults.options});if(r.select2.isDropdownParent){d.dropdownParent=r.select2.dropdownParent||this.$el}if(r.disabled||r.mode==="properties"){d["placeholder"]=""}if(r.select2.tags&&r.select2.emptyOptions){d.data=r.rawValue}this.$sel=this.$el.find("select").select2(d);if(r.select2.tags&&r.select2.emptyOptions){this.$sel.val(r.rawValue);this.$sel.trigger("change.select2");this.$sel.on("select2:unselect",function(e){b(this).find('option[value="'+e.params.data.text.replace("'","\\'").replace('"','\\"')+'"]').remove();b(this).trigger("change.select2");if(b(this).val()==null){b(this).empty()}})}if(this.$sel){this.$sel.data("select2").on("keypress",function(e){var t=this;if(e.which===9&&t.isOpen()){e.preventDefault();t.trigger("results:select",{})}})}this.updateInvalid();return this},getValueFromDOM:function e(){var t=_.SelectControl.prototype.getValueFromDOM.apply(this,arguments),i=C.extend({},this.field.get("select2")||this.defaults.select2);if(i.multiple&&t==null){return[]}return t}});_.FieldsetControl=_.Fieldset.extend({initialize:function e(t){_.Control.prototype.initialize.apply(this,arguments);_.Dialog.prototype.initialize.apply(this,[{schema:t.field.get("schema")}]);this.dialog=t.dialog;this.tabIndex=t.tabIndex;this.contentClass=t.field.get("contentClass")?t.field.get("contentClass"):"";var i=this.field.get("deps");var n=this;if(i&&C.isArray(i)){C.each(i,function(e){var t=e.split("."),i=t.shift();n.listenTo(n.model,"change:"+i,n.render)})}},orig_render:_.Fieldset.prototype.render,render:function e(){var t=C.defaults(this.field.toJSON(),this.defaults),i=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};if(!t.version_compatible||!i(t.visible,t,this.model)){this.cleanup();this.$el.empty()}else{this.orig_render.apply(this,arguments)}return this},formatter:function e(){},cleanup:function e(){_.Fieldset.prototype.cleanup.apply(this)},remove:function e(){_.Control.prototype.remove.apply(this,arguments);_.Dialog.prototype.remove.apply(this,arguments)},className:function e(){return"set-group"},tabPanelClassName:function e(){return _.tabClassName},fieldsetClass:"inline-fieldset",legendClass:"",collapse:false});_.TabControl=_.FieldsetControl.extend({tagName:"div",className:"inline-tab-panel",tabPanelClassName:"inline-tab-panel",tabPanelExtraClasses:"",initialize:function e(t){_.FieldsetControl.prototype.initialize.apply(this,arguments);this.tabIndex=(t.tabIndex||parseInt(Math.random()*1e3))+1;if(t.field.get("tabPanelExtraClasses")){this.tabPanelExtraClasses=t.field.get("tabPanelExtraClasses")}this.tabPanelClassName=this.tabPanelClassName+" "+this.tabPanelExtraClasses},orig_render:_.Dialog.prototype.render,template:_.Dialog.prototype.template});_.PlainFieldsetControl=_.FieldsetControl.extend({initialize:function e(){_.FieldsetControl.prototype.initialize.apply(this,arguments)},template:{header:C.template(['<fieldset class="<%=fieldsetClass%>" <%=disabled ? "disabled" : ""%>>'," <% if (legend != false) { %>",'  <div><legend class="<%=legendClass%>" <%=collapse ? "data-toggle=\'collapse\'" : ""%> data-target="#<%=cId%>"><%=collapse ? "<span class=\'caret\'></span>" : "" %></legend></div>'," <% } %>","</fieldset>"].join("\n")),content:C.template('  <div id="<%= cId %>" class="<%=contentClass%>"></div>')},fieldsetClass:"inline-fieldset-without-border",legend:false});_.SqlFieldControl=_.TextareaControl.extend({defaults:{label:"",extraClasses:[],helpMessage:null,maxlength:4096,rows:undefined},template:C.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>',"<div class=\"<%=Backform.controlsClassName%> sql_field_layout <%=extraClasses.join(' ')%>\">","  <textarea ",'    class="<%=Backform.controlClassName%> " name="<%=name%>"','    maxlength="<%=maxlength%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%>',"    rows=<%=rows%>",'    <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),initialize:function e(){_.TextareaControl.prototype.initialize.apply(this,arguments);this.sqlCtrl=null;C.bindAll(this,"onFocus","onBlur","refreshTextArea")},getValueFromDOM:function e(){return this.sqlCtrl.getValue()},reflectPreferences:function e(){var t=this;if(t.sqlCtrl){var i=window.opener?window.opener.pgAdmin.Browser:window.top.pgAdmin.Browser;var n=i.get_preferences_for_module("sqleditor");b(t.sqlCtrl.getWrapperElement()).css("font-size",s.calcFontSize(n.sql_font_size));t.sqlCtrl.setOption("indentWithTabs",!n.use_spaces);t.sqlCtrl.setOption("indentUnit",n.tab_size);t.sqlCtrl.setOption("tabSize",n.tab_size);t.sqlCtrl.setOption("lineWrapping",n.wrap_code);t.sqlCtrl.setOption("autoCloseBrackets",n.insert_pair_brackets);t.sqlCtrl.setOption("matchBrackets",n.brace_matching);setTimeout(function(){t.sqlCtrl.refresh()},500)}},render:function e(){if(this.sqlCtrl){this.model.off("pg-property-tab-changed",this.refreshTextArea,this);this.sqlCtrl.off("focus",this.onFocus);this.sqlCtrl.off("blur",this.onBlur);this.sqlCtrl.toTextArea();delete this.sqlCtrl;this.sqlCtrl=null;this.$el.empty()}_.TextareaControl.prototype.render.apply(this,arguments);var t=C.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=t.name.split("."),s=n.shift(),a=n.join("."),l=this.keyPathAccessor(i[s],a),r=C.extend(t,{rawValue:l,value:this.formatter.fromRaw(l,this.model),attributes:i,formatter:this.formatter}),o=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};var d=o(r.disabled,r,this.model),c=o(r.visible,r,this.model),u=this;u.sqlCtrl=p.fromTextArea(u.$el.find("textarea")[0],{lineNumbers:true,mode:"text/x-pgsql",extraKeys:k.Browser.editor_shortcut_keys});u.reflectPreferences();N.onPreferencesChange("sqleditor",function(){u.reflectPreferences()});if(d){u.sqlCtrl.setOption("readOnly",true);var f=u.sqlCtrl.getWrapperElement();if(f){f.className+=" cm_disabled hide-cursor-workaround"}}if(!c)u.$el.addClass(_.hiddenClassName);u.model.on("pg-property-tab-changed",this.refreshTextArea,this);this.sqlCtrl.on("focus",this.onFocus);this.sqlCtrl.on("blur",this.onBlur);setTimeout(function(){u.refreshTextArea.apply(u)},0);return u},onFocus:function e(){var t=this.$el.find(".pgadmin-controls").first();if(!t.hasClass("focused"))t.addClass("focused")},onBlur:function e(){this.$el.find(".pgadmin-controls").first().removeClass("focused")},refreshTextArea:function e(){if(this.sqlCtrl){this.sqlCtrl.refresh()}},remove:function e(){if(this.sqlCtrl){this.sqlCtrl.off("focus",this.onFocus);this.sqlCtrl.off("blur",this.onBlur);delete this.sqlCtrl;this.sqlCtrl=null;this.$el.empty()}this.model.off("pg-property-tab-changed",this.refreshTextArea,this);_.TextareaControl.prototype.remove.apply(this,arguments)}});_.SqlCodeControl=_.SqlFieldControl.extend({template:C.template(["<div class=\"pgadmin-controls pg-el-12 <%=extraClasses.join(' ')%>\">","  <textarea ",'    class="<%=Backform.controlClassName%> " name="<%=name%>"','    maxlength="<%=maxlength%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%>',"    rows=<%=rows%>",'    <%=required ? "required" : ""%>><%-value%></textarea>',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n"))});_.NoteControl=_.Control.extend({defaults:{label:y("Note"),text:"",extraClasses:["pg-el-12","d-flex"],noteClass:"backform-note",faIcon:"fa-file-text-o",faExtraClass:"fa-rotate-180 fa-flip-vertical",iconWidthClass:"col-0 pr-2",textWidthClass:"col-sm"},template:C.template(["<div class=\"<%=noteClass%> <%=extraClasses.join(' ')%>\">",'  <div class="icon <%=iconWidthClass%>">','    <i class="fa <%=faIcon%> <%=faExtraClass%>" aria-hidden="true"></i>',"  </div>",'  <div class="<%=textWidthClass%>">',"    <span><%=text%></span>","  </div>","</div>"].join("\n"))});_.FileControl=_.InputControl.extend({defaults:{type:"text",label:"",min:undefined,max:undefined,maxlength:255,extraClasses:[],dialog_title:"",btn_primary:"",helpMessage:null,dialog_type:"select_file"},initialize:function e(){_.InputControl.prototype.initialize.apply(this,arguments)},template:C.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','<div class="input-group">','<input type="<%=type%>" class="form-control <%=extraClasses.join(\' \')%>" name="<%=name%>" min="<%=min%>" max="<%=max%>"maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />','<div class="input-group-append">','<button class="btn btn-secondary fa fa-ellipsis-h select_item" <%=disabled ? "disabled" : ""%> ></button>',"</div>","</div>","<% if (helpMessage && helpMessage.length) { %>",'<span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"<% } %>","</div>"].join("\n")),events:function e(){return C.extend({},_.InputControl.prototype.events,{"click .select_item":"onSelect"})},onSelect:function e(){var t=this.field.get("dialog_type"),i=this.field.get("supp_types"),n=this.field.get("btn_primary"),s=this.field.get("dialog_title"),a={supported_types:i,dialog_type:t,dialog_title:s,btn_primary:n};k.FileManager.init();k.FileManager.show_dialog(a);this.listen_file_dlg_events()},storage_dlg_hander:function e(t){var i=this.field.get("name").split("."),n=i.shift();this.remove_file_dlg_event_listeners();this.model.set(n,decodeURI(t));this.$el.find("input[type=text]").focus()},storage_close_dlg_hander:function e(){this.remove_file_dlg_event_listeners()},listen_file_dlg_events:function e(){k.Browser.Events.on("pgadmin-storage:finish_btn:"+this.field.get("dialog_type"),this.storage_dlg_hander,this);k.Browser.Events.on("pgadmin-storage:cancel_btn:"+this.field.get("dialog_type"),this.storage_close_dlg_hander,this)},remove_file_dlg_event_listeners:function e(){k.Browser.Events.off("pgadmin-storage:finish_btn:"+this.field.get("dialog_type"),this.storage_dlg_hander,this);k.Browser.Events.off("pgadmin-storage:cancel_btn:"+this.field.get("dialog_type"),this.storage_close_dlg_hander,this)},clearInvalid:function e(){_.InputControl.prototype.clearInvalid.apply(this,arguments);this.$el.removeClass("pgadmin-file-has-error");return this},updateInvalid:function e(){_.InputControl.prototype.updateInvalid.apply(this,arguments);this.$el.addClass("pgadmin-file-has-error")},disable_button:function e(){this.$el.find("button.select_item").attr("disabled","disabled")},enable_button:function e(){this.$el.find("button.select_item").removeAttr("disabled")}});_.DatetimepickerControl=_.InputControl.extend({defaults:{type:"text",label:"",options:{format:"YYYY-MM-DD HH:mm:ss Z",icons:{clear:"fa fa-trash"},buttons:{showToday:true},toolbarPlacement:"top",widgetPositioning:{horizontal:"auto",vertical:"bottom"},keepOpen:false},placeholder:"YYYY-MM-DD HH:mm:ss Z",extraClasses:[],helpMessage:null},events:{"blur input":"onChange","change input":"onChange","changeDate input":"onChange","focus input":"clearInvalid","focusout input":"closePicker","change.datetimepicker":"onChange",click:"togglePicker"},togglePicker:function e(){if(this.has_datepicker){this.$el.find("input").datetimepicker("toggle")}},closePicker:function e(){if(this.has_datepicker){this.$el.find("input").datetimepicker("hide")}},template:C.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="input-group  <%=Backform.controlsClassName%>">',' <input type="text" class="<%=Backform.controlClassName%> datetimepicker-input <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> data-toggle="datetimepicker"/>',' <div class="input-group-append">','   <span class="input-group-text fa fa-calendar"></span>'," </div>","</div>","<% if (helpMessage && helpMessage.length) { %>",'<div class="<%=Backform.helpBlockControlClass%>">',' <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"</div>","<% } %>"].join("\n")),render:function e(){var t=C.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=t.name.split("."),s=n.shift(),a=n.join("."),l=this.keyPathAccessor(i[s],a),r=C.extend(t,{rawValue:l,value:this.formatter.fromRaw(l,this.model),attributes:i,formatter:this.formatter}),o=function e(t,i){return C.isFunction(t)?!!t(i):!!t};C.extend(r,{disabled:o(r.disabled,this.model),visible:o(r.visible,this.model),required:o(r.required,this.model)});if(!r.disabled){r.placeholder=r.placeholder||this.defaults.placeholder}if(this.has_datepicker)this.$el.find("input").datetimepicker("destroy");this.$el.empty();this.$el.removeClass(_.hiddenClassName);this.$el.html(this.template(r)).addClass(t.name);if(!r.visible){this.has_datepicker=false;this.$el.addClass(_.hiddenClassName)}else{this.has_datepicker=true;var d=this;if(!C.isUndefined(r.value)&&!C.isNull(r.value)&&r.value.toLowerCase()==="infinity"){r.value=null}this.$el.find("input").first().datetimepicker(C.extend({keyBinds:{enter:function e(t){var i=this;if(t){setTimeout(function(){i.toggle();d.$el.find("input").first().trigger("blur")},10)}else{setTimeout(function(){i.toggle()},10)}},tab:function e(t){if(!t){setTimeout(function(){d.$el.find("input").first().trigger("blur")},10)}},escape:function e(t){if(t){var i=this;setTimeout(function(){i.toggle();d.$el.find("input").first().trigger("blur")},10)}}}},this.defaults.options,this.field.get("options"),{date:r.value,minDate:r.value}))}this.updateInvalid();return this},clearInvalid:function e(){_.InputControl.prototype.clearInvalid.apply(this,arguments);this.$el.removeClass("pgadmin-datepicker-has-error");return this},updateInvalid:function e(){_.InputControl.prototype.updateInvalid.apply(this,arguments);this.$el.addClass("pgadmin-datepicker-has-error")},cleanup:function e(){if(this.has_datepicker)this.$el.find("input").datetimepicker("destroy");this.$el.empty()}});_.ColorControl=_.InputControl.extend({defaults:{label:"",extraClasses:[],helpMessage:null,showButtons:false,showPalette:true,allowEmpty:true,colorFormat:"hex",defaultColor:""},template:C.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" value="<%-value%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),render:function e(){if(this.$picker&&this.$picker.hasOwnProperty("destroy")){this.$picker("destroy")}var t=C.defaults(this.field.toJSON(),this.defaults),i=this.model.toJSON(),n=t.name.split("."),s=n.shift(),a=n.join("."),l=this.keyPathAccessor(i[s],a),r=C.extend(t,{rawValue:l,value:this.formatter.fromRaw(l,this.model),attributes:i,formatter:this.formatter}),o=function e(t,i,n){return C.isFunction(t)?!!t.apply(i,[n]):!!t};C.extend(r,{disabled:o(r.disabled,r,this.model),visible:o(r.visible,r,this.model),required:o(r.required,r,this.model)});this.$el.empty();if(!r.visible)this.$el.addClass(_.hiddenClassname);this.$el.html(this.template(r)).addClass(t.name);this.$picker=this.$el.find("input").spectrum({allowEmpty:r.allowEmpty,preferredFormat:r.colorFormat,disabled:r.disabled,hideAfterPaletteSelect:true,clickoutFiresChange:true,showButtons:r.showButtons,showPaletteOnly:r.showPalette,togglePaletteOnly:r.showPalette,togglePaletteMoreText:y("More"),togglePaletteLessText:y("Less"),color:r.value||r.defaultColor,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]]});this.updateInvalid();return this}});var l=_.KeyCodeControlFormatter=function(){};C.extend(l.prototype,{fromRaw:function e(t){return t["char"]},toRaw:undefined});_.KeyCodeControl=_.InputControl.extend({defaults:C.defaults({escapeKeyCodes:[16,17,18,27]},_.InputControl.prototype.defaults),events:{"keydown input":"onkeyDown","keyup input":"preventEvent","focus select":"clearInvalid"},formatter:l,preventEvent:function e(t){var i=t.which||t.keyCode,n=C.defaults(this.field.toJSON(),this.defaults);if(n.escapeKeyCodes.indexOf(i)!=-1){return}t.preventDefault();t.stopImmediatePropagation();t.stopPropagation()},template:C.template(['<label class="<%=Backform.controlLabelClassName%> keyboard-shortcut-label"><%=label%></label>','<div class="<%=Backform.controlsClassName%>">','  <input type="<%=type%>" class="<%=Backform.controlClassName%> <%=extraClasses.join(\' \')%>" name="<%=name%>" oncopy="return false; oncut="return false; onpaste="return false;" maxlength="<%=maxlength%>" value="<%-value%>" placeholder="<%-placeholder%>" <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"  <% if (helpMessage && helpMessage.length) { %>",'    <span class="<%=Backform.helpMessageClassName%>"><%=helpMessage%></span>',"  <% } %>","</div>"].join("\n")),onkeyDown:function e(t){var i=this,n=this.model,s=this.field.get("name").split("."),a=s.shift(),l={},r=t.which||t.keyCode,o,d=C.defaults(this.field.toJSON(),this.defaults);if(d.escapeKeyCodes.indexOf(r)!=-1){return}if(this.model.errorModel instanceof c.Model){this.model.errorModel.unset(a)}o=y(t.key);if(r==32){o=y("Space")}l={key_code:t.which||t.keyCode,char:o};this.stopListening(this.model,"change:"+a,this.render);n.set(a,l);this.listenTo(this.model,"change:"+a,this.render);setTimeout(function(){i.$el.find("input").val(o)});t.preventDefault()},keyPathAccessor:function e(t,i){var n=t;i=i.split(".");for(var s=0;s<i.length;s++){if(C.isNull(n))return null;if(C.isEmpty(i[s]))continue;if(!C.isUndefined(n[i[s]]))n=n[i[s]]}return n}});_.KeyboardShortcutControl=_.Control.extend({initialize:function e(){_.Control.prototype.initialize.apply(this,arguments);var t=this.field.get("fields");if(t==null||t==undefined){throw new ReferenceError('"fields" not found in keyboard shortcut')}this.innerModel=new c.Model;this.controls=[]},cleanup:function e(){this.stopListening(this.innerModel,"change",this.onInnerModelChange);C.each(this.controls,function(e){e.remove()});this.controls.length=0},template:C.template(['<label class="<%=Backform.controlLabelClassName%>"><%=label%></label>','<div class="<%=Backform.controlsClassName%> d-flex flex-row">',"</div>"].join("\n")),onInnerModelChange:function e(){var t=this.field.get("name"),i=b.extend(true,{},this.model.get(t));this.stopListening(this.model,"change:"+t,this.render);this.model.set(t,b.extend(true,i,this.innerModel.toJSON()));this.listenTo(this.model,"change:"+t,this.render)},render:function e(){this.cleanup();this.$el.empty();var s=this,t={},i=C.defaults(this.field.toJSON(),this.defaults),n=s.model.get(i["name"]),a=i["fields"];this.$el.html(s.template(i)).addClass(i.name);var l=b(s.$el.find(".pgadmin-controls"));C.each(a,function(e){t[e["name"]]=n[e["name"]]});s.innerModel.set(t);s.listenTo(s.innerModel,"change",s.onInnerModelChange);C.each(a,function(e){var t=new _.Field(C.extend({},{id:e["name"],name:e["name"],control:e["type"]=="checkbox"?"checkboxWithBox":e["type"],label:e["label"]})),i=new(t.get("control"))({field:t,model:s.innerModel});i.render();if(e["type"]=="checkbox"){var n=i.$el.find("label.control-label").text().trim();if(n.length<=0){i.$el.find("label.control-label").remove()}if(e["name"]=="alt"){l.append(b('<div class="pg-el-sm-3 pg-el-12"></div>').append(i.$el))}else{l.append(b('<div class="pg-el-sm-2 pg-el-12"></div>').append(i.$el))}}else{l.append(b('<div class="pg-el-sm-5 pg-el-12"></div>').append(i.$el))}s.controls.push(i)});return s},remove:function e(){this.cleanup();_.Control.prototype.remove.apply(this,arguments)}});_.CheckboxWithBoxControl=_.CheckboxControl.extend({events:C.extend({},_.CheckboxControl.prototype.events,{"click button":"onButtonClick"}),template:C.template(['<label class="<%=Backform.controlLabelClassName%>"><%=controlLabel%></label>','<div class="<%=Backform.controlContainerClassName%>">','  <button class="btn btn-secondary btn-checkbox">','    <input type="<%=type%>" class="<%=extraClasses.join(\' \')%>" id="<%=id%>" name="<%=name%>" <%=value ? "checked=\'checked\'" : ""%> <%=disabled ? "disabled" : ""%> <%=required ? "required" : ""%> />',"    <%=label%>","  </button>","</div>"].join("\n")),onButtonClick:function e(t){if(t.target.nodeName!=="BUTTON")return;var i=this.$el.find("input[type=checkbox]");i.prop("checked",!i.prop("checked"))}});return _}.apply(s,t),i!==undefined&&(n.exports=i))}).call(this,a(3))},7:function(e,t,i){"use strict";var n,s;!(n=[i(2),i(0),i(1),i(8),i(3),i(9),i(18),i(22),i(19),i(81),i(6),i(12),i(27),i(82)],s=function(y,C,_,w,x,e,k,N,E,o){var T=x.Browser=x.Browser||{};if(T.Collection)return T.Collection;T.Collection=function(){};_.extend(T.Collection,_.clone(T.Node),{Init:function e(){if(this.node_initialized)return;this.node_initialized=true;x.Browser.add_menus([{name:"refresh",node:this.type,module:this,applies:["object","context"],callback:"refresh",priority:1,label:y("Refresh..."),icon:"fa fa-refresh"}]);if(x.DataGrid&&x.unsupported_nodes){if(_.indexOf(x.unsupported_nodes,this.type)==-1){x.Browser.add_menus([{name:"show_query_tool",node:this.type,module:this,applies:["context"],callback:"show_query_tool",priority:998,label:y("Query Tool..."),icon:"fa fa-bolt"}])}}},hasId:false,is_collection:true,collection_node:true,hasCollectiveStatistics:true,canDrop:true,canDropCascade:true,showProperties:function e(n,t,i){var a=this,s=i.$container.find(".obj_properties").first(),l=s.data("obj-view"),r=C("<div></div>").addClass("pg-prop-content col-12 has-pg-prop-btn-group"),o=T.Nodes[a.node],d="",c=this.generate_url(n,"properties",t),u=this.getTreeNodeHierarchy.apply(this,[n]),f=N.generateGridColumnsFromModel(u,o.model,"properties",a.columns),p=function(e,t,i){if(e&&_.isArray(e)&&e.length>0){var n=C('<div class="pg-prop-btn-group"></div>'),s=_.template(['<button tabindex="0" type="<%= type %>" ',"class=\"btn <%=extraClasses.join(' ')%>\"",'<% if (disabled) { %> disabled="disabled"<% } %> title="<%-tooltip%>">','<span class="<%= icon %>"></span><% if (label != "") { %>&nbsp;<%-label%><% } %></button>'].join(" "));if(t=="header"){n.appendTo(a.header)}else{n.appendTo(a.footer)}if(i){n.addClass(i)}_.each(e,function(e){if(!e.icon){e.icon=""}var t=C(s(e));n.append(t);e.register(t)});return n}return null}.bind(i);a.collection=new(o.Collection.extend({url:c,model:o.model}));if((_.isFunction(a.canDrop)?a.canDrop.apply(a,[t,n]):a.canDrop)||(_.isFunction(a.canDropCascade)?a.canDropCascade.apply(a,[t,n]):a.canDropCascade)){f.columns.unshift({name:"oid",cell:E.Extension.SelectRowCell.extend({initialize:function e(t){this.column=t.column;if(!(this.column instanceof E.Column)){this.column=new E.Column(this.column)}var i=this.column,n=this.model,s=this.$el;this.listenTo(i,"change:renderable",function(e,t){s.toggleClass("renderable",t)});if(E.callByNeed(i.renderable(),i,n))s.addClass("renderable width_percent_3");this.listenTo(n,"backgrid:select",this.toggleCheckbox)},toggleCheckbox:function e(t,i){if(this.checkbox().prop("disabled")===false){this.checkbox().prop("checked",i).change()}},render:function e(){var t=this.model.toJSON();if("canDrop"in t&&t.canDrop===false)this.$el.empty().append('<input tabindex="-1" type="checkbox" disabled="disabled"/>');else this.$el.empty().append('<input tabindex="-1" type="checkbox" />');this.delegateEvents();return this}}),headerCell:E.Extension.SelectAllHeaderCell})}a.grid=new E.Grid({emptyText:"No data found",columns:f.columns,collection:a.collection,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});var h={remove:function e(){if(this.grid){if(this.grid.collection){this.grid.collection.reset({silent:true});delete this.grid.collection}delete this.grid;this.grid=null}},grid:a.grid};if(l){if(_.isEqual(C(i).data("node-prop"),c)){return}C(i).data("node-prop",c);s.data("obj-view",null)}s.empty();s.data("obj-view",h);d='<div class="alert alert-info pg-panel-message pg-panel-properties-message">'+y("Retrieving data from the server...")+"</div>";d=C(d).appendTo(s);a.header=C("<div></div>").addClass("pg-prop-header");var m=[];m.push({label:"",type:"delete",tooltip:y("Delete/Drop"),extraClasses:["btn-secondary m-1","delete_multiple"],icon:"fa fa-lg fa-trash-o",disabled:_.isFunction(a.canDrop)?!a.canDrop.apply(self,[t,n]):!a.canDrop,register:function e(t){t.on("click",function(){b("drop")})}});m.push({label:"",type:"delete",tooltip:y("Drop Cascade"),extraClasses:["btn-secondary m-1","delete_multiple_cascade"],icon:"icon-delete_multiple_cascade",disabled:_.isFunction(a.canDropCascade)?!a.canDropCascade.apply(self,[t,n]):!a.canDropCascade,register:function e(t){t.on("click",function(){b("dropCascade")})}});p(m,"header","pg-prop-btn-group-above");r.append('<div class="pg-prop-coll-container"></div>');r.find(".pg-prop-coll-container").append(a.grid.render().$el);var g;var v=function i(){C.ajax({url:c,type:"GET",beforeSend:function e(t){t.setRequestHeader(x.csrf_token_header,x.csrf_token);g=setTimeout(function(){d.text(y("Retrieving data from the server..."));d.removeClass("d-none");if(self.grid){self.grid.remove()}},1e3)}}).done(function(e){clearTimeout(g);if(_.isUndefined(a.grid)||_.isNull(a.grid))return;a.data=e;if(a.data.length>0){if(!d.hasClass("d-none")){d.addClass("d-none")}a.header.appendTo(s);s.append(r);C(".pg-prop-content").on("scroll",a.__loadMoreRows.bind(a));a.collection.reset(a.data.splice(0,50))}else{C(".pg-prop-content").off("scroll",a.__loadMoreRows);d.text(y("No properties are available for the selected object."))}}).fail(function(e,t){T.Events.trigger("pgadmin:node:retrieval:error","properties",e,t.message,n,a);if(!k.pgHandleItemError(e,t.message,{item:n,info:u})){k.pgNotifier(t,e,w(y("Error retrieving properties - %s")).sprintf(t.message||a.label).value(),function(e){if(e==="CRYPTKEY_SET"){i()}else{console.warn(arguments)}})}d.text(y("Failed to retrieve data from the server."))})};v();var b=function(i){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;var t=this.grid.getSelectedModels(),n=[],s=T.tree.selected(),a=s?T.tree.itemData(s):null,l=T.Nodes[a._type],r=undefined,o=undefined,d=undefined;_.each(t,function(e){n.push(e.id)});if(n.length===0){k.alert(y("Drop Multiple"),y("Please select at least one object to delete."));return}if(i==="dropCascade"){r=l.generate_url(s,"delete"),o=y("Are you sure you want to drop all the selected objects and all the objects that depend on them?"),d=y("DROP CASCADE multiple objects?")}else{r=l.generate_url(s,"drop");o=y("Are you sure you want to drop all the selected objects?");d=y("DROP multiple objects?")}var c=function e(){C.ajax({url:r,type:"DELETE",data:JSON.stringify({ids:n}),contentType:"application/json; charset=utf-8"}).done(function(e){if(e.success==0){T.report_error(e.errormsg,e.info)}else{C(T.panels["properties"].panel).removeData("node-prop");T.Events.trigger("pgadmin:browser:tree:refresh",s||T.tree.selected(),{success:function e(){l.callbacks.selected.apply(l,[s])}})}return true}).fail(function(e,t){k.pgNotifier(t,e,w(y("Error dropping %s")).sprintf(a._label.toLowerCase()).value(),function(e){if(e=="CRYPTKEY_SET"){b(i,false)}else{C(T.panels["properties"].panel).removeData("node-prop");T.Events.trigger("pgadmin:browser:tree:refresh",s||T.tree.selected(),{success:function e(){l.callbacks.selected.apply(l,[s])}})}})})};if(e){k.confirm(d,o,c,null).show()}else{c()}return}.bind(a)},__loadMoreRows:function e(t){var i=t.currentTarget;if(i.scrollHeight-10<i.scrollTop+i.offsetHeight){if(this.data.length>0){this.collection.add(this.data.splice(0,50))}}},generate_url:function e(t,i){var n={properties:"obj",children:"nodes",drop:"obj"},s=this;var a=function e(t,i){return i!=s.type};var l=this.getTreeNodeHierarchy(t);var r=i in n?n[i]:i;return o.generate_url(x.Browser.URL,l,r,s.node,a)}});return T.Collection}.apply(t,n),s!==undefined&&(e.exports=s))},88:function(e,t,i){"use strict";var n,s;!(n=[i(2),i(1),i(0),i(9),i(22),i(19),i(18),i(3),i(27),i(35)],s=function(i,c,u,n,a,f,e,t,l){var s=function e(t){var i=this,n=t.get("name"),s={};i.collection.each(function(e){if(e.get("name")=="name"){s=e.get("availVariables")}});var a=n?s[n]:undefined,l=t.get("value");switch(a&&a.vartype){case"bool":t.set("value",!!t.get("value"),{silent:true});return f.Extension.SwitchCell;case"enum":t.set({value:l},{silent:true});var r=[],o=a.enumvals;c.each(o,function(e){r.push([e,e])});return f.Extension.Select2Cell.extend({optionValues:r});case"integer":if(!c.isNaN(parseInt(l))){t.set({value:parseInt(l)},{silent:true})}else{t.set({value:undefined},{silent:true})}return f.IntegerCell;case"real":if(!c.isNaN(parseFloat(l))){t.set({value:parseFloat(l)},{silent:true})}else{t.set({value:undefined},{silent:true})}return f.NumberCell.extend({decimals:0});case"string":return f.StringCell;default:t.set({value:undefined},{silent:true});return f.Cell}};var p=f.Row.extend({modelDuplicateClass:"bg-model-duplicate",initialize:function e(){f.Row.prototype.initialize.apply(this,arguments);var a=this;a.model.on("change:name",function(){setTimeout(function(){a.columns.each(function(e){if(e.get("name")=="value"){var t=a.columns.indexOf(e),i=e.get("cellFunction"),n=new(i.apply(e,[a.model]))({column:e,model:a.model}),s=a.cells[t];s.remove();a.cells[t]=n;a.render()}})},10)});a.listenTo(a.model,"pgadmin-session:model:duplicate",a.modelDuplicate);a.listenTo(a.model,"pgadmin-session:model:unique",a.modelUnique)},modelDuplicate:function e(){u(this.el).removeClass("new");u(this.el).addClass(this.modelDuplicateClass)},modelUnique:function e(){u(this.el).removeClass(this.modelDuplicateClass)}});var r=l.VariableModel=l.Model.extend({keys:["name"],defaults:{name:undefined,value:undefined,role:null,database:null},schema:[{id:"name",label:i("Name"),type:"text",cellHeaderClasses:"width_percent_30",editable:function e(t){return t instanceof n.Collection?true:t.isNew()},cell:f.Extension.NodeAjaxOptionsCell.extend({initialize:function e(){f.Extension.NodeAjaxOptionsCell.prototype.initialize.apply(this,arguments);var t=c.clone(this.optionValues||(c.isFunction(this.column.get("options"))?this.column.get("options")(this):this.column.get("options")));this.column.set("options",t)}}),url:"vopts",select2:{allowClear:false},transform:function e(t,i){var n=[],s={};c.each(t,function(e){n.push({value:e.name,image:undefined,label:e.name});s[e.name]=e});i.column.set("availVariables",s);return n}},{id:"value",label:i("Value"),type:"text",editable:true,cellFunction:s,cellHeaderClasses:"width_percent_40"},{id:"database",label:i("Database"),type:"text",editable:true,node:"database",cell:f.Extension.NodeListByNameCell},{id:"role",label:i("Role"),type:"text",editable:true,node:"role",cell:f.Extension.NodeListByNameCell}],toJSON:function e(){var t=n.Model.prototype.toJSON.apply(this);if(c.isUndefined(t.database)||c.isNull(t.database)){delete t.database}if(c.isUndefined(t.role)||c.isNull(t.role)){delete t.role}return t},validate:function e(){var t=null;if(c.isUndefined(this.get("name"))||c.isNull(this.get("name"))||String(this.get("name")).replace(/^\s+|\s+$/g,"")==""){t=i("Please select a parameter name.");this.errorModel.set("name",t)}else if(c.isUndefined(this.get("value"))||c.isNull(this.get("value"))||String(this.get("value")).replace(/^\s+|\s+$/g,"")==""){t="Please enter a value for the parameter.";this.errorModel.set("value",t);this.errorModel.unset("name")}else{this.errorModel.unset("name");this.errorModel.unset("value")}return t}});a.VariableCollectionControl=a.UniqueColCollectionControl.extend({hasDatabase:false,hasRole:false,initialize:function e(t){var i=this,n=["name"];i.hasDatabase=t.field.get("hasDatabase");i.hasRole=t.field.get("hasRole");if(i.hasDatabase){n.push("database")}else if(i.hasRole){n.push("role")}if(t&&t.field){if(t.field instanceof a.Field){t.field.set({model:l.VariableModel.extend({keys:n})},{silent:true})}else{t.field.extend({model:l.VariableModel.extend({keys:n})})}}a.UniqueColCollectionControl.prototype.initialize.apply(i,arguments);i.availVariables={};var s=["name","value"];if(i.hasDatabase){s.push("database")}if(i.hasRole){s.push("role")}i.gridSchema=a.generateGridColumnsFromModel(i.field.get("node_info"),r.extend({keys:n}),"edit",s,i.field.get("schema_node"));i.getVariables()},getVariables:function e(){var t=this,i=this.field.get("url"),n=t.model;if(!this.field.get("version_compatible"))return;if(i&&!n.isNew()){var s=t.field.get("node"),a=t.field.get("node_data"),l=t.field.get("node_info"),r=s.generate_url.apply(s,[null,i,a,true,l]),o,d=t.collection.trackChanges;if(d){t.collection.stopSession()}n.trigger("pgadmin-view:fetching",n,t.field);u.ajax({async:false,url:r}).done(function(e){o=e.data}).fail(function(){n.trigger("pgadmin-view:fetch:error",n,t.field)});n.trigger("pgadmin-view:fetched",n,t.field);if(o&&c.isArray(o)){t.collection.reset(o,{silent:true})}if(d){t.collection.startNewSession()}}},showGridControl:function e(r){var o=this,t=c.template(["<div class='subnode-header'>","<label class='control-label'><%-label%></label>","<button class='btn btn-sm-sq btn-secondary add fa fa-plus' title='"+c("Add new row")+"' <%=canAdd ? '' : 'disabled=\"disabled\"'%>></button>","</div>"].join("\n")),i=u("<div class='pgadmin-control-group backgrid form-group col-12 object subnode'></div>").append(t(r));if(o.grid){o.grid.remove()}var n=c.clone(this.gridSchema);c.each(n.columns,function(e){if(e.name=="value"){e.availVariables=o.availVariables}});if(r.disabled==false&&r.canDelete){n.columns.unshift({name:"pg-backform-delete width_percent_5",label:"",cell:f.Extension.DeleteCell,editable:false,cell_priority:-1})}o.collection.each(function(e){var t=e.get("name"),i;if(t in o.availVariables){switch(o.availVariables[t].vartype){case"real":i=parseFloat(e.get("value"));e.set("value",isNaN(i)?undefined:i,{silent:true});break;case"integer":i=parseInt(e.get("value"));e.set("value",isNaN(i)?undefined:i,{silent:true});break;default:break}}});var d=o.grid=new f.Grid({columns:n.columns,collection:o.collection,row:p,className:"backgrid table presentation table-bordered table-noouter-border table-hover"});o.$grid=d.render().$el;i.append(o.$grid);if(!(r.disabled||r.canAdd==false)){i.find("button.add").first().on("click",function(e){e.preventDefault();var t=c.isFunction(r.canAddRow)?r.canAddRow.apply(o,[o.model]):true;if(t){var i=!!o.field.get("allowMultipleEmptyRows");if(!i&&o.collection){var n=false;o.collection.each(function(e){var t=[];c.each(e.attributes,function(e){t.push(e)});if(!c.some(t,c.identity)){n=true}});if(n){return false}}u(d.body.$el.find(u("tr.new"))).removeClass("new");var s=new r.model(null,{silent:true,handler:o.collection,top:o.model.top||o.model,collection:o.collection,node_info:o.model.node_info});o.collection.add(s);var a=o.collection.indexOf(s),l=d.body.rows[a].$el;l.addClass("new");u(l).pgMakeVisible("backform-tab");return false}})}return i},addVariable:function e(t){t.preventDefault();var i=this,n=new(i.field.get("model"))(i.headerData.toJSON(),{silent:true,top:i.collection.top,handler:i.collection}),s=i.model.get(i.field.get("name"));s.add(n);var a=s.indexOf(n);if(a>-1){i.$grid.find(".new").removeClass("new");var l=i.grid.body.rows[a].$el;l.addClass("new");u(l).pgMakeVisible("backform-tab")}return false}});return r}.apply(t,n),s!==undefined&&(e.exports=s))}}]);